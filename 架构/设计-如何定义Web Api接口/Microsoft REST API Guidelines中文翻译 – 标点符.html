<!DOCTYPE html>
<!-- saved from url=(0116)https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%A0%87%E5%87%86%E5%93%8D%E5%BA%94%E6%A0%87%E5%A4%B4 -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="https://www.biaodianfu.com/favicon.ico">
<title>Microsoft REST API Guidelines中文翻译 – 标点符</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="https://www.biaodianfu.com/">
<link rel="alternate" type="application/rss+xml" title="标点符 » Feed" href="https://www.biaodianfu.com/feed">
<link rel="alternate" type="application/rss+xml" title="标点符 » Microsoft REST API Guidelines中文翻译评论Feed" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html/feed">
<!-- <link rel='stylesheet' id='yarppWidgetCss-css'  href='https://www.biaodianfu.com/wp-content/plugins/yet-another-related-posts-plugin/style/widget.css?ver=5.8.2' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='ez-icomoon-css'  href='https://www.biaodianfu.com/wp-content/plugins/easy-table-of-contents/vendor/icomoon/style.min.css?ver=2.0.11' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='ez-toc-css'  href='https://www.biaodianfu.com/wp-content/plugins/easy-table-of-contents/assets/css/screen.min.css?ver=2.0.11' type='text/css' media='all' /> -->
<link rel="stylesheet" type="text/css" href="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/xg2.css" media="all">
<style id="ez-toc-inline-css" type="text/css">
div#ez-toc-container p.ez-toc-title {font-size: 120%;}div#ez-toc-container p.ez-toc-title {font-weight: 500;}div#ez-toc-container ul li {font-size: 95%;}div#ez-toc-container {width: 100%;}
</style>
<!-- <link rel='stylesheet' id='mundana-styles-css'  href='https://www.biaodianfu.com/wp-content/themes/mundana/assets/css/theme.min.css?ver=1.1.7.1635398090' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='claps-applause-css'  href='https://www.biaodianfu.com/wp-content/plugins/wp-claps-applause/css/claps-applause.css?ver=5.8.2' type='text/css' media='all' /> -->
<script src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/hm.js.下载"></script><script src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/h6vp5.js.下载" type="text/javascript"></script>
<!-- <script type='text/javascript' src='https://www.biaodianfu.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script> -->
<!-- <script type='text/javascript' src='https://www.biaodianfu.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script> -->
<link rel="canonical" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true} });</script>
<link rel="stylesheet" type="text/css" href="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/enlighterjs.min.css" media="all"><script src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/enlighterjs.min.js.下载" async=""></script><style id="ez-toc-active-height">.ez-toc-widget-container ul.ez-toc-list li.active::before {height:NaNpx;} </style></head>
<body class="post-template-default single single-post postid-4005 single-format-standard"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" overflow="hidden" style="position:absolute;width:0;height:0"><defs><symbol id="wbsico-dwqr-close" viewBox="0 0 18 18"><path fill-rule="evenodd" d="M17.61.39a1.24 1.24 0 00-1.8 0L9 7.2 2.19.39C1.67-.13.9-.13.39.39s-.52 1.28 0 1.8L7.2 9 .39 15.81a1.24 1.24 0 000 1.8c.25.26.51.39.9.39s.64-.13.9-.39L9 10.8l6.81 6.81c.26.26.65.39.9.39s.65-.13.9-.39c.52-.51.52-1.28 0-1.8L10.8 9l6.81-6.81c.52-.52.52-1.29 0-1.8z"></path></symbol><symbol id="wbsico-dwqr-donate" viewBox="0 0 9 18"><path fill-rule="evenodd" d="M5.63 8.1V4.61c.67.23 1.12.9 1.12 1.58S7.2 7.3 7.88 7.3 9 6.86 9 6.2a3.8 3.8 0 00-3.38-3.83V1.12C5.63.45 5.17 0 4.5 0S3.37.45 3.37 1.12v1.24A3.8 3.8 0 000 6.2c0 2.35 1.8 3.25 3.38 3.7v3.49c-.68-.23-1.13-.9-1.13-1.58S1.8 10.7 1.12 10.7 0 11.14 0 11.8a3.8 3.8 0 003.38 3.83v1.24c0 .67.45 1.12 1.12 1.12s1.13-.45 1.13-1.12v-1.24A3.88 3.88 0 009 11.8c0-2.36-1.8-3.26-3.38-3.7zM2.25 6.19c0-.79.45-1.35 1.13-1.58v2.93c-.8-.34-1.13-.68-1.13-1.35zm3.38 7.2v-2.93c.78.34 1.12.68 1.12 1.35 0 .79-.45 1.35-1.13 1.58z"></path></symbol><symbol id="wbsico-dwqr-like" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M13.3 6H9V2c0-1.5-.8-2-2-2-.3 0-.6.2-.6.5L4 8v8h8.6c1.3 0 2.4-1 2.6-2.3l.8-4.6c.1-.8-.1-1.6-.6-2.1-.5-.7-1.3-1-2.1-1M0 8h2v8H0z"></path></symbol><symbol id="wbsico-dwqr-share" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M11 6a3 3 0 10-3-2.4l-3 2A3 3 0 003 5a3 3 0 000 6 3 3 0 001.9-.7l3.2 2-.1.7a3 3 0 103-3 3 3 0 00-1.9.7L6 8.7a3 3 0 000-1.3l3.2-2A3 3 0 0011 6"></path></symbol><symbol id="wbsico-dwqr-qq" viewBox="0 0 32 32"><path fill="var(--color1, #00b6f7)" d="M16 0C7.163 0 0 7.163 0 16s7.163 16 16 16 16-7.163 16-16S24.837 0 16 0zm7.09 19.908a11.686 11.686 0 01-1.463 2.655l.023-.032a2.17 2.17 0 011.52 2.029v.002s.06 1.636-3.54 1.523c0 0-2.54-.2-3.3-1.269h-.66c-.76 1.072-3.3 1.269-3.3 1.269-3.6.113-3.54-1.523-3.54-1.523a2.168 2.168 0 011.505-2.027l.015-.004a11.565 11.565 0 01-1.412-2.544l-.028-.079c-2.25 3.639-2.02-.508-2.02-.508a7.824 7.824 0 012.189-4.06l.001-.001c-.25-2.229.68-2.624.68-2.624.19-6.893 6.12-6.773 6.24-6.769s6.05-.124 6.24 6.769c0 0 .93.395.68 2.623a7.796 7.796 0 012.181 4.012l.009.05s.23 4.147-2.02.508z"></path></symbol><symbol id="wbsico-dwqr-weibo" viewBox="0 0 32 32"><path fill="var(--color2, #e45c62)" d="M14.54 15.879c-3.18.146-5.75 1.851-5.75 3.977s2.57 3.718 5.75 3.569 5.76-2.137 5.76-4.26-2.58-3.432-5.76-3.286zm2.17 5.346a3.715 3.715 0 01-4.797.848l.017.009a1.663 1.663 0 01-.86-1.432v-.001a3 3 0 012.823-3.371h.007c3.21-.373 3.78 2.689 2.81 3.946zm-3.67-1.594c-.557.062-.99.516-1.02 1.077v.003a.872.872 0 001.086.773l-.006.001a1.16 1.16 0 001.079-1.02l.001-.005a.923.923 0 00-1.147-.828l.006-.001zm1.52-.413a.48.48 0 00-.139.612l-.001-.003a.372.372 0 00.56.051.492.492 0 00.169-.612l.001.003a.385.385 0 00-.59-.052zM16 0C7.163 0 0 7.163 0 16s7.163 16 16 16 16-7.163 16-16S24.837 0 16 0zm7.14 20.574c-1.31 2.786-5.63 4.142-8.84 3.89-3.04-.239-6.96-1.251-7.37-4.937v-.047c0-1.45.534-2.775 1.416-3.789l-.006.007s2.33-3.252 5.04-4.179 3.03.639 3.03 1.562c-.15.784-.42 1.245.6.928 0 0 2.67-1.237 3.77-.14.258.309.415.711.415 1.149 0 .354-.102.685-.279.963l.004-.007s-.36.408.39.554a2.684 2.684 0 011.823 4.058l.007-.011zm-2.63-7.7a.527.527 0 01-.001-1.05h.001a2.362 2.362 0 012.876 2.926l.004-.017v.056a.53.53 0 01-1.05-.083s.52-2.349-1.83-1.83zm5.53 2.81l.001.028a.625.625 0 01-.745.614l.004.001a.7.7 0 01-.76-.684v-.001c.009-.267.064-.518.155-.75l-.005.015a3.38 3.38 0 00-.238-2.551l.009.019a4.027 4.027 0 00-3.796-1.87l.016-.001c-.197.071-.43.129-.67.164l-.02.002a.768.768 0 01-.216-1.499l.005-.001a.502.502 0 01.085-.043l.005-.002a6.58 6.58 0 012.662-.019l-.042-.007c2.02.473 4.8 2.428 3.55 6.59z"></path></symbol><symbol id="wbsico-dwqr-weixin" viewBox="0 0 32 32"><path fill="var(--color3, #68c313)" d="M18.11 15.987a.774.774 0 00-.73.755v.001c.043.374.35.663.729.678h.001a.744.744 0 10-.005-1.433l.005-.001zm-2.4-3.52a.867.867 0 00.941-.864l-.001-.05v.002l.002-.063a.854.854 0 00-.946-.849h.004a.984.984 0 00-1.069.909v.003a1.001 1.001 0 001.073.912h-.003zM16 0C7.163 0 0 7.163 0 16s7.163 16 16 16 16-7.163 16-16S24.837 0 16 0zm-3.02 20.054a8.547 8.547 0 01-2.64-.435l.06.017-2.64 1.33.76-2.242c-1.715-1.031-2.865-2.849-2.95-4.941v-.012c0-3.545 3.34-6.256 7.41-6.256 3.59 0 6.8 2.137 7.43 5.161a3.677 3.677 0 00-.707-.078H19.7a6.06 6.06 0 00-6.28 5.856v.01c.005.558.081 1.096.22 1.608l-.01-.044a5.385 5.385 0 01-.545.027l-.11-.001h.005zm10.87 2.554l.52 1.877-1.98-1.121c-.657.192-1.424.331-2.213.389l-.037.002c-3.49 0-6.25-2.4-6.25-5.37s2.76-5.37 6.25-5.37c3.32 0 6.29 2.4 6.29 5.37a5.531 5.531 0 01-2.557 4.21l-.023.013zm-13.3-11.965a1.027 1.027 0 00-1.12.907v.005a1.045 1.045 0 001.124.911h-.004l.04.001a.9.9 0 00.9-.9v-.014.001l.001-.03a.884.884 0 00-.943-.882h.003zm11.65 5.344a.752.752 0 00-.73.752v.005a.739.739 0 00.73.678.74.74 0 10-.005-1.433l.005-.001z"></path></symbol><symbol id="wbsico-dwqr-qzone" viewBox="0 0 18 18"><path fill="var(--color4, #ebbf00)" d="M12.26 7.09H6.01l4.12.7-4.42 3.6h6.7l-3.96-.86 3.81-3.45zM9 0a9 9 0 109 9 9 9 0 00-9-9zm5.85 7.39l-2.28 1.94.75 4.88a.31.31 0 01-.3.15l-3.97-2.44-3.99 2.44c-.3 0-.33 0-.33-.15l.55-4.88-2.42-2.14-.82-.59h-.23v-.02l.23.03h4.73l.62-1.1L8.9 2.3h.3l1.68 3.22.6 1.09h4.12c.16 0 .16-.1.16.06l-.92.72z"></path></symbol><symbol id="wbsico-dwqr-poster" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M14 0a2 2 0 012 2v12a2 2 0 01-2 2H2a2 2 0 01-2-2V2C0 .9.9 0 2 0h12zm0 2H2v12h12V2zm-6 9a1 1 0 110 2 1 1 0 010-2zm5-8v7H3V3h10z"></path></symbol></defs></svg>
<header id="MagicMenu" class="navbar-light fixed-top navbar mediumnavigation nav-up" style="top: -60px;">
<div class="container">
<div class="d-lg-flex justify-content-between align-items-center brandrow w-100">
<div class="logoarea"><a class="blog-logo" href="https://www.biaodianfu.com/" rel="home"><img src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/biaodianfu_logo_small.png" alt="标点符"></a></div>
<!-- Secondary Top Menu -->
<div class="navbar-expand-lg d-lg-flex align-items-center text-lg-right"><div id="bs4navbartop" class="collapse navbar-collapse"><ul id="menu-%e6%ac%a1%e5%af%bc%e8%88%aa" class="navbar-nav w-100 d-lg-flex align-items-center"><li class="menu-item search align-self-center"><form action="https://www.biaodianfu.com/" class="search-form" autocomplete="off"><div class="form-group has-feedback"><input type="hidden" name="post_type" value="post"><input type="text" class="form-control" name="s" placeholder="搜索"><i class="fa fa-search form-control-feedback"></i></div></form></li><li id="menu-item-760" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-760 nav-item"><a href="https://www.biaodianfu.com/aboutme.html" class="nav-link">关于</a></li>
<li id="menu-item-759" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-759 nav-item"><a href="https://www.biaodianfu.com/roadmap" class="nav-link">索引</a></li>
</ul></div></div>
<!-- Secondary Top Menu -->
</div>
<!-- Main Menu -->
<div class="navbar-expand-lg d-flex  align-items-center w-100"><div id="bs4navbar" class="collapse navbar-collapse"><ul id="menu-%e5%af%bc%e8%88%aa" class="navbar-nav w-100 d-flex align-items-center justify-content-between"><li id="menu-item-695" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-695 nav-item"><a href="http://www.biaodianfu.com/" class="nav-link">首页</a></li>
<li id="menu-item-24" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-24 nav-item"><a href="https://www.biaodianfu.com/category/philosophy" class="nav-link">道→理念</a></li>
<li id="menu-item-23" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-23 nav-item"><a href="https://www.biaodianfu.com/category/principle" class="nav-link">法→原理</a></li>
<li id="menu-item-22" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-22 nav-item"><a href="https://www.biaodianfu.com/category/practice" class="nav-link">术→技巧</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-20 nav-item"><a href="https://www.biaodianfu.com/category/tools" class="nav-link">器→工具</a></li>
<li id="menu-item-21" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-21 nav-item"><a href="https://www.biaodianfu.com/category/goal" class="nav-link">志→目标</a></li>
<li id="menu-item-19" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-19 nav-item"><a href="https://www.biaodianfu.com/category/trends" class="nav-link">势→趋势</a></li>
</ul></div></div>
<!-- Main Menu -->
</div>
</header>
<!-- Begin site-content  -->
<div class="container site-content" style="margin-top: 135.758px;"><div id="post-4005">
<div class="alignfullincol">
<div class="container-fluid max1140">
<!-- row -->
<div class="row mb-5 mt-5">
<!-- main column -->
<div class="col-md-8">
<!-- unless featured image is hidden or not present -->
<div class="articleheader jumbotron jumbotron-fluid removetoppadding mb-5 pl-0 pt-0 pb-0 pr-0 bg-transparent position-relative">
<p class="text-uppercase font-weight-bold articleheader-category">
<a href="https://www.biaodianfu.com/category/practice" rel="category tag">术→技巧</a>, <a href="https://www.biaodianfu.com/category/practice/development" rel="category tag">研发</a>                        </p>
<h1 class="display-4 article-headline mb-3">Microsoft REST API Guidelines中文翻译</h1>
<div class="d-flex align-items-center">
<small><span class="text-muted d-block"><span class="text-capitalize"> 钱魏Way</span> · <span class="post-date"><time class="post-date">2021-11-18</time></span><span class="post-views"> · 0 次浏览</span></span></small>
</div>
</div>
<!-- end unless featured image hidden or not present -->
<!-- widget before article -->
<!-- end widget before article -->
<article class="article-post">
<p><a href="https://github.com/microsoft/api-guidelines/blob/vNext/Guidelines.md">微软的REST API指南</a>算是网上比较详细的关于Restfull API的指导方案，由于本身是英文，网上存在部分翻译，但是大部分只翻译了一小部分内容，没有全部翻译。所以抽时间做了简单的翻译和整理。翻译质量有限，望海涵。</p>
<p><img loading="lazy" class="alignnone size-full wp-image-4006" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/microsoft-rest-api-guidelines.png" alt="" width="760" height="341"></p>
<div id="ez-toc-container" class="ez-toc-v2_0_11 counter-hierarchy counter-decimal ez-toc-grey">
<div class="ez-toc-title-container">
<p class="ez-toc-title">目录</p>
<span class="ez-toc-title-toggle"><a class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle"><i class="ez-toc-glyphicon ez-toc-icon-toggle"></i></a></span></div>
<nav><ul class="ez-toc-list ez-toc-list-level-1"><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-1" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E4%BB%8B%E7%BB%8D" title="介绍">介绍</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-2" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB" title="推荐阅读">推荐阅读</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-3" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%AF%A6%E8%A7%A3%E5%87%86%E5%88%99" title="详解准则">详解准则</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-4" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%87%86%E5%88%99%E7%9A%84%E5%BA%94%E7%94%A8" title="准则的应用">准则的应用</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-5" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E7%8E%B0%E6%9C%89%E6%9C%8D%E5%8A%A1%E5%92%8C%E6%9C%8D%E5%8A%A1%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E7%9A%84%E5%87%86%E5%88%99" title="现有服务和服务版本控制的准则">现有服务和服务版本控制的准则</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-6" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E7%94%A8%E8%AF%8D%E9%87%8A%E4%B9%89" title="用词释义">用词释义</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-7" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%AE%B8%E5%8F%AF" title="许可">许可</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-8" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%88%86%E7%B1%BB" title="分类">分类</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-9" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%94%99%E8%AF%AF" title="错误">错误</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-10" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%95%85%E9%9A%9C" title="故障">故障</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-11" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%BB%B6%E8%BF%9F" title="延迟">延迟</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-12" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%AE%8C%E6%88%90%E6%97%B6%E9%97%B4" title="完成时间">完成时间</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-13" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%95%BF%E6%97%B6%E9%97%B4%E8%BF%90%E8%A1%8C%E6%95%85%E9%9A%9C" title="长时间运行故障">长时间运行故障</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-14" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8C%87%E5%8D%97" title="客户端指南">客户端指南</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-15" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%BF%BD%E7%95%A5%E8%A7%84%E5%88%99" title="忽略规则">忽略规则</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-16" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%8F%98%E9%87%8F%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99" title="变量排序规则">变量排序规则</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-17" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%9D%99%E9%BB%98%E5%A4%B1%E8%B4%A5%E8%A7%84%E5%88%99" title="静默失败规则">静默失败规则</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-18" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%9F%BA%E7%A1%80%E5%8E%9F%E5%88%99" title="基础原则">基础原则</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-19" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#URL_%E9%93%BE%E6%8E%A5%E6%A0%BC%E5%BC%8F" title="URL 链接格式">URL 链接格式</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-20" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#URL%E9%95%BF%E5%BA%A6" title="URL长度">URL长度</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-21" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%A7%84%E8%8C%83%E7%9A%84%E6%A0%87%E8%AF%86%E7%AC%A6" title="规范的标识符">规范的标识符</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-22" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%94%AF%E6%8C%81%E7%9A%84%E6%96%B9%E6%B3%95" title="支持的方法">支持的方法</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-23" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%A0%87%E5%87%86%E7%9A%84%E8%AF%B7%E6%B1%82%E6%A0%87%E5%A4%B4" title="标准的请求标头">标准的请求标头</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-24" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%A0%87%E5%87%86%E5%93%8D%E5%BA%94%E6%A0%87%E5%A4%B4" title="标准响应标头">标准响应标头</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-25" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%87%E5%A4%B4" title="自定义标头">自定义标头</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-26" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E4%BB%A5%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0%E6%96%B9%E5%BC%8F%E6%8F%90%E4%BA%A4%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%B7%E6%B1%82%E5%A4%B4" title="以查询参数方式提交自定义请求头">以查询参数方式提交自定义请求头</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-27" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#PII_%E4%B8%AA%E4%BA%BA%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF%E5%8F%82%E6%95%B0" title="PII 个人身份信息参数">PII 个人身份信息参数</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-28" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%93%8D%E5%BA%94%E6%A0%BC%E5%BC%8F" title="响应格式">响应格式</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-29" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#HTTP%E7%8A%B6%E6%80%81%E7%A0%81" title="HTTP状态码">HTTP状态码</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-30" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BA%93%E5%8F%AF%E9%80%89" title="客户端库可选">客户端库可选</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-31" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#CORS_%E8%B7%A8%E5%9F%9F" title="CORS 跨域">CORS 跨域</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-32" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8C%87%E5%AF%BC" title="客户端指导">客户端指导</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-33" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%9C%8D%E5%8A%A1%E6%8C%87%E5%8D%97" title="服务指南">服务指南</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-34" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#Collections%E9%9B%86%E5%90%88" title="Collections集合">Collections集合</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-35" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%85%83%E7%B4%A0keys" title="元素keys">元素keys</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-36" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%BA%8F%E5%88%97%E5%8C%96" title="序列化">序列化</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-37" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%9B%86%E5%90%88%E7%9A%84URL%E5%8C%B9%E9%85%8D" title="集合的URL匹配">集合的URL匹配</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-38" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%A4%A7%E9%9B%86%E5%90%88" title="大集合">大集合</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-39" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%9B%86%E5%90%88%E7%9A%84%E6%9B%B4%E6%94%B9" title="集合的更改">集合的更改</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-40" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%9B%86%E5%90%88%E7%9A%84%E6%8E%92%E5%BA%8F" title="集合的排序">集合的排序</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-41" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#Filtering%E8%BF%87%E6%BB%A4" title="Filtering过滤">Filtering过滤</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-42" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#Pagination%E5%88%86%E9%A1%B5" title="Pagination分页">Pagination分页</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-43" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%A4%8D%E5%90%88%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C" title="复合集合操作">复合集合操作</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-44" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E7%A9%BA%E7%BB%93%E6%9E%9C%E9%9B%86" title="空结果集">空结果集</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-45" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%A2%9E%E9%87%8F%E6%9F%A5%E8%AF%A2" title="增量查询">增量查询</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-46" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%A2%9E%E9%87%8F%E9%93%BE%E6%8E%A5" title="增量链接">增量链接</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-47" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%AE%9E%E4%BD%93%E8%A1%A8%E7%A4%BA" title="实体表示">实体表示</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-48" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%8E%B7%E5%8F%96%E5%A2%9E%E9%87%8F%E9%93%BE%E6%8E%A5" title="获取增量链接">获取增量链接</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-49" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%A2%9E%E9%87%8F%E9%93%BE%E6%8E%A5%E5%93%8D%E5%BA%94%E7%9A%84%E5%86%85%E5%AE%B9" title="增量链接响应的内容">增量链接响应的内容</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-50" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E4%BD%BF%E7%94%A8%E5%A2%9E%E9%87%8F%E9%93%BE%E6%8E%A5" title="使用增量链接">使用增量链接</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-51" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#JSON_%E6%A0%87%E5%87%86%E5%8C%96" title="JSON 标准化">JSON 标准化</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-52" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B%E7%9A%84_JSON_%E6%A0%BC%E5%BC%8F%E6%A0%87%E5%87%86%E5%8C%96" title="原始类型的 JSON 格式标准化">原始类型的 JSON 格式标准化</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-53" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E6%8C%87%E5%8D%97" title="日期和时间指南">日期和时间指南</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-54" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%9A%84_JSON_%E5%BA%8F%E5%88%97%E5%8C%96" title="日期和时间的 JSON 序列化">日期和时间的 JSON 序列化</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-55" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#Durations%E6%8C%81%E7%BB%AD%E6%97%B6%E9%97%B4" title="Durations持续时间">Durations持续时间</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-56" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#Intervals_%E9%97%B4%E9%9A%94" title="Intervals 间隔">Intervals 间隔</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-57" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#Repeating_intervals%E9%87%8D%E5%A4%8D%E9%97%B4%E9%9A%94" title="Repeating intervals重复间隔">Repeating intervals重复间隔</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-58" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6" title="版本控制">版本控制</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-59" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E6%A0%BC%E5%BC%8F" title="版本控制格式">版本控制格式</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-60" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E6%9B%B4%E6%96%B0%E7%89%88%E6%9C%AC" title="什么时候更新版本">什么时候更新版本</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-61" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%87%8D%E5%A4%A7%E5%8F%98%E6%9B%B4%E7%9A%84%E5%AE%9A%E4%B9%89" title="重大变更的定义">重大变更的定义</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-62" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%95%BF%E6%97%B6%E9%97%B4%E8%BF%90%E8%A1%8C%E7%9A%84%E6%93%8D%E4%BD%9C" title="长时间运行的操作">长时间运行的操作</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-63" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E9%95%BF%E6%97%B6%E9%97%B4%E8%BF%90%E8%A1%8C%E6%93%8D%E4%BD%9C_(RELO)" title="基于资源的长时间运行操作 (RELO)">基于资源的长时间运行操作 (RELO)</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-64" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%80%90%E6%AD%A5%E9%95%BF%E8%BF%90%E8%A1%8C%E6%93%8D%E4%BD%9C" title="逐步长运行操作">逐步长运行操作</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-65" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%93%8D%E4%BD%9C%E7%BB%93%E6%9E%9C%E4%BF%9D%E7%95%99%E6%94%BF%E7%AD%96" title="操作结果保留政策">操作结果保留政策</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-66" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%8A%82%E6%B5%81%E3%80%81%E9%85%8D%E9%A2%9D%E5%92%8C%E9%99%90%E5%88%B6" title="节流、配额和限制">节流、配额和限制</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-67" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%8E%9F%E5%88%99" title="原则">原则</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-68" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%BF%94%E5%9B%9E%E4%BB%A3%E7%A0%81%EF%BC%88429_%E4%B8%8E_503%EF%BC%89" title="返回代码（429 与 503）">返回代码（429 与 503）</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-69" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#RetryAfter_%E5%92%8C_RateLimit_%E6%A0%87%E5%A4%B4" title="Retry-After 和 RateLimit 标头">Retry-After 和 RateLimit 标头</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-70" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%9C%8D%E5%8A%A1%E6%8C%87%E5%8D%97-2" title="服务指南">服务指南</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-71" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%AF%B7%E6%B1%82%E6%8C%87%E5%8D%97" title="请求指南">请求指南</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-72" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%A4%84%E7%90%86%E5%BF%BD%E7%95%A5_RetryAfter_%E6%A0%87%E5%A4%B4%E7%9A%84%E8%B0%83%E7%94%A8%E8%80%85" title="处理忽略 Retry-After 标头的调用者">处理忽略 Retry-After 标头的调用者</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-73" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%80%9A%E8%BF%87Webhook%E6%8E%A8%E9%80%81%E9%80%9A%E7%9F%A5" title="通过Webhook推送通知">通过Webhook推送通知</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-74" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%8C%83%E5%9B%B4" title="范围">范围</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-75" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%8E%9F%E5%88%99-2" title="原则">原则</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-76" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%AE%A2%E9%98%85%E7%B1%BB%E5%9E%8B" title="订阅类型">订阅类型</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-77" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%B0%83%E7%94%A8%E5%BA%8F%E5%88%97" title="调用序列">调用序列</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-78" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%AA%8C%E8%AF%81%E8%AE%A2%E9%98%85" title="验证订阅">验证订阅</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-79" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%8E%A5%E6%94%B6%E9%80%9A%E7%9F%A5" title="接收通知">接收通知</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-80" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E4%BB%A5%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F%E7%AE%A1%E7%90%86%E8%AE%A2%E9%98%85" title="以编程方式管理订阅">以编程方式管理订阅</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-81" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%AE%89%E5%85%A8" title="安全">安全</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-82" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E4%B8%8D%E6%94%AF%E6%8C%81%E7%9A%84%E8%AF%B7%E6%B1%82" title="不支持的请求">不支持的请求</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-83" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99" title="基本原则">基本原则</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-84" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%8A%9F%E8%83%BD%E5%85%81%E8%AE%B8%E5%88%97%E8%A1%A8" title="功能允许列表">功能允许列表</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-85" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%91%BD%E5%90%8D%E6%8C%87%E5%8D%97" title="命名指南">命名指南</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-86" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%96%B9%E6%B3%95" title="方法">方法</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-87" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#Casing" title="Casing">Casing</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-88" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%81%BF%E5%85%8D%E7%9A%84%E5%90%8D%E5%AD%97" title="避免的名字">避免的名字</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-89" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#Forming_compound_names" title="Forming compound names">Forming compound names</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-90" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E8%BA%AB%E4%BB%BD%E5%B1%9E%E6%80%A7" title="身份属性">身份属性</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-91" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%B1%9E%E6%80%A7" title="日期和时间属性">日期和时间属性</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-92" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%90%8D%E7%A7%B0%E5%B1%9E%E6%80%A7" title="名称属性">名称属性</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-93" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%9B%86%E5%90%88%E5%92%8C%E8%AE%A1%E6%95%B0" title="集合和计数">集合和计数</a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-94" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7%E5%90%8D%E7%A7%B0" title="常用属性名称">常用属性名称</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-95" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E9%99%84%E5%BD%95" title="附录">附录</a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-96" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E6%97%B6%E5%BA%8F%E5%9B%BE%E6%B3%A8%E9%87%8A" title="时序图注释">时序图注释</a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-97" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#%E7%9B%B8%E5%85%B3%E6%96%87%E7%AB%A0" title="相关文章:">相关文章:</a></li></ul></nav></div>
<h2><span class="ez-toc-section" id="%E4%BB%8B%E7%BB%8D"></span>介绍<span class="ez-toc-section-end"></span></h2>
<p>开发者基本都通过 HTTP 接口访问微软云平台的资源。尽管每个服务通过特定语言的框架封装了它们的 API，但它们的所有操作最终都归结为 HTTP 请求。微软必须支持多种类型的客户端和服务，且不能依赖于各个开发环境丰富的框架。因此，这些准则的一个目标是确保任何支持基本 HTTP 协议的客户端都可以简单且一致地使用 Microsoft REST API。</p>
<p>为了给开发人员提供最流畅的开发体验，让这些 API 遵循一致的设计准则非常重要，从而使它们用起来简单直观。本文档建立了 Microsoft REST API 开发人员应该遵循的指南, 以便统一一致地开发 API。</p>
<p>一致性的好处也会累积起来：一致性使团队拥有通用的代码、模式设计、文档风格和设计决策。</p>
<p>这些准则旨在实现以下目标：</p>
<ul>
<li>为 Microsoft 技术平台中的所有 API 端点定义一致的实现和模式。</li>
<li>尽可能地遵循行业普遍接受的 REST/HTTP 最佳实践。</li>
<li>使所有程序开发人员都可以简单地通过 REST 接口访问 Microsoft 服务。</li>
<li>允许 Service 开发人员利用其他 Service 的工作基础来开发一致的 REST 端点。</li>
<li>允许合作伙伴 (如非微软团队) 使用这些准则进行其自己的 REST 端点设计。</li>
</ul>
<p>注：本指南旨在构建符合 REST 架构风格的服务，但不涉及或要求构建遵循 REST 约束的服务。本文档中使用的“REST”术语代指具有 REST 灵魂的服务，而不是仅仅遵循 REST。</p>
<h3><span class="ez-toc-section" id="%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB"></span>推荐阅读<span class="ez-toc-section-end"></span></h3>
<p>了解 REST 架构风格背后的一些理念，更有助于开发优秀的基于 HTTP 的服务。如果您对 RESTful 设计不熟悉，请参阅以下优秀资源：</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Representational_state_transfer">REST on Wikipedia</a>— 概述 REST 背后的常见定义和核心思想。</li>
<li><a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm">REST Dissertation</a>— Roy Fielding 在网络架构中关于 REST 章节的论文，”Architectural Styles and the Design of Network-based Software Architectures”</li>
<li><a href="https://tools.ietf.org/html/rfc7231">RFC 7231</a>— 定义 HTTP/1.1 语义的规范，被认为是权威的资源。</li>
<li><a href="http://www.amazon.com/REST-Practice-Hypermedia-Systems-Architecture/dp/0596805829/">REST in Practice</a>— 关于 REST 基础的书。</li>
</ul>
<h2><span class="ez-toc-section" id="%E8%AF%A6%E8%A7%A3%E5%87%86%E5%88%99"></span>详解准则<span class="ez-toc-section-end"></span></h2>
<h3><span class="ez-toc-section" id="%E5%87%86%E5%88%99%E7%9A%84%E5%BA%94%E7%94%A8"></span>准则的应用<span class="ez-toc-section-end"></span></h3>
<p>这些准则适用于 Microsoft 或其合作伙伴公开发布的服务的所有 REST API。私人或内部的 API 也大致遵循这些准则, 因为内部服务往往最终会公开。保证一致性不仅对外部客户有利, 而且对内部服务的使用者也很有价值, 这些准则为所有的服务提供了最佳实践。</p>
<p>当然有许多合理理由可以不遵循这些准则。如：实现或必须与某些外部定义的REST API互操作的REST服务必须与哪些外部的API兼容，而无法遵循这些准则。而还有一些服务也可能具有需要特殊性能需求，必须采用其他格式，例如二进制协议。</p>
<h3><span class="ez-toc-section" id="%E7%8E%B0%E6%9C%89%E6%9C%8D%E5%8A%A1%E5%92%8C%E6%9C%8D%E5%8A%A1%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E7%9A%84%E5%87%86%E5%88%99"></span>现有服务和服务版本控制的准则<span class="ez-toc-section-end"></span></h3>
<p>我们不建议为了遵循这些准则，而过早的对老服务进行重大更改。无论如何，当兼容性被破坏时，该服务应该尝试在下一版本中变得合规。当一个服务添加新的 API 时，该 API 应该与同一版本的其他 API 保持一致。因此，如果服务是针对 1.0 版本的指南编写的，那么增量添加到服务的新 API 也应该遵循 1.0 版本指南。然后该服务在下一次主要版本更新时，再去遵循最新版指南。</p>
<h3><span class="ez-toc-section" id="%E7%94%A8%E8%AF%8D%E9%87%8A%E4%B9%89"></span>用词释义<span class="ez-toc-section-end"></span></h3>
<p>本文档中的”MUST”（必须）, “MUST NOT”（禁止）, “REQUIRED”（需要）, “SHALL”（将要）, “SHALL NOT”（最好不要）, “SHOULD”（应该）, “SHOULD NOT”（不应该）, “RECOMMENDED”（推荐）, “MAY”（可能）, 和 “OPTIONAL”（可选） 等关键字的详细解释见 <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>。</p>
<h3><span class="ez-toc-section" id="%E8%AE%B8%E5%8F%AF"></span>许可<span class="ez-toc-section-end"></span></h3>
<p>本项工作的许可采用 <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>。</p>
<h2><span class="ez-toc-section" id="%E5%88%86%E7%B1%BB"></span>分类<span class="ez-toc-section-end"></span></h2>
<p>Microsoft REST API 准则基本要求的一方面就是服务的分类必须符合以下定义。</p>
<h3><span class="ez-toc-section" id="%E9%94%99%E8%AF%AF"></span>错误<span class="ez-toc-section-end"></span></h3>
<p>错误或更具体的服务错误，被定义为客户端将无效数据传递给服务并且服务明确地拒绝该数据。例如无效的证书，错误的参数，未知的版本 ID 等。通常是由于客户端传递错误或无效数据的导致的服务器返回 “4xx” 的 HTTP 错误代码。错误不会影响整体 API 的可用性。</p>
<h3><span class="ez-toc-section" id="%E6%95%85%E9%9A%9C"></span>故障<span class="ez-toc-section-end"></span></h3>
<p>故障（缺陷）或更具体地说服务故障被定义为服务无法正确返回数据以响应有效的客户端请求。通常会返回 “5xx” HTTP 错误代码。故障会影响整体 API 的可用性。由于速率限制或配额不足导致失败的调用绝不能算作故障。由于服务快速失败(fast-failing)请求而失败的调用（通常是为了保护自己）会被视为故障。</p>
<p>译者注：故障意味着服务端代码出现故障，可能会影响整体的API使用。比如数据库连接超时。</p>
<ul>
<li>fast-failing 快速失败</li>
<li>safe-failing 安全失败</li>
</ul>
<h3><span class="ez-toc-section" id="%E5%BB%B6%E8%BF%9F"></span>延迟<span class="ez-toc-section-end"></span></h3>
<p>延迟定义为具体 API 被调用完成所需的时长, 尽可能用客户端进行测量。这种测量方法同样适用于同步和异步 API。对于长时间运行的调用，延迟定义为第一次调用它所需的时长，而非它长时间运行的时长。</p>
<h3><span class="ez-toc-section" id="%E5%AE%8C%E6%88%90%E6%97%B6%E9%97%B4"></span>完成时间<span class="ez-toc-section-end"></span></h3>
<p>暴露长时间操作的服务必须跟踪这些操作的 “完成时间（Time to Complete）” 指标。</p>
<h3><span class="ez-toc-section" id="%E9%95%BF%E6%97%B6%E9%97%B4%E8%BF%90%E8%A1%8C%E6%95%85%E9%9A%9C"></span>长时间运行故障<span class="ez-toc-section-end"></span></h3>
<p>对于长时间运行的 API，很可能出现初始请求成功，且后续每次去获取结果时 API 也处于正常运行（每次都回传 200）中，但其底层操作已经失败了的情况。长时间运行故障必须作为故障汇总到总体可用性指标中。</p>
<h2><span class="ez-toc-section" id="%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8C%87%E5%8D%97"></span>客户端指南<span class="ez-toc-section-end"></span></h2>
<p>为了保证与 REST Service 进行通讯的客户端有最好的体验，客户端应该遵循以下最佳实践：</p>
<h3><span class="ez-toc-section" id="%E5%BF%BD%E7%95%A5%E8%A7%84%E5%88%99"></span>忽略规则<span class="ez-toc-section-end"></span></h3>
<p>对于在调用前数据格式不确定的松耦合客户端，如果服务器返回的数据格式错误，客户端必须安全地忽略掉它。</p>
<p>有的 Service 可能会未更新版本号就在响应中增加字段。Service 这样做的必须在它的文档中进行明确说明，且客户端必须忽略掉这些未知的字段。</p>
<p>译者注：一个已发布的在线接口服务，如果不修改版本而增加字段，那么一定不能影响已有的客户端调用。</p>
<h3><span class="ez-toc-section" id="%E5%8F%98%E9%87%8F%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99"></span>变量排序规则<span class="ez-toc-section-end"></span></h3>
<p>客户端处理响应数据时一定不能依赖服务端JSON响应数据字段的顺序。例如，当服务器返回的 JSON 对象中的字段顺序发生变化，客户端应当能够正确进行解析处理。</p>
<p>当服务端支持时，客户端可以请求以特定的顺序返回数据。例如，服务端可能支持使用$orderBy querystring参数来指定JSON数组中元素的顺序。</p>
<p>服务端也可以在协议中显式说明指定某些元素按特定方式进行排序。例如，服务端可以每次返回 JSON 对象时都把 JSON 对象的类型信息作为第一个字段返回，进而简化客户端解析返回数据格式的难度。客户端处理数据时可以依赖于服务端明确指定了的排序行为。</p>
<h3><span class="ez-toc-section" id="%E9%9D%99%E9%BB%98%E5%A4%B1%E8%B4%A5%E8%A7%84%E5%88%99"></span>静默失败规则<span class="ez-toc-section-end"></span></h3>
<p>当客户端请求带可选功能参数的服务时（例如带可选的头部信息），必须对服务端的返回格式有一定兼容性，可以忽略某些特定功能。</p>
<p>译者注：例如分页数、排序等自定义参数的支持和返回格式的兼容。</p>
<h2><span class="ez-toc-section" id="%E5%9F%BA%E7%A1%80%E5%8E%9F%E5%88%99"></span>基础原则<span class="ez-toc-section-end"></span></h2>
<h3><span class="ez-toc-section" id="URL_%E9%93%BE%E6%8E%A5%E6%A0%BC%E5%BC%8F"></span>URL 链接格式<span class="ez-toc-section-end"></span></h3>
<p>URL必须保证友好的可读性与可构造性，人类应该能够轻松地读取和构造URL。这有助于用户发现并简化接口的调用，即使平台没有良好的客户端SDK支持。</p>
<p>译者注：API URL路径结构应该是友好的易于理解的。甚至用户无需通过阅读API文档能够猜出相关结构和路径。</p>
<p>格式良好的 URL：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people/jdoe@contoso.com/inbox</span></div></div></div><div class="enlighter-raw">https://api.contoso.com/v1.0/people/jdoe@contoso.com/inbox</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">https://api.contoso.com/v1.0/people/jdoe@contoso.com/inbox</pre>
<p>格式不友好的 URL：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">https:</span><span class="enlighter-c0">//api.contoso.com/EWS/OData/Users('jdoe@microsoft.com')/Folders('AAMkADdiYzI1MjUzLTk4MjQtNDQ1Yy05YjJkLWNlMzMzYmIzNTY0MwAuAAAAAACzMsPHYH6HQoSwfdpDx-2bAQCXhUk6PC1dS7AERFluCgBfAAABo58UAAA=')</span></div></div></div><div class="enlighter-raw">https://api.contoso.com/EWS/OData/Users('jdoe@microsoft.com')/Folders('AAMkADdiYzI1MjUzLTk4MjQtNDQ1Yy05YjJkLWNlMzMzYmIzNTY0MwAuAAAAAACzMsPHYH6HQoSwfdpDx-2bAQCXhUk6PC1dS7AERFluCgBfAAABo58UAAA=')</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">https://api.contoso.com/EWS/OData/Users('jdoe@microsoft.com')/Folders('AAMkADdiYzI1MjUzLTk4MjQtNDQ1Yy05YjJkLWNlMzMzYmIzNTY0MwAuAAAAAACzMsPHYH6HQoSwfdpDx-2bAQCXhUk6PC1dS7AERFluCgBfAAABo58UAAA=')</pre>
<p>出现的常见模式是使用URL作为值（参数）。服务可以使用URL作为值。</p>
<p>例如，以下内容是可以接受的(URL中，url参数传递fancy shoes这个资源)：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/items?url=https://resources.contoso.com/shoes/fancy</span></div></div></div><div class="enlighter-raw">https://api.contoso.com/v1.0/items?url=https://resources.contoso.com/shoes/fancy</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">https://api.contoso.com/v1.0/items?url=https://resources.contoso.com/shoes/fancy</pre>
<h3><span class="ez-toc-section" id="URL%E9%95%BF%E5%BA%A6"></span>URL长度<span class="ez-toc-section-end"></span></h3>
<p>HTTP 1.1消息格式(在第3.1.1节的<a href="https://tools.ietf.org/html/rfc7230#section-3.1.1">RFC 7230</a>中定义)对请求没有长度限制，其中包括目标URL。RFC的：</p>
<blockquote><p>HTTP没有对请求行长度设置预定义的限制。[…如果服务器接收到的请求目标比它希望解析的任何URI都长，那么它必须使用 414 (URI太长)状态代码进行响应。</p></blockquote>
<p>服务如果能够生成超过2,083个字符的url，必须考虑兼容它支持的客户端。不同客户端支持的最长 URL 长度参见以下资料：</p>
<ul>
<li><a href="https://docs.microsoft.com/zh-cn/archive/blogs/ieinternals/url-length-limits">URL Length Limits</a></li>
<li><a href="https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url-in-different-browsers/417184">What is the maximum length of a URL in different browsers?</a></li>
</ul>
<p>还请注意，一些技术栈有强制的的URL限定，所以在设计服务时要记住这一点。</p>
<h3><span class="ez-toc-section" id="%E8%A7%84%E8%8C%83%E7%9A%84%E6%A0%87%E8%AF%86%E7%AC%A6"></span>规范的标识符<span class="ez-toc-section-end"></span></h3>
<p>除了友好的 URL 之外，可以移动或重命名的资源也应该暴露一个包含唯一固定标识符的 URL。</p>
<p>在与服务进行交互时可能需要通过友好的名称来获取资源固定的 URL，例如某些服务使用的“/my”快捷方式。</p>
<p>指南不强制要求固定标识符使用GUID。包含规范标识符的URL的一个例子是（标识符比较友好)：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people/7011042402/inbox</span></div></div></div><div class="enlighter-raw">https://api.contoso.com/v1.0/people/7011042402/inbox</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">https://api.contoso.com/v1.0/people/7011042402/inbox</pre>
<h3><span class="ez-toc-section" id="%E6%94%AF%E6%8C%81%E7%9A%84%E6%96%B9%E6%B3%95"></span>支持的方法<span class="ez-toc-section-end"></span></h3>
<p>客户端必须尽可能使用正确的HTTP动词来执行操作，并且必须考虑是否支持此操作的幂等性。HTTP方法通常称为HTTP动词。</p>
<p>这些术语在这种情况下是同义词，但 HTTP 规范了使用术语的方法。</p>
<p>下面是 Microsoft REST服务应该支持的方法列表。并非所有资源都支持所有方法，但使用下面方法的所有资源必须遵从下面的用法。</p>
<table>
<tbody>
<tr>
<td>方法</td>
<td width="503">描述</td>
<td>是否幂等</td>
</tr>
<tr>
<td>GET</td>
<td width="503">返回对象的当前值</td>
<td>True</td>
</tr>
<tr>
<td>PUT</td>
<td width="503">替换对象，或在适用时创建一个命名对象</td>
<td>True</td>
</tr>
<tr>
<td>DELETE</td>
<td width="503">删除对象</td>
<td>True</td>
</tr>
<tr>
<td>POST</td>
<td width="503">根据提供的数据创建一个新对象，或提交一个命令</td>
<td>False</td>
</tr>
<tr>
<td>HEAD</td>
<td width="503">为 GET 响应返回对象的元数据。支持 GET 方法的资源也可以支持 HEAD 方法</td>
<td>True</td>
</tr>
<tr>
<td>PATCH</td>
<td width="503">对对象应用部分更新</td>
<td>False</td>
</tr>
<tr>
<td>OPTIONS</td>
<td width="503">获取有关 Request 的信息；详见下文。</td>
<td>True</td>
</tr>
</tbody>
</table>
<p><strong>POST</strong></p>
<p>POST操作应该支持重定向响应标头（Location），以便通过重定向标头返回创建好的资源的链接。</p>
<p>例如，假设一个服务允许创建并命名托管服务器：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">POST http:</span><span class="enlighter-c0">//api.contoso.com/account1/servers</span></div></div></div><div class="enlighter-raw">POST http://api.contoso.com/account1/servers</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">POST http://api.contoso.com/account1/servers</pre>
<p>响应将会是这个样子：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">201 Created</span></div></div><div class=""><div><span class="enlighter-text">Location: http:</span><span class="enlighter-c0">//api.contoso.com/account1/servers/server321</span></div></div></div><div class="enlighter-raw">201 Created
Location: http://api.contoso.com/account1/servers/server321</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">201 Created
Location: http://api.contoso.com/account1/servers/server321</pre>
<p>其中“server321”是服务分配的服务器名。</p>
<p>服务还可以在响应中返回已创建项的完整元数据。</p>
<p><strong>PATCH</strong></p>
<p>PATCH 已经被 IETF 标准化为递进式更新现有对象的方法(参考<a href="https://tools.ietf.org/html/rfc5789">RFC 5789</a>)。符合 Microsoft REST API 指南的 API应该支持 PATCH 方法。</p>
<p><strong>通过 PATCH 创建资源（UPSERT 语义）</strong></p>
<p>允许客户端在创建资源的时候只指定部分键值（key）数据的必须支持UPSET语义，该服务必须支持以PATCH动词来创建资源。</p>
<p>鉴于PUT被定义为内容的完全替换，所以客户端使用PUT修改数据是危险的。当试图更新资源时，不理解(并因此忽略)资源的某些属性的客户端，很可能在PUT上忽视这些属性，导致提交后这些属性可能在不经意间被删除。所以，如果选择支持PUT来更新现有资源，则必须是完整替换(即，PUT之后，资源的属性必须匹配请求中提供的内容，包括删除没有提供的任何服务端的属性)。</p>
<p>在UPSERT语义下，对不存在资源的 PATCH 调用，由服务器作为“创建”处理，对已存在的资源的 PATCH 调用作为“更新”处理。</p>
<p>为了确保更新请求不被视为创建（反之亦然），客户端可以在请求中指定预先定义的 HTTP 请求头。</p>
<ul>
<li>如果 PATCH 请求包含if-match标头，则服务不能将其视为插入;如果 PATCH 请求包含值为 “*” 的if-none-match头，则服务不能将其视为更新。</li>
</ul>
<p>如果服务不支持UPSERT，则针对不存在的资源的 PATCH 调用必须导致 HTTP “409 Conflict”错误。</p>
<p><strong>Options 标头 和 link headers 标签</strong></p>
<p>OPTIONS 允许客户端查询某个资源的元信息，并至少可以通过返回支持该资源的有效方法（支持的动词类别）的Allow 标头。</p>
<p>此外，建议服务返回应该包括一个指向有关资源的稳定链接（Link header） (参考<a href="https://tools.ietf.org/html/rfc5988">RFC 5988</a>)：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">Link: </span><span class="enlighter-g1">&lt;{</span><span class="enlighter-text">help</span><span class="enlighter-g1">}&gt;</span><span class="enlighter-text">; rel=</span><span class="enlighter-s0">"help"</span></div></div></div><div class="enlighter-raw">Link: &lt;{help}&gt;; rel="help"</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">Link: &lt;{help}&gt;; rel="help"</pre>
<p>其中 {help} 是文档资源的 URL.</p>
<p>有关使用 OPTIONS 的示例，请参考<a href="https://www.w3.org/TR/cors/#resource-preflight-requests">preflighting CORS cross-domain calls</a>。</p>
<h3><span class="ez-toc-section" id="%E6%A0%87%E5%87%86%E7%9A%84%E8%AF%B7%E6%B1%82%E6%A0%87%E5%A4%B4"></span>标准的请求标头<span class="ez-toc-section-end"></span></h3>
<p>下面的请求标头表 应该遵循 Microsoft REST API指南服务使用。使用这些标题不是强制性的，但如果使用它们则必须始终一致地使用。</p>
<p>所有标头值都必须遵循规范中规定的标头字段所规定的语法规则。许多HTTP标头在<a href="https://tools.ietf.org/html/rfc7231">RFC7231</a>中定义，但是在<a href="http://www.iana.org/assignments/message-headers/message-headers.xhtml">IANA标头注册表</a>中可以找到完整的已批准头列表。</p>
<table>
<tbody>
<tr>
<td>Header</td>
<td>Type</td>
<td>Description</td>
</tr>
<tr>
<td>Authorization</td>
<td>String</td>
<td>请求的授权标头</td>
</tr>
<tr>
<td>Date</td>
<td>Date</td>
<td>请求的时间戳，基于客户端的时钟，采用<a href="https://tools.ietf.org/html/rfc5322#section-3.3">RFC 5322</a>日期和时间格式。服务器不应该对客户端时钟的准确性做任何假设。此标头可以包含在请求中，但在提供时必须采用此格式。当提供此报头时，必须使用格林尼治平均时间(GMT)作为时区参考。例如：Wed, 24 Aug 2016 18:41:30 GMT. 请注意，GMT正好等于UTC（协调世界时）。</td>
</tr>
<tr>
<td>Accept</td>
<td>Content type</td>
<td>响应请求的内容类型，如:<p></p>
<p>l&nbsp; application/xml</p>
<p>l&nbsp; text/xml</p>
<p>l&nbsp; application/json</p>
<p>l&nbsp; text/javascript (for JSONP)</p>
<p>根据HTTP准则，这只是一个提示，响应可能有不同的内容类型，例如blob fetch，其中成功的响应将只是blob流作为有效负载。对于遵循OData的服务，应该遵循OData中指定的首选项顺序。</p></td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>Gzip, deflate</td>
<td>如果适用，REST端点应该支持GZIP和DEFLATE编码。对于非常大的资源，服务可能会忽略并返回未压缩的数据。</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>“en”, “es”, etc.</td>
<td>指定响应的首选语言。不需要服务来支持这一点，但是如果一个服务支持本地化，那么它必须通过Accept-Language头来支持本地化。</td>
</tr>
<tr>
<td>Accept-Charset</td>
<td>Charset type like “UTF-8”</td>
<td>默认值是UTF-8，但服务应该能够处理ISO-8859-1</td>
</tr>
<tr>
<td>Content-Type</td>
<td>Content type</td>
<td>Mime type of request body (PUT/POST/PATCH)</td>
</tr>
<tr>
<td>Prefer</td>
<td>return=minimal, return=representation</td>
<td>如果指定了return = minimal首选项，则服务应该返回一个空主体（empty body）以响应一次成功插入或更新。如果指定了return = representation，则服务应该在响应中返回创建或更新的资源。如果服务的场景中客户端有时会从响应中获益，但有时响应会对带宽造成太大的影响，那么它们应该支持这个报头。</td>
</tr>
<tr>
<td>If-Match, If-None-Match, If-Range</td>
<td>String</td>
<td>使用乐观并发控制支持资源更新的服务必须支持If-Match标头。服务也可以使用其他与ETag相关的头，只要它们遵循HTTP规范。</td>
</tr>
</tbody>
</table>
<h3><span class="ez-toc-section" id="%E6%A0%87%E5%87%86%E5%93%8D%E5%BA%94%E6%A0%87%E5%A4%B4"></span>标准响应标头<span class="ez-toc-section-end"></span></h3>
<p>服务应该返回以下响应标头，除非在“required”列中注明。</p>
<table>
<tbody>
<tr>
<td>Response Header</td>
<td>Required</td>
<td>Description</td>
</tr>
<tr>
<td>Date</td>
<td>All responses</td>
<td>根据服务器的时钟，以RFC 5322日期和时间格式处理响应。这个头必须包含在响应中。此报头必须使用格林尼治平均时间(GMT)作为时区参考。例如:Wed, 24 Aug 2016 18:41:30 GMT.请注意，GMT正好等于协调世界时(UTC)。</td>
</tr>
<tr>
<td>Content-Type</td>
<td>All responses</td>
<td>内容类型</td>
</tr>
<tr>
<td>Content-Encoding</td>
<td>All responses</td>
<td>GZIP或DEFLATE，视情况而定</td>
</tr>
<tr>
<td>Preference-Applied</td>
<td>在请求中指定时</td>
<td>是否应用了首选项请求头中指示的首选项</td>
</tr>
<tr>
<td>ETag</td>
<td>当请求的资源具有实体标记时</td>
<td>ETag响应头字段为请求的变量提供实体标记的当前值。与If-Match、If-None-Match和If-Range一起使用，实现乐观并发控制。</td>
</tr>
</tbody>
</table>
<h3><span class="ez-toc-section" id="%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%87%E5%A4%B4"></span>自定义标头<span class="ez-toc-section-end"></span></h3>
<p>基本的API操作不应该支持自定义标头。</p>
<p>本文档中的一些准则规定了非标准HTTP标头的使用。此外，某些服务可能需要添加额外的功能，这些功能通过HTTP标头文件公开。以下准则有助于在使用自定义标头时保持一致性。</p>
<p>非标准HTTP标头必须具有以下两种格式之一:</p>
<ul>
<li>使用IANA（<a href="https://tools.ietf.org/html/rfc3864">RFC 3864</a>）注册为“临时”的标头的通用格式</li>
<li>为注册使用过特定的头文件的范围格式</li>
</ul>
<p>这两种格式如下所述。</p>
<h3><span class="ez-toc-section" id="%E4%BB%A5%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0%E6%96%B9%E5%BC%8F%E6%8F%90%E4%BA%A4%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%B7%E6%B1%82%E5%A4%B4"></span>以查询参数方式提交自定义请求头<span class="ez-toc-section-end"></span></h3>
<p>有些标头对某些场景(如AJAX客户端)不兼容，特别是在不支持添加标头的跨域调用时。因此，除了常见的标头信息外，一些标头信息可以允许被作为查询参数传递给服务端，其命名与请求头中的名称保持一致。</p>
<p>并不是所有的标头都可以用作查询参数，包括大多数标准HTTP标头。 考虑何时接受标头作为参数的标准如下：</p>
<ul>
<li>任何自定义标头也必须作为参数接受。</li>
<li>请求的标准标头也可以作为参数接受。</li>
<li>具有安全敏感性的必需标头(例如，授权标头 Authorization)可能不适合作为参数;服务所有者应该具体情况具体分析。</li>
</ul>
<p>此规则的一个例外是Accept头。使用具有简单名称的方案，而不是使用HTTP规范中描述的用于Accept的完整功能，这是一种常见的实践。</p>
<h3><span class="ez-toc-section" id="PII_%E4%B8%AA%E4%BA%BA%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF%E5%8F%82%E6%95%B0"></span>PII 个人身份信息参数<span class="ez-toc-section-end"></span></h3>
<p>与普遍的隐私政策一致，客户端不应该在URL中传输个人身份信息(PII)参数(作为路径或查询参数)，因为这些信息可能通过客户端、网络和服务器日志和其他机制无意暴露出来。因此，服务应该接受PII参数作为标头传输。</p>
<p>然而在实践中，由于客户端或软件的限制，在许多情况下无法遵循上述建议。为了解决这些限制，服务也应该接受这些PII参数作为URL的一部分，与本指导原则的其余部分保持一致。</p>
<p>接受PII参数(无论是在URL中还是作为标头)的服务应该符合其组织的隐私保护原则。通常建议包括：客户端使用标头进行加密传输，并且实现要遵循特殊的预防措施，以确保日志和其他服务数据收集得到正确的处理。</p>
<h3><span class="ez-toc-section" id="%E5%93%8D%E5%BA%94%E6%A0%BC%E5%BC%8F"></span>响应格式<span class="ez-toc-section-end"></span></h3>
<p>一个成功的平台，往往以开发人员习惯使用的格式提供数据，并以一致的方式提供数据，并允许开发人员能够使用通用代码处理响应。</p>
<p>基于Web的通信，特别是当涉及移动或其他低带宽客户端时，由于各种原因，已经朝着JSON的方向快速发展，包括其重量更轻的趋势以及易于使用基于JavaScript的客户端。</p>
<p>基于Web的通信，特别是当涉及移动端或其他低带宽客户端时，我们推荐使用JSON作为传输格式。主要是由于其更轻量以及易于与JavaScript交互。</p>
<p>JSON属性名应该采用camelCased驼峰式命名规范。</p>
<p>服务应该提供JSON作为默认输出格式。</p>
<p><strong>客户端指定响应格式</strong></p>
<p>在HTTP中，客户端应该使用Accept头请求响应格式。服务端可以选择性的忽略，如客户端发送多个Accept标头，服务可以选择其中一个格式进行响应。</p>
<p>默认的响应格式(没有提供Accept头)应该是application/json，并且所有服务必须支持application/json。</p>
<table>
<tbody>
<tr>
<td>Accept Header</td>
<td>Response type</td>
<td>Notes</td>
</tr>
<tr>
<td>application/json</td>
<td>必须是返回json格式</td>
<td>同样接受JSONP请求的text/JavaScript</td>
</tr>
</tbody>
</table>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/products/user</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/products/user
Accept: application/json</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/products/user
Accept: application/json</pre>
<p><strong>错误的条件响应</strong></p>
<p>对于调用不成功的情况，开发人员应该能够用相同的代码库一致地处理错误。这允许构建简单可靠的基础架构来处理异常，将异常作为成功响应的独立处理流程来处理。下面的代码基于OData v4 JSON规范。但是，它非常通用，不需要特定的OData构造。即使api没有使用其他OData结构，也应该使用这种格式。</p>
<ul>
<li>错误响应必须是单个JSON对象。该对象必须有一个名为“error”的键/值（name/value）对。该值必须是JSON对象。</li>
<li>这个对象必须包含名称“code”和“message”的 键值对，并且它建议包含譬如“target”、“details”和 “innererror” 的键值对。
<ul>
<li>“code”键值对的值 是一个与语言无关的字符串。它的值是该服端务定义的错误代码，应该简单可读。与响应中指定的HTTP错误代码相比，此代码用作错误的更具体的指示。服务应该具有相对较少的“code”数量(别超过20个)，并且所有客户端必须能够处理所有这些错误信息。 大多数服务将需要更大数量的更具体的错误代码以满足所有的客户端请求。这些错误代码应该在“innererror” 键值对中公开，如下所述。为现有客户端可见的“代码”引入新值是一个破坏性的更改，需要增加版本。服务可以通过向“innererror”添加新的错误代码来避免中断服务更改。</li>
<li>“message”键值对的值 必须是错误提示消息，必须是可读且易于理解。它旨在是帮助开发人员，不适合暴露给最终用户。想要为最终用户公开合适消息的服务必须通过annotation注释或其他自定义属性来公开。服务不应该为最终用户本地化“message”，因为这样对于开发者变得非常不友好并且难以处理。</li>
<li>“target”键值对的值 是指向错误的具体的目标(例如，错误中属性的名称)。</li>
<li>“details”键值对的值 必须是JSON对象数组，其中必须包含“code”和“message”的键值对，还可能包含“target”的键值对，如上所述。“details”数组中的对象通常表示请求期间发生的不同的、相关的错误。请参见下面的例子。</li>
<li>“innererror”键值对的值 必须是一个对象。这个对象的内容是服务端定义的。想要返回比根级别代码更具体的错误的服务，必须包含“code”的键值对和嵌套的“innererror”。每个嵌套的“innererror”对象表示比其父对象更高层次的细节。在评估错误时，客户端必须遍历所有嵌套的“内部错误”，并选择他们能够理解的最深的一个。这个方案允许服务在层次结构的任何地方引入新的错误代码，而不破坏向后兼容性，只要旧的错误代码仍然出现。服务可以向不同的调用者返回不同级别的深度和细节。例如，在开发环境中，最深的“innererror”可能包含有助于调试服务的内部信息。为了防范信息公开带来的潜在安全问题，服务应注意不要无意中暴露过多的细节。错误对象还可以包括特定于代码的自定义服务器定义的键值对。带有自定义服务器定义属性的错误类型应该在服务的元数据文档中声明。请参见下面的例子。</li>
</ul>
</li>
</ul>
<p>错误响应返回的的任何JSON对象中都可能包含<a href="http://docs.oasis-open.org/odata/odata-json-format/v4.0/os/odata-json-format-v4.0-os.html#_Instance_Annotations">注释</a>。</p>
<p>我们建议，对于任何可能重试的临时错误，服务应该包含一个 Retry-After HTTP头，告诉客户端在再次尝试操作之前应该等待的最小秒数。</p>
<p>ErrorResponse : Object</p>
<table width="734">
<tbody>
<tr>
<td>Property</td>
<td>Type</td>
<td>Required</td>
<td>Description</td>
</tr>
<tr>
<td>error</td>
<td>Error</td>
<td>Yes</td>
<td>The error object.</td>
</tr>
</tbody>
</table>
<p>Error : Object</p>
<table>
<tbody>
<tr>
<td>Property</td>
<td>Type</td>
<td>Required</td>
<td>Description</td>
</tr>
<tr>
<td>code</td>
<td>String (enumerated)</td>
<td>Yes</td>
<td>服务器定义的错误代码集之一</td>
</tr>
<tr>
<td>message</td>
<td>String</td>
<td>Yes</td>
<td>一个可读性较高的错误信息</td>
</tr>
<tr>
<td>target</td>
<td>String</td>
<td></td>
<td>指向错误的具体的目标</td>
</tr>
<tr>
<td>details</td>
<td>Error[]</td>
<td></td>
<td>有关导致此报告错误的特定错误的详细信息数组。</td>
</tr>
<tr>
<td>innererror</td>
<td>InnerError</td>
<td></td>
<td>包含比当前对象更具体的错误信息的对象。</td>
</tr>
</tbody>
</table>
<p>InnerError : Object</p>
<table>
<tbody>
<tr>
<td>Property</td>
<td>Type</td>
<td>Required</td>
<td>Description</td>
</tr>
<tr>
<td>code</td>
<td>String</td>
<td></td>
<td>一个比包含错误的程序提供的更具体的错误代码。</td>
</tr>
<tr>
<td>innererror</td>
<td>InnerError</td>
<td></td>
<td>包含比当前对象更具体的错误信息的对象。</td>
</tr>
</tbody>
</table>
<p><u>Examples</u></p>
<p>内部错误的例子:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"error"</span><span class="enlighter-text">: </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"BadArgument"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"message"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Previous passwords may not be reused"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"target"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"password"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"innererror"</span><span class="enlighter-text">: </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"PasswordError"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"innererror"</span><span class="enlighter-text">: </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"PasswordDoesNotMeetPolicy"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"minLength"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"6"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"maxLength"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"64"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"characterTypes"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-s0">"lowerCase"</span><span class="enlighter-text">,</span><span class="enlighter-s0">"upperCase"</span><span class="enlighter-text">,</span><span class="enlighter-s0">"number"</span><span class="enlighter-text">,</span><span class="enlighter-s0">"symbol"</span><span class="enlighter-g1">]</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"minDistinctCharacterTypes"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"innererror"</span><span class="enlighter-text">: </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"PasswordReuseNotAllowed"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "error": {
    "code": "BadArgument",
    "message": "Previous passwords may not be reused",
    "target": "password",
    "innererror": {
      "code": "PasswordError",
      "innererror": {
        "code": "PasswordDoesNotMeetPolicy",
        "minLength": "6",
        "maxLength": "64",
        "characterTypes": ["lowerCase","upperCase","number","symbol"],
        "minDistinctCharacterTypes": "2",
        "innererror": {
          "code": "PasswordReuseNotAllowed"
        }
      }
    }
  }
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "error": {
    "code": "BadArgument",
    "message": "Previous passwords may not be reused",
    "target": "password",
    "innererror": {
      "code": "PasswordError",
      "innererror": {
        "code": "PasswordDoesNotMeetPolicy",
        "minLength": "6",
        "maxLength": "64",
        "characterTypes": ["lowerCase","upperCase","number","symbol"],
        "minDistinctCharacterTypes": "2",
        "innererror": {
          "code": "PasswordReuseNotAllowed"
        }
      }
    }
  }
}
</pre>
<p>在本例中，基本的错误代码是“BadArgument”，但是对于感兴趣的客户端，“innererror”中提供了更具体的错误代码。 “passwordreusenotal”代码可能是在之后的迭代中由该服务添加的，之前只返回“passwordnotmeetpolicy”。 这种增量型的添加方式并不会破坏老的客户端的处理过程，而又可以给开发者一些更详细的信息。 “PasswordDoesNotMeetPolicy”错误还包括额外的键值对，这些键值对 允许客户机确定服务器的配置、以编程方式验证用户的输入，或者在客户机自己的本地化消息传递中向用户显示服务器的约束。</p>
<p>详细的例子 “details”:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"error"</span><span class="enlighter-text">: </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"BadArgument"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"message"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Multiple errors in ContactInfo data"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"target"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"ContactInfo"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"details"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"NullValue"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"target"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"PhoneNumber"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"message"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Phone number must not be null"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"NullValue"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"target"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"LastName"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"message"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Last name must not be null"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"MalformedValue"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"target"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Address"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">        </span><span class="enlighter-s0">"message"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Address is not valid"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "error": {
    "code": "BadArgument",
    "message": "Multiple errors in ContactInfo data",
    "target": "ContactInfo",
    "details": [
      {
        "code": "NullValue",
        "target": "PhoneNumber",
        "message": "Phone number must not be null"
      },
      {
        "code": "NullValue",
        "target": "LastName",
        "message": "Last name must not be null"
      },
      {
        "code": "MalformedValue",
        "target": "Address",
        "message": "Address is not valid"
      }
    ]
  }
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "error": {
    "code": "BadArgument",
    "message": "Multiple errors in ContactInfo data",
    "target": "ContactInfo",
    "details": [
      {
        "code": "NullValue",
        "target": "PhoneNumber",
        "message": "Phone number must not be null"
      },
      {
        "code": "NullValue",
        "target": "LastName",
        "message": "Last name must not be null"
      },
      {
        "code": "MalformedValue",
        "target": "Address",
        "message": "Address is not valid"
      }
    ]
  }
}
</pre>
<p>在本例中，请求存在多处问题，每个错误都列在 “details” 字段中进行返回了。</p>
<h3><span class="ez-toc-section" id="HTTP%E7%8A%B6%E6%80%81%E7%A0%81"></span>HTTP状态码<span class="ez-toc-section-end"></span></h3>
<p>应使用标准HTTP状态码作为响应状态码;;更多信息，请参见HTTP状态代码定义。</p>
<h3><span class="ez-toc-section" id="%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BA%93%E5%8F%AF%E9%80%89"></span>客户端库可选<span class="ez-toc-section-end"></span></h3>
<p>开发人员必须能够在各种平台和语言上进行开发，比如Windows、macOS、Linux、c#、Python和Node.js或是Ruby。</p>
<p>服务应该能够让简单的HTTP工具进行访问，而不需要做太多的工作。</p>
<p>该服务提供给开发人员的网站应该提供相当于“获得开发者令牌(Get developer Token)”的功能，以帮助开发人员测试并应提供curl支持。</p>
<h2><span class="ez-toc-section" id="CORS_%E8%B7%A8%E5%9F%9F"></span>CORS 跨域<span class="ez-toc-section-end"></span></h2>
<p>符合Microsoft REST API准则的服务必须支持<a href="http://www.w3.org/TR/access-control/">CORS(跨源资源共享)</a>。 服务应该支持CORS * 的允许起源，并通过有效的OAuth令牌强制授权。 服务不应该支持带有源验证的用户凭据。特殊情况可例外。</p>
<h3><span class="ez-toc-section" id="%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8C%87%E5%AF%BC"></span>客户端指导<span class="ez-toc-section-end"></span></h3>
<p>Web开发人员通常不需要做任何特殊处理来利用CORS。 作为标准XMLHttpRequest调用的一部分，所有握手步骤都是不可见的。</p>
<p>许多其他平台（如.NET）已集成了对CORS的支持。</p>
<p><strong>避免额外的预检查</strong></p>
<p>由于CORS协议会触发向服务器添加额外往返的预检请求，因此，注重性能的应用程序可能会有意避免这些请求。CORS背后的精神是避免对旧的不支持CORS功能的浏览器能够做出的任何简单的跨域请求进行预检。所有其他请求都需要预检。</p>
<p>请求是“简单类型请求”，如果其方法是GET，HEAD或POST，并且除了Accept，Accept-Language和Content-Language之外它不包含任何请求标头，则可以免去预检。</p>
<p>对于POST请求，也允许使用Content-Type标头，但前提是其值为“application/x-www-form-urlencoded”，“multipart/form-data”或“text/plain”。 对于任何其他标头或值，将发生预检请求。</p>
<h3><span class="ez-toc-section" id="%E6%9C%8D%E5%8A%A1%E6%8C%87%E5%8D%97"></span>服务指南<span class="ez-toc-section-end"></span></h3>
<p>服务必须至少：</p>
<ul>
<li>了解浏览器在跨域请求上发送的Origin请求标头，以及他们在检查访问权限的预检OPTIONS 请求上发送的 Access-Control-Request-Method请求标头。</li>
<li>如果请求中存在Origin标头：
<ul>
<li>如果请求使用 OPTIONS 方法并包含 Access-Control-Request-Method 标头，则它是一个预检请求，旨在在实际请求之前探测访问。否则，它是一个实际请求。对于预检请求，除了执行以下步骤添加标头之外，服务必须不执行其他处理并且必须返回 200 OK。对于非预检请求，除了请求的常规处理之外，还添加了以下标头。</li>
<li>向响应添加一个 Access-Control-Allow-Origin 标头，包含与 Origin 请求标头相同的值。请注意，这需要服务动态生成标头值。不需要 cookie 或任何其他形式的<a href="https://www.w3.org/TR/access-control/#user-credentials">用户凭据</a>的资源可以用通配符星号 (*) 代替。请注意，通配符仅在此处可接受，不适用于下面描述的任何其他标头。</li>
<li>如果调用者需要访问不在<a href="https://www.w3.org/TR/access-control/#simple-header">简单响应头</a>集合（Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma）中的响应头，则添加一个 Access-Control-Expose-标头标头包含客户端应有权访问的附加响应标头名称列表。</li>
<li>如果请求需要 cookie，则添加设置为“true”的 Access-Control-Allow-Credentials 标头。</li>
<li>如果请求是预检请求（参见第一个项目符号），则服务必须：
<ul>
<li>添加一个 Access-Control-Allow-Headers 响应标头，其中包含允许客户端使用的请求标头名称列表。此列表只需要包含不在<a href="https://www.w3.org/TR/access-control/#simple-header">简单请求头</a>（Accept、Accept-Language、Content-Language）集合中的标头。如果服务接受的头部没有限制，服务可以简单地返回与客户端发送的 Access-Control-Request-Headers 头部相同的值。</li>
<li>添加一个 Access-Control-Allow-Methods 响应头，其中包含允许调用者使用的 HTTP 方法列表。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>添加一个Access-Control-Max-Age pref响应头，其中包含此预检前响应有效的秒数(因此可以在后续实际请求之前避免)。注意，虽然习惯上使用较大的值，比如2592000(30天)，但是许多浏览器会自动设置一个更低的限制(例如，5分钟)。</p>
<p>因为浏览器预检响应缓存是出了名的弱，预检响应的额外往返会损害性能。</p>
<p>译者注：获取预检OPTIONS调用会造成很大开销，而且浏览器的缓存能力也很弱，而且部分浏览器也不会理会access-control-max-age的设置值，如<a href="https://chromium.googlesource.com/chromium/blink/+/refs/heads/main/Source/core/loader/CrossOriginPreflightResultCache.cpp#40">Chrome/Blink 就硬编码为10分钟（600秒）</a>。详见</p>
<p>注重性能端的交互式 Web客户端使用的服务端应该避免使用导致预检的请求。</p>
<ul>
<li>对于GET和HEAD调用，请避免要求不属于上述简单集的请求标头。最好是允许将它们作为查询参数提供。
<ul>
<li>Authorization标头不是简单集的一部分，因此对于需要验证的资源，必须通过“access_token”查询参数发送验证令牌。请注意，不建议在URL中传递身份验证令牌，因为它可能导致令牌记录在服务器日志中，并暴露给有权访问这些日志的任何人。通过URL接受身份验证令牌的服务必须采取措施来降低安全风险，例如使用短期身份验证令牌，禁止记录身份验证令牌以及控制对服务器日志的访问。</li>
</ul>
</li>
<li>避免要求cookie。如果设置了“withCredentials”属性，XmlHttpRequest将仅在跨域请求上发送cookie; 这也会导致预检请求。
<ul>
<li>需要基于cookie的身份验证的服务必须使用“动态验证码（dynamic canary）” [*]译者注：服务器生成某种验证码，客户端获取后，服务器再进行验证的操作。来保护所有接受cookie的API。</li>
</ul>
</li>
<li>对于POST调用，在适用的情况下，选择简单的内容类型(“application/x-www-form-urlencoded”、“multipart/form-data”、“text/plain”)。其他任何内容类型都会引发预检请求。
<ul>
<li>服务不得以避免CORS预检请求的名义违反其他API指南。由于内容类型的原因，大多数POST请求实际上需要预检请求。</li>
<li>如果非要取消预检工作，那么<a href="https://cloud.tencent.com/product/ds?from=10680">服务支持</a>的其他的替代数据传输机制必须遵循本指南。</li>
</ul>
</li>
</ul>
<p>此外，当适当的服务可以支持JSONP模式时，只需简单的GET跨域访问。 在JSONP中，服务采用指示格式的参数($format=json)和表示回调的参数($callback=someFunc)，并返回一个 text/javascript 文档，其中包含用指定名称封装在函数调用中的JSON响应。 更多关于JSONP的信息，请访问<a href="https://en.wikipedia.org/wiki/JSONP">JSONP</a>。</p>
<h2><span class="ez-toc-section" id="Collections%E9%9B%86%E5%90%88"></span>Collections集合<span class="ez-toc-section-end"></span></h2>
<h3><span class="ez-toc-section" id="%E5%85%83%E7%B4%A0keys"></span>元素keys<span class="ez-toc-section-end"></span></h3>
<p>服务可以支持集合中每个项的持久标识符(主键)，该标识符应用JSON表示为”id” , 这些持久标识符通常用作项目的key。</p>
<p>支持持久标识符(主键)的集合可以支持增量查询。</p>
<h3><span class="ez-toc-section" id="%E5%BA%8F%E5%88%97%E5%8C%96"></span>序列化<span class="ez-toc-section-end"></span></h3>
<p>集合使用标准数组表示法以JSON表示。</p>
<h3><span class="ez-toc-section" id="%E9%9B%86%E5%90%88%E7%9A%84URL%E5%8C%B9%E9%85%8D"></span>集合的URL匹配<span class="ez-toc-section-end"></span></h3>
<p>集合在顶级时直接位于服务的根目录下，或者作用于该资源时作为另一个资源下的段。</p>
<p>例如:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/people</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/people</pre>
<p>服务必须尽可能支持“/” 匹配。 例如:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//{serviceRoot}/{collection}/{id}</span></div></div></div><div class="enlighter-raw">GET https://{serviceRoot}/{collection}/{id}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://{serviceRoot}/{collection}/{id}</pre>
<p>其中:</p>
<ul>
<li>{serviceRoot} – 站点URL (site URL) + 服务的根路径的组合</li>
<li>{collection} – 集合的名称，未缩写，复数</li>
<li>{id} – 唯一id属性的值. 当使用 “/“ 匹配必须属于 string/number/guid value 不带引号，转义正确以适应URL。</li>
</ul>
<p><strong>嵌套集合和属性</strong></p>
<p>集合项可以包含其他集合。 例如，用户集合可能包含多个地址的用户资源:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people/123/addresses</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"street"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"1st Avenue"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"city"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Seattle"</span><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"street"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"124th Ave NE"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"city"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Redmond"</span><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/people/123/addresses
{
  "value": [
    { "street": "1st Avenue", "city": "Seattle" },
    { "street": "124th Ave NE", "city": "Redmond" }
  ]
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/people/123/addresses
{
  "value": [
    { "street": "1st Avenue", "city": "Seattle" },
    { "street": "124th Ave NE", "city": "Redmond" }
  ]
}
</pre>
<h3><span class="ez-toc-section" id="%E5%A4%A7%E9%9B%86%E5%90%88"></span>大集合<span class="ez-toc-section-end"></span></h3>
<p>随着数据的增长，集合也在增长。所以计划采用分页对所有服务都很重要。 因此，当数据包含多页时，序列化有效负载(payload)必须适当地包含下一页的不透明URL。 有关详细信息，请参阅分页指南。</p>
<p>客户端必须能够恰当的处理请求返回的任何给定的分页或非分页集合数据。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">:</span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Item 1"</span><span class="enlighter-text">,</span><span class="enlighter-s0">"price"</span><span class="enlighter-text">: </span><span class="enlighter-n0">99.95</span><span class="enlighter-text">,</span><span class="enlighter-s0">"sizes"</span><span class="enlighter-text">: </span><span class="enlighter-k1">null</span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> … </span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> … </span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Item 99"</span><span class="enlighter-text">,</span><span class="enlighter-s0">"price"</span><span class="enlighter-text">: </span><span class="enlighter-n0">59.99</span><span class="enlighter-text">,</span><span class="enlighter-s0">"sizes"</span><span class="enlighter-text">: </span><span class="enlighter-k1">null</span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">]</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"@nextLink"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"{opaqueUrl}"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "value":[
    { "id": "Item 1","price": 99.95,"sizes": null},
    { … },
    { … },
    { "id": "Item 99","price": 59.99,"sizes": null}
  ],
  "@nextLink": "{opaqueUrl}"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "value":[
    { "id": "Item 1","price": 99.95,"sizes": null},
    { … },
    { … },
    { "id": "Item 99","price": 59.99,"sizes": null}
  ],
  "@nextLink": "{opaqueUrl}"
}
</pre>
<h3><span class="ez-toc-section" id="%E9%9B%86%E5%90%88%E7%9A%84%E6%9B%B4%E6%94%B9"></span>集合的更改<span class="ez-toc-section-end"></span></h3>
<p>POST请求不是幂等的。 这意味着发送到具有完全相同的有效负载(payload)的集合资源的两次POST请求可能导致在该集合中创建多个项。 [*]译者注：相同的数据两次POST操作，可能导致该集合创建多次。 例如，对于具有服务器端生成的id的项的插入操作，通常就是这种情况。</p>
<p>例如，以下请求:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">POST https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people</span></div></div></div><div class="enlighter-raw">POST https://api.contoso.com/v1.0/people</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">POST https://api.contoso.com/v1.0/people</pre>
<p>会导致响应，指示新集合项的位置：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">201 Created</span></div></div><div class=""><div><span class="enlighter-text">Location: https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people/123</span></div></div></div><div class="enlighter-raw">201 Created
Location: https://api.contoso.com/v1.0/people/123</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">201 Created
Location: https://api.contoso.com/v1.0/people/123</pre>
<p>一旦再次执行，可能会导致创建另一个资源：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">201 Created</span></div></div><div class=""><div><span class="enlighter-text">Location: https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people/124</span></div></div></div><div class="enlighter-raw">201 Created
Location: https://api.contoso.com/v1.0/people/124</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">201 Created
Location: https://api.contoso.com/v1.0/people/124</pre>
<p>而PUT请求则需要使用相应的键来指示集合项:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">PUT https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people/123</span></div></div></div><div class="enlighter-raw">PUT https://api.contoso.com/v1.0/people/123</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">PUT https://api.contoso.com/v1.0/people/123</pre>
<h3><span class="ez-toc-section" id="%E9%9B%86%E5%90%88%E7%9A%84%E6%8E%92%E5%BA%8F"></span>集合的排序<span class="ez-toc-section-end"></span></h3>
<p>可以基于属性值对集合查询的结果进行排序。 该属性由_$orderBy_查询参数的值确定。</p>
<p>$orderBy 参数的值包含用于对项目进行排序表达式列表，用逗号分隔的。 这种表达式的特殊情况是属性路径终止于基本属性。</p>
<p>表达式可以包含升序的后缀“asc”或降序的后缀“desc”，它们与属性名之间用一个或多个空格分隔。 如果没有指定“asc”或“desc”，则服务必须按照指定的属性以升序排序。</p>
<p>空值(NULL)必须排序为“小于”非空值。</p>
<p>必须根据第一个表达式的结果值对项进行排序，然后根据第二个表达式的结果值对第一个表达式具有相同值的项进行排序，以此类推。 排序顺序是属性类型的固有顺序。</p>
<p>例如：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people?$orderBy=name</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/people?$orderBy=name</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/people?$orderBy=name</pre>
<p>将返回按name进行升序排序的所有人员。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people?$orderBy=name desc</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/people?$orderBy=name desc</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/people?$orderBy=name desc</pre>
<p>将返回按name进行降序排序的所有人。</p>
<p>可以通过逗号分隔的属性名称列表以及可选方向限定符来指定子排序。</p>
<p>例如：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people?$orderBy=name desc,hireDate</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/people?$orderBy=name desc,hireDate</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/people?$orderBy=name desc,hireDate</pre>
<p>将返回按姓名降序排列的所有人员，并按雇佣日期降序排列的次要排序。</p>
<p>排序必须与筛选相结合，如下:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people?$filter=name eq 'david'&amp;$orderBy=hireDate</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/people?$filter=name eq 'david'&amp;$orderBy=hireDate</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/people?$filter=name eq 'david'&amp;$orderBy=hireDate</pre>
<p>将返回所有名称为David的人，按雇佣日期按升序排列。</p>
<p><strong>排序表达式注解</strong></p>
<p>跨页面的排序参数必须一致，因为客户端和服务器端分页都依赖该排序该参数进行排序。</p>
<p>如果服务不支持按_$orderBy_表达式中命名的属性排序，则服务必须按照“响应不支持的请求”部分中定义的错误消息进行响应。</p>
<h3><span class="ez-toc-section" id="Filtering%E8%BF%87%E6%BB%A4"></span>Filtering过滤<span class="ez-toc-section-end"></span></h3>
<p>$filter_querystring 参数允许客户端通过URL过滤集合。 使用_$filter_指定的表达式将为集合中的每个资源求值，只有表达式求值为true的项才包含在响应中。 表达式计算为false或null的资源，或由于权限而不可用的引用属性，将从响应中省略。</p>
<p>例如:返回所有产品的价格低于10.00美元</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/products?$filter=price lt 10.00</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/products?$filter=price lt 10.00</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/products?$filter=price lt 10.00</pre>
<p>$filter_选项的值是 一个布尔表达式 表示 price less than 10.00。</p>
<p><strong>过滤操作符</strong></p>
<p>支持_$filter_的服务应该支持以下最小操作集。</p>
<table>
<tbody>
<tr>
<td>Operator</td>
<td>Description</td>
<td>Example</td>
</tr>
<tr>
<td>Comparison Operators</td>
<td></td>
<td></td>
</tr>
<tr>
<td>eq</td>
<td>Equal</td>
<td>city eq ‘Redmond’</td>
</tr>
<tr>
<td>ne</td>
<td>Not equal</td>
<td>city ne ‘London’</td>
</tr>
<tr>
<td>gt</td>
<td>Greater than</td>
<td>price gt 20</td>
</tr>
<tr>
<td>ge</td>
<td>Greater than or equal</td>
<td>price ge 10</td>
</tr>
<tr>
<td>lt</td>
<td>Less than</td>
<td>price lt 20</td>
</tr>
<tr>
<td>le</td>
<td>Less than or equal</td>
<td>price le 100</td>
</tr>
<tr>
<td>Logical Operators</td>
<td></td>
<td></td>
</tr>
<tr>
<td>and</td>
<td>Logical and</td>
<td>price le 200 and price gt 3.5</td>
</tr>
<tr>
<td>or</td>
<td>Logical or</td>
<td>price le 3.5 or price gt 200</td>
</tr>
<tr>
<td>not</td>
<td>Logical negation</td>
<td>not price le 3.5</td>
</tr>
<tr>
<td>Grouping Operators</td>
<td></td>
<td></td>
</tr>
<tr>
<td>( )</td>
<td>Precedence grouping</td>
<td>(priority eq 1 or city eq ‘Redmond’) and price gt 100</td>
</tr>
</tbody>
</table>
<p><strong>操作符示例</strong></p>
<p>下面的示例说明了每个逻辑操作符的用法和语义。</p>
<p>示例:所有名称等于“Milk”的产品</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/products?$filter=name eq 'Milk'</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/products?$filter=name eq 'Milk'</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/products?$filter=name eq 'Milk'</pre>
<p>示例:所有名称不等于“Milk”的产品</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/products?$filter=name ne 'Milk'</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/products?$filter=name ne 'Milk'</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/products?$filter=name ne 'Milk'</pre>
<p>示例:所有标有“Milk”的产品价格都低于2.55:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/products?$filter=name eq 'Milk' and price lt 2.55</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/products?$filter=name eq 'Milk' and price lt 2.55</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/products?$filter=name eq 'Milk' and price lt 2.55</pre>
<p>示例:所有标有“Milk”字样或价格低于2.55美元的产品:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/products?$filter=name eq 'Milk' or price lt 2.55</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/products?$filter=name eq 'Milk' or price lt 2.55</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/products?$filter=name eq 'Milk' or price lt 2.55</pre>
<p>示例:所有名称为“牛奶”或“鸡蛋”且价格低于2.55的产品:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/products?$filter=(name eq 'Milk' or name eq 'Eggs') and price lt 2.55</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/products?$filter=(name eq 'Milk' or name eq 'Eggs') and price lt 2.55</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/products?$filter=(name eq 'Milk' or name eq 'Eggs') and price lt 2.55</pre>
<p><strong>操作符优先级</strong></p>
<p>在计算_$filter_表达式时，服务使用以下操作符优先级。 操作符按类别按优先级从高到低排列。 同一类别的运算符具有同等优先级:</p>
<table>
<tbody>
<tr>
<td>Group</td>
<td>Operator</td>
<td>Description</td>
</tr>
<tr>
<td>Grouping</td>
<td>( )</td>
<td>Precedence grouping</td>
</tr>
<tr>
<td>Unary</td>
<td>not</td>
<td>Logical Negation</td>
</tr>
<tr>
<td>Relational</td>
<td>gt</td>
<td>Greater Than</td>
</tr>
<tr>
<td></td>
<td>ge</td>
<td>Greater than or Equal</td>
</tr>
<tr>
<td></td>
<td>lt</td>
<td>Less Than</td>
</tr>
<tr>
<td></td>
<td>le</td>
<td>Less than or Equal</td>
</tr>
<tr>
<td>Equality</td>
<td>eq</td>
<td>Equal</td>
</tr>
<tr>
<td></td>
<td>ne</td>
<td>Not Equal</td>
</tr>
<tr>
<td>Conditional AND</td>
<td>and</td>
<td>Logical And</td>
</tr>
<tr>
<td>Conditional OR</td>
<td>or</td>
<td>Logical Or</td>
</tr>
</tbody>
</table>
<h3><span class="ez-toc-section" id="Pagination%E5%88%86%E9%A1%B5"></span>Pagination分页<span class="ez-toc-section-end"></span></h3>
<p>返回集合的RESTful API可能返回部分集。这些服务的消费者清楚将获得部分结果集，并能正确地翻页以检索整个结果集。</p>
<p>RESTful API可能支持两种形式的分页。</p>
<ul>
<li>服务器驱动的分页：通过在多个响应有效载荷上强制分页请求来减轻拒绝服务攻击。</li>
<li>客户端驱动的分页：允许客户机只请求它在给定时间可以使用的资源数量。</li>
</ul>
<p>跨页面的排序和筛选参数必须一致，因为客户端和服务器端分页都完全兼容于筛选和排序。</p>
<p><strong>服务器驱动的分页</strong></p>
<p>分页响应必须通过在响应中包含延续分页标记来告诉客户端这是部分结果。没有延续分页标记意味着没有下一页了。</p>
<p>客户端必须将延续URL视为不透明的，这意味着在迭代一组部分结果时，查询选项可能不会更改。</p>
<p>例如:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET http:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people HTTP/1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">200</span><span class="enlighter-text"> OK</span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  ...,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-text">...</span><span class="enlighter-g1">]</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"@nextLink"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"{opaqueUrl}"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">GET http://api.contoso.com/v1.0/people HTTP/1.1
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  ...,
  "value": [...],
  "@nextLink": "{opaqueUrl}"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET http://api.contoso.com/v1.0/people HTTP/1.1
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  ...,
  "value": [...],
  "@nextLink": "{opaqueUrl}"
}
</pre>
<p><strong>客户端驱动的分页</strong></p>
<p>客户端可以使用$top_和$skip_查询参数来指定返回的结果数量和跳过的集合数量。</p>
<p>服务器应遵守客户端指定的参数；但是，客户端必须做好准备处理包含不同页面大小的响应或包含延续分页标记的响应。</p>
<p>当客户端同时提供 $top 和 $skip 时，服务器应该首先在集合上应用 $skip 然后应用 $top。</p>
<p>注意：如果服务器不能接受 $top 和/或 $skip，服务器必须向客户端返回一个错误通知，而不是仅仅忽略查询选项。 这将避免客户端对返回的数据做出假设的风险。</p>
<p>实例:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET http:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people?$top=5&amp;$skip=2 HTTP/1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">200</span><span class="enlighter-text"> OK</span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  ...,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-text">...</span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">GET http://api.contoso.com/v1.0/people?$top=5&amp;$skip=2 HTTP/1.1
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  ...,
  "value": [...]
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET http://api.contoso.com/v1.0/people?$top=5&amp;$skip=2 HTTP/1.1
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  ...,
  "value": [...]
}
</pre>
<p><strong>其他注意事项</strong></p>
<ul>
<li>固定的顺序先决条件：两种分页形式都依赖于具有固定顺序的项的集合。 服务器必须使用额外的排序(通常是按键排序)来补充任何指定的顺序标准，以确保项目始终保持一致的顺序。</li>
<li>缺失/重复结果：即使服务器强制执行一致的排序顺序，结果也可能会因创建或删除其他资源而导致丢失或重复。 客户端必须准备好处理这些差异。 服务器应该总是编码最后读取记录的记录ID，帮助客户端管理重复/丢失的结果。</li>
<li>结合客户端和服务驱动的分页：请注意，客户端驱动的分页不排除服务器驱动的分页。 如果客户端请求的页面大小大于服务器支持的默认页面大小，则预期响应将是客户端指定的结果数，否则按服务端分页设置的指定分页。</li>
<li>页面大小：客户端可以通过指定$maxpagesize首选项来请求具有特定页面大小的服务端驱动的分页。 如果指定的页面大小小于服务端的默认页面大小，服务器应该遵循此首选项。</li>
<li>分页嵌入式集合：客户端驱动的分页和服务端驱动的分页都可以应用于嵌入式集合。 如果服务端对嵌入式集合进行分页，则必须包含其他适当的延续分页标记。</li>
<li>记录集计数：想要知道所有页面中的完整记录数的开发人员可以包含查询参数_$ count=true_，以告知服务端包含响应中的记录数。</li>
</ul>
<h3><span class="ez-toc-section" id="%E5%A4%8D%E5%90%88%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C"></span>复合集合操作<span class="ez-toc-section-end"></span></h3>
<p>筛选、排序和分页操作都可以针对给定的集合执行。 当这些操作一起执行时，评估顺序必须是：</p>
<ul>
<li>筛选。这包括作为AND操作执行的所有范围表达式。</li>
<li>排序。可能已过滤的列表根据排序条件进行排序。</li>
<li>分页。经过筛选和排序的列表上显示了实现分页视图。这适用于服务器驱动的分页和客户端驱动的分页。</li>
</ul>
<h3><span class="ez-toc-section" id="%E7%A9%BA%E7%BB%93%E6%9E%9C%E9%9B%86"></span>空结果集<span class="ez-toc-section-end"></span></h3>
<p>当对集合执行过滤器并且结果集为空时，您必须使用有效的响应正文和 200 响应代码进行响应。 在这个例子中，客户端提供的过滤器导致一个空的结果集。 响应正文正常返回，并且 value 属性设置为空集合。 根据您对产生结果的类似调用的响应格式，客户端可能期望像 maxItems 这样的元数据属性。 您应该尽可能保持 API 的一致性。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/products?$filter=(name eq 'Milk' or name eq 'Eggs') and price lt 2.55</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">200</span><span class="enlighter-text"> OK</span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  ...,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"maxItems"</span><span class="enlighter-text">: </span><span class="enlighter-n1">0</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/products?$filter=(name eq 'Milk' or name eq 'Eggs') and price lt 2.55
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  ...,
  "maxItems": 0,
  "value": []
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/products?$filter=(name eq 'Milk' or name eq 'Eggs') and price lt 2.55
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  ...,
  "maxItems": 0,
  "value": []
}
</pre>
<h2><span class="ez-toc-section" id="%E5%A2%9E%E9%87%8F%E6%9F%A5%E8%AF%A2"></span>增量查询<span class="ez-toc-section-end"></span></h2>
<p>服务可以选择支持Delta查询。</p>
<h3><span class="ez-toc-section" id="%E5%A2%9E%E9%87%8F%E9%93%BE%E6%8E%A5"></span>增量链接<span class="ez-toc-section-end"></span></h3>
<p>增量(Delta)链接是不透明的、由服务生成的链接，客户端使用这些链接查询对结果的后续更改。</p>
<p>在概念层面上，delta链接基于一个定义查询，该查询描述正在跟踪更改的一组结果集。delta链接编码并跟踪这些更改的实体集合，以及跟踪更改的起点。</p>
<p>如果查询包含筛选器，则响应必须只包含对匹配指定条件的实体的更改。 Delta查询的主要原则是:</p>
<ul>
<li>集合中的每个项目必须具有持久标识符（永久不变的主键）。该标识符应该表示为“id”。此标识符由服务定义，客户端可以使用该字符串跨调用跟踪对象。</li>
<li>delta 必须包含每个与指定条件新匹配的实体的条目，并且必须为每个不再符合条件的实体包含“@removed”条目。</li>
<li>重新调用查询并将其与原始结果集进行比较; 必须将当前集合中惟一的每个条目作为”add”操作返回，并且必须将原始集合中惟一的每个条目作为“remove”操作返回。。</li>
<li>以前与标准不匹配但现在匹配的每个实体必须作为”add”返回; 相反，先前与查询匹配但不再必须返回的每个实体必须作为“@removed”条目返回。</li>
<li>已更改的实体必须使用其标准表示形式包含在集合中。</li>
<li>服务可以向“@remove”节点添加额外的元数据，例如删除的原因或“removed at”时间戳。我们建议团队与Microsoft REST API指导原则工作组协调，以帮助维护一致性。</li>
</ul>
<p>Delta链接不能编码任何客户端 top 或 skip 值。</p>
<h3><span class="ez-toc-section" id="%E5%AE%9E%E4%BD%93%E8%A1%A8%E7%A4%BA"></span>实体表示<span class="ez-toc-section-end"></span></h3>
<p>添加和更新的实体使用其标准表示在实体集中表示。从集合的角度来看，添加或更新的实体之间没有区别。</p>
<p>删除的实体仅使用其“id”和“@removed”节点表示。 “@removed”节点的存在必须表示从集合中删除条目。</p>
<h3><span class="ez-toc-section" id="%E8%8E%B7%E5%8F%96%E5%A2%9E%E9%87%8F%E9%93%BE%E6%8E%A5"></span>获取增量链接<span class="ez-toc-section-end"></span></h3>
<p>通过查询集合或实体并附加 $delta 查询字符串参数来获得 Delta 链接。</p>
<p>例如：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people?$delta</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">200</span><span class="enlighter-text"> OK</span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">:</span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"1"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"name"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Matt"</span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"name"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Mark"</span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"3"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"name"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"John"</span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">]</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"@deltaLink"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"{opaqueUrl}"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/people?$delta
HTTP/1.1
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  "value":[
    { "id": "1", "name": "Matt"},
    { "id": "2", "name": "Mark"},
    { "id": "3", "name": "John"}
  ],
  "@deltaLink": "{opaqueUrl}"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/people?$delta
HTTP/1.1
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  "value":[
    { "id": "1", "name": "Matt"},
    { "id": "2", "name": "Mark"},
    { "id": "3", "name": "John"}
  ],
  "@deltaLink": "{opaqueUrl}"
}
</pre>
<p>注意:如果集合分页，deltaLink将只出现在最后一页，但必须反映对所有页面返回的数据的任何更改。</p>
<h3><span class="ez-toc-section" id="%E5%A2%9E%E9%87%8F%E9%93%BE%E6%8E%A5%E5%93%8D%E5%BA%94%E7%9A%84%E5%86%85%E5%AE%B9"></span>增量链接响应的内容<span class="ez-toc-section-end"></span></h3>
<p>添加/更新的条目必须以常规JSON对象的形式出现，并带有常规项目属性。在常规表示中返回添加/修改的项，允许客户端使用基于“id”字段的标准合并概念将它们合并到现有的“缓存”中。</p>
<p>从定义的集合中删除的条目必须包含在响应中。从集合中删除的项必须仅使用它们的“id”和“@remove”节点表示。</p>
<h3><span class="ez-toc-section" id="%E4%BD%BF%E7%94%A8%E5%A2%9E%E9%87%8F%E9%93%BE%E6%8E%A5"></span>使用增量链接<span class="ez-toc-section-end"></span></h3>
<p>客户端通过调用delta链接上的GET方法请求更改。 客户端必须按原样使用delta URL——换句话说，客户端不能以任何方式修改URL(例如，解析URL并添加额外的查询字符串参数)。</p>
<p>在这个例子中:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//{opaqueUrl} HTTP/1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">200</span><span class="enlighter-text"> OK</span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">:</span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"1"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"name"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Mat"</span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"name"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Marc"</span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"3"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"@removed"</span><span class="enlighter-text">: </span><span class="enlighter-g1">{}</span><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"4"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"name"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Luc"</span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">]</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"@deltaLink"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"{opaqueUrl}"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">GET https://{opaqueUrl} HTTP/1.1
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  "value":[
    { "id": "1", "name": "Mat"},
    { "id": "2", "name": "Marc"},
    { "id": "3", "@removed": {} },
    { "id": "4", "name": "Luc"}
  ],
  "@deltaLink": "{opaqueUrl}"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://{opaqueUrl} HTTP/1.1
Accept: application/json

HTTP/1.1 200 OK
Content-Type: application/json

{
  "value":[
    { "id": "1", "name": "Mat"},
    { "id": "2", "name": "Marc"},
    { "id": "3", "@removed": {} },
    { "id": "4", "name": "Luc"}
  ],
  "@deltaLink": "{opaqueUrl}"
}
</pre>
<p>针对delta链接的请求的结果可以跨多个页面，但是必须由服务跨所有页面进行排序，以便在应用到包含delta链接的响应时确保得到确定的结果。</p>
<p>如果没有发生任何更改，则响应是一个空集合，其中包含一个delta链接，用于根据请求进行后续更改。 这个delta链接可能与delta链接相同，从而导致更改的空集合。</p>
<p>如果delta链接不再有效，则服务必须使用_410 Gone_响应。响应应该包含一个Location头，客户端可以使用它来检索新的基线结果集。</p>
<h2><span class="ez-toc-section" id="JSON_%E6%A0%87%E5%87%86%E5%8C%96"></span>JSON 标准化<span class="ez-toc-section-end"></span></h2>
<h3><span class="ez-toc-section" id="%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B%E7%9A%84_JSON_%E6%A0%BC%E5%BC%8F%E6%A0%87%E5%87%86%E5%8C%96"></span>原始类型的 JSON 格式标准化<span class="ez-toc-section-end"></span></h3>
<p>原始值必须按照[RFC8259]的规则序列化为 JSON。</p>
<p><strong>64 位整数的重要说明</strong>：JavaScript 将自动截断大于 Number.MAX_SAFE_INTEGER (2^53-1) 的整数或小于 Number.MIN_SAFE_INTEGER (-2^53+1) 的数字。如果服务预期返回安全值范围之外的整数值，请强烈考虑将该值作为字符串返回，以最大限度地提高互操作性并避免数据丢失。</p>
<h3><span class="ez-toc-section" id="%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E6%8C%87%E5%8D%97"></span>日期和时间指南<span class="ez-toc-section-end"></span></h3>
<p><strong>生产日期</strong></p>
<p>服务必须使用 DateLiteral 格式生成日期，并且应该使用 Iso8601Literal 格式，除非有令人信服的理由不这样做。使用 StructuredDateLiteral 格式的服务不得使用 T 类型生成日期，除非需要额外的精度，并且明确不支持 ECMAScript 客户端。 （非规范性声明：在决定标准化哪个特定 DateKind 时，偏好的大致顺序是 E、C、U、W、O、X、I、T。这针对 ECMAScript、.NET 和 C++ 程序员进行了优化。）</p>
<p><strong>消费日期</strong></p>
<p>服务必须接受来自使用相同 DateLiteral 格式（包括 DateKind，如果适用）的客户端的日期，并且应该接受使用任何 DateLiteral 格式的日期。</p>
<p><strong>兼容性</strong></p>
<p>服务必须对相同类型的所有资源使用相同的 DateLiteral 格式（包括相同的 DateKind，如果适用），并且应该对整个服务中的所有资源使用相同的 DateLiteral 格式（和 DateKind，如果适用）。</p>
<p>服务产生的 DateLiteral 格式（包括 DateKind，如果适用）的任何更改以及服务接受的 DateLiteral 格式（和 DateKind，如果适用）的任何减少都必须被视为破坏性更改。服务接受的 DateLiteral 格式的任何扩展不被视为重大更改。</p>
<h3><span class="ez-toc-section" id="%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%9A%84_JSON_%E5%BA%8F%E5%88%97%E5%8C%96"></span>日期和时间的 JSON 序列化<span class="ez-toc-section-end"></span></h3>
<p>使用 JSON 来回序列化日期是一个难题。尽管 ECMAScript 支持大多数内置类型的文字，但它没有为日期定义文字格式。 Web 已经围绕<a href="https://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15">ISO 8601 日期格式 (ISO 8601) 的 ECMAScript 子集</a>进行了合并，但在某些情况下这种格式并不理想。对于这些情况，本文档定义了一种 JSON 序列化格式，可用于明确表示不同格式的日期。其他序列化格式（例如 XML）可以从这种格式派生出来。</p>
<p><strong>日期文字格式</strong></p>
<p>JSON 中表示的日期使用以下语法进行序列化。 非正式地，DateValue 是 ISO 8601 格式的字符串或包含两个名为 kind 和 value 的属性的 JSON 对象，它们共同定义了一个时间点。 以下不是上下文无关的语法； 特别是，DateValue 的解释取决于 DateKind 的值，但这最大限度地减少了描述格式所需的产品数量。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">DateLiteral:</span></div></div><div class=""><div><span class="enlighter-text">  Iso8601Literal</span></div></div><div class=""><div><span class="enlighter-text">  StructuredDateLiteral</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Iso8601Literal:</span></div></div><div class=""><div><span class="enlighter-text">  A string literal as defined </span><span class="enlighter-k1">in</span><span class="enlighter-text"> https:</span><span class="enlighter-c0">//www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15. Note that the full grammar for ISO 8601 (such as "basic format" without separators) is not supported.</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  All dates default to UTC unless specified otherwise.</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">StructuredDateLiteral:</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">{</span><span class="enlighter-text"> DateKindProperty , DateValueProperty </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">{</span><span class="enlighter-text"> DateValueProperty , DateKindProperty </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">DateKindProperty</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"kind"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> DateKind</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">DateKind:</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"C"</span><span class="enlighter-text">            </span><span class="enlighter-g0">;</span><span class="enlighter-text"> see below</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"E"</span><span class="enlighter-text">            </span><span class="enlighter-g0">;</span><span class="enlighter-text"> see below</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"I"</span><span class="enlighter-text">            </span><span class="enlighter-g0">;</span><span class="enlighter-text"> see below</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"O"</span><span class="enlighter-text">            </span><span class="enlighter-g0">;</span><span class="enlighter-text"> see below</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"T"</span><span class="enlighter-text">            </span><span class="enlighter-g0">;</span><span class="enlighter-text"> see below</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"U"</span><span class="enlighter-text">            </span><span class="enlighter-g0">;</span><span class="enlighter-text"> see below</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"W"</span><span class="enlighter-text">            </span><span class="enlighter-g0">;</span><span class="enlighter-text"> see below</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"X"</span><span class="enlighter-text">            </span><span class="enlighter-g0">;</span><span class="enlighter-text"> see below</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">DateValueProperty:</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> DateValue</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">DateValue:</span></div></div><div class=""><div><span class="enlighter-text">  UnsignedInteger        </span><span class="enlighter-g0">;</span><span class="enlighter-text"> not defined here</span></div></div><div class=""><div><span class="enlighter-text">  SignedInteger        </span><span class="enlighter-g0">;</span><span class="enlighter-text"> not defined here</span></div></div><div class=""><div><span class="enlighter-text">  RealNumber        </span><span class="enlighter-g0">;</span><span class="enlighter-text"> not defined here</span></div></div><div class=""><div><span class="enlighter-text">  Iso8601Literal        </span><span class="enlighter-g0">;</span><span class="enlighter-text"> as above</span></div></div></div><div class="enlighter-raw">DateLiteral:
  Iso8601Literal
  StructuredDateLiteral

Iso8601Literal:
  A string literal as defined in https://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15. Note that the full grammar for ISO 8601 (such as "basic format" without separators) is not supported.
  All dates default to UTC unless specified otherwise.

StructuredDateLiteral:
  { DateKindProperty , DateValueProperty }
  { DateValueProperty , DateKindProperty }

DateKindProperty
  "kind" : DateKind

DateKind:
  "C"            ; see below
  "E"            ; see below
  "I"            ; see below
  "O"            ; see below
  "T"            ; see below
  "U"            ; see below
  "W"            ; see below
  "X"            ; see below

DateValueProperty:
  "value" : DateValue

DateValue:
  UnsignedInteger        ; not defined here
  SignedInteger        ; not defined here
  RealNumber        ; not defined here
  Iso8601Literal        ; as above</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">DateLiteral:
  Iso8601Literal
  StructuredDateLiteral

Iso8601Literal:
  A string literal as defined in https://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15. Note that the full grammar for ISO 8601 (such as "basic format" without separators) is not supported.
  All dates default to UTC unless specified otherwise.

StructuredDateLiteral:
  { DateKindProperty , DateValueProperty }
  { DateValueProperty , DateKindProperty }

DateKindProperty
  "kind" : DateKind

DateKind:
  "C"            ; see below
  "E"            ; see below
  "I"            ; see below
  "O"            ; see below
  "T"            ; see below
  "U"            ; see below
  "W"            ; see below
  "X"            ; see below

DateValueProperty:
  "value" : DateValue

DateValue:
  UnsignedInteger        ; not defined here
  SignedInteger        ; not defined here
  RealNumber        ; not defined here
  Iso8601Literal        ; as above
</pre>
<p><strong>关于日期格式的评论</strong></p>
<p>使用 Iso8601Literal 产生式的 DateLiteral 相对简单。 下面是一个对象的示例，该对象的属性名为 creationDate，该属性设置为 2015 年 2 月 13 日下午 1:15。 世界标准时间：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"creationDate"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"2015-02-13T13:15Z"</span><span class="enlighter-text"> </span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{ "creationDate" : "2015-02-13T13:15Z" }</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{ "creationDate" : "2015-02-13T13:15Z" }</pre>
<p>StructuredDateLiteral 由 DateKind 和随附的 DateValue 组成，其有效值（及其解释）取决于 DateKind。 下表描述了有效组合及其含义：</p>
<table>
<tbody>
<tr>
<td>DateKind</td>
<td>DateValue</td>
<td>Colloquial Name &amp; Interpretation</td>
<td>More Info</td>
</tr>
<tr>
<td>C</td>
<td>UnsignedInteger</td>
<td>“CLR”;自0001年1月1日午夜起的毫秒数；不允许出现负值。见下面的注释。</td>
<td><a href="https://msdn.microsoft.com/en-us/library/System.DateTime(v=vs.110).aspx">MSDN</a></td>
</tr>
<tr>
<td>E</td>
<td>SignedInteger</td>
<td>“ECMAScript”;自1970年1月1日午夜以来的毫秒数。</td>
<td><a href="https://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.1">ECMA International</a></td>
</tr>
<tr>
<td>I</td>
<td>Iso8601Literal</td>
<td>“ISO 8601”;限制为ECMAScript子集的字符串。</td>
<td></td>
</tr>
<tr>
<td>O</td>
<td>RealNumber</td>
<td>“OLE Date”;整数部分是自1899年12月31日午夜起的天数，分数部分是一天中的时间（0.5=正午）。</td>
<td><a href="https://docs.microsoft.com/en-us/windows/desktop/api/oleauto/nf-oleauto-varianttimetosystemtime">MSDN</a></td>
</tr>
<tr>
<td>T</td>
<td>SignedInteger</td>
<td>“Ticks”; 1601年1月1日午夜以来的滴答数（100纳秒间隔）。见下面的注释。</td>
<td><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms724290(v=vs.85).aspx">MSDN</a></td>
</tr>
<tr>
<td>U</td>
<td>SignedInteger</td>
<td>“UNIX”;自1970年1月1日午夜以来的秒数。</td>
<td><a href="https://msdn.microsoft.com/en-us/library/1f4c8f33.aspx">MSDN</a></td>
</tr>
<tr>
<td>W</td>
<td>SignedInteger</td>
<td>“Windows”;1601年1月1日午夜以来的毫秒数。见下面的注释。</td>
<td><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms724290(v=vs.85).aspx">MSDN</a></td>
</tr>
<tr>
<td>X</td>
<td>RealNumber</td>
<td>“Excel”; as for&nbsp;O&nbsp;but the year 1900 is incorrectly treated as a leap year, and day 0 is “January 0 (zero).”</td>
<td><a href="https://support.microsoft.com/kb/214326?wa=wsignin1.0">Microsoft Support</a></td>
</tr>
</tbody>
</table>
<p><strong>C 和 W 类型的重要说明</strong>：本机 CLR 和 Windows 时间由 100 纳秒“刻度”值表示。 为了与精度有限的 ECMAScript 客户端进行互操作，当（反）序列化为 DateLiteral 时，这些值必须在毫秒之间进行转换。 一毫秒相当于 10,000 个滴答声。</p>
<p><strong>T 类型的重要说明</strong>：这种类型保留了 Windows 本机时间格式的完整保真度（并且可以轻松地与本机 CLR 格式进行转换），但与 ECMAScript 客户端不兼容。 因此，它的使用应该仅限于那些既需要额外精度又不需要与 ECMAScript 客户端互操作的场景。</p>
<p>以下是具有名为 creationDate 的属性设置为 2015 年 2 月 13 日下午 1:15 的同一对象示例。 UTC，使用多种格式：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"creationDate"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"kind"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"O"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"value"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">42048.55</span><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"creationDate"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"> </span><span class="enlighter-s0">"kind"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"E"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"value"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">1423862100000</span><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"> </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">]</span></div></div></div><div class="enlighter-raw">[
  { "creationDate" : { "kind" : "O", "value" : 42048.55 } },
  { "creationDate" : { "kind" : "E", "value" : 1423862100000 } }
]</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">[
  { "creationDate" : { "kind" : "O", "value" : 42048.55 } },
  { "creationDate" : { "kind" : "E", "value" : 1423862100000 } }
]
</pre>
<p>将种类与值分开的好处之一是，一旦客户端知道特定服务使用的种类，它就可以解释该值而无需任何额外的解析。 在值是数字的常见情况下，这使开发人员更容易编码：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0">// We know this service always gives out ECMAScript-format dates</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">var date = </span><span class="enlighter-k1">new</span><span class="enlighter-text"> </span><span class="enlighter-m0">Date</span><span class="enlighter-g1">(</span><span class="enlighter-text">serverResponse.</span><span class="enlighter-m3">someObject</span><span class="enlighter-text">.</span><span class="enlighter-m3">creationDate</span><span class="enlighter-text">.</span><span class="enlighter-m3">value</span><span class="enlighter-g1">)</span><span class="enlighter-text">;</span></div></div></div><div class="enlighter-raw">// We know this service always gives out ECMAScript-format dates
var date = new Date(serverResponse.someObject.creationDate.value);</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">// We know this service always gives out ECMAScript-format dates
var date = new Date(serverResponse.someObject.creationDate.value);
</pre>
<h3><span class="ez-toc-section" id="Durations%E6%8C%81%E7%BB%AD%E6%97%B6%E9%97%B4"></span>Durations持续时间<span class="ez-toc-section-end"></span></h3>
<p><a href="https://en.wikipedia.org/wiki/ISO_8601#Durations">Durations</a>需要按照<a href="https://en.wikipedia.org/wiki/ISO_8601#Durations">ISO 8601</a>进行序列化。持续时间“由格式 P[n]Y[n]M[n]DT[n]H[n]M[n]S 表示”。 从标准：</p>
<ul>
<li>P 是放置在持续时间表示开头的持续时间指示符（历史上称为“句点”）。</li>
<li>Y 是跟在年数值之后的年份指示符。</li>
<li>M 是跟在月数值之后的月份指示符。</li>
<li>W 是跟在周数值之后的周指示符。</li>
<li>D 是跟在天数值之后的天指示符。</li>
<li>T 是在表示的时间分量之前的时间指示符。</li>
<li>H 是跟在小时数值之后的小时指示符。</li>
<li>M 是跟在分钟数值之后的分钟指示符。</li>
<li>S 是秒数值之后的第二个指示符。</li>
</ul>
<p>例如，“P3Y6M4DT12H30M5S”表示“3年6个月4天12小时30分5秒”的持续时间。</p>
<h3><span class="ez-toc-section" id="Intervals_%E9%97%B4%E9%9A%94"></span>Intervals 间隔<span class="ez-toc-section-end"></span></h3>
<p><a href="https://en.wikipedia.org/wiki/ISO_8601#Time_intervals">Intervals</a>间隔被定义为<a href="https://en.wikipedia.org/wiki/ISO_8601#Time_intervals">ISO 8601</a> 的一部分。</p>
<ul>
<li>开始和结束，例如“2007-03-01T13:00:00Z/2008-05-11T15:30:00Z”</li>
<li>开始和持续时间，例如“2007-03-01T13:00:00Z/P1Y2M10DT2H30M”</li>
<li>持续时间和结束时间，例如“P1Y2M10DT2H30M/2008-05-11T15:30:00Z”</li>
<li>仅持续时间，例如“P1Y2M10DT2H30M”，以及附加上下文信息</li>
</ul>
<h3><span class="ez-toc-section" id="Repeating_intervals%E9%87%8D%E5%A4%8D%E9%97%B4%E9%9A%94"></span>Repeating intervals重复间隔<span class="ez-toc-section-end"></span></h3>
<p>根据<a href="https://en.wikipedia.org/wiki/ISO_8601#Repeating_intervals">ISO 8601</a>，重复间隔<a href="https://en.wikipedia.org/wiki/ISO_8601#Repeating_intervals">Repeating Intervals</a>是：</p>
<p>通过在区间表达式的开头添加 “R[n]/” 形成，其中 R 用作字母本身，[n] 由重复次数代替。 省略 [n] 的值意味着无限次数的重复。</p>
<p>例如，要从“2008-03-01T13:00:00Z”开始重复“P1Y2M10DT2H30M”的间隔五次，请使用“R5/2008-03-01T13:00:00Z/P1Y2M10DT2H30M”。</p>
<h2><span class="ez-toc-section" id="%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6"></span>版本控制<span class="ez-toc-section-end"></span></h2>
<p><strong>所有符合 Microsoft REST API 指南的 API 都必须支持显式版本控制。</strong>客户可以指望服务随着时间的推移保持稳定至关重要，服务可以添加功能并进行更改也很重要。</p>
<h3><span class="ez-toc-section" id="%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E6%A0%BC%E5%BC%8F"></span>版本控制格式<span class="ez-toc-section-end"></span></h3>
<p>服务使用 Major.Minor 版本控制方案进行版本控制。服务可以选择仅“主要”版本方案，在这种情况下，“.0”是隐含的，并且本节中的所有其他规则都适用。支持用于指定 REST API 请求版本的两个选项：</p>
<ul>
<li>嵌入在请求 URL 的路径中，在服务根目录的末尾：https://api.contoso.com/v1.0/products/users</li>
<li>作为 URL 的查询字符串参数：https://api.contoso.com/products/users?api-version=1.0</li>
</ul>
<p>在这两个选项之间进行选择的指南如下：</p>
<ul>
<li>位于 DNS endpoint后面的服务必须使用相同的版本控制机制。</li>
<li>在这种情况下，跨端点的一致用户体验至关重要。 Microsoft REST API 指南工作组建议在未与组织的领导团队进行明确对话的情况下，不要创建新的顶级 DNS endpoint。</li>
<li>保证其 REST API 的 URL 路径稳定性的服务，即使通过 API 的未来版本，也可以采用查询字符串参数机制。这意味着 API 中描述的关系的命名和结构在 API 发布后无法演变，即使在具有重大更改的版本之间也是如此。</li>
<li>无法确保未来版本中 URL 路径稳定性的服务必须将版本嵌入 URL 路径中。</li>
</ul>
<p>某些基础服务（例如 Microsoft 的 Azure Active Directory）可能会暴露在多个endpoint之后。此类服务必须支持每个endpoint的版本控制机制，即使这意味着支持多种版本控制机制。</p>
<p><strong>组版本控制</strong></p>
<p>组版本控制是一个可选功能，可以使用查询字符串参数机制在服务上提供。 组版本允许在通用版本控制名称下对 API endpoint进行逻辑分组。 这允许开发人员查找单个版本号并跨多个端点使用它。 组版本号是众所周知的，服务应该拒绝任何无法识别的值。</p>
<p>在内部，服务将采用组版本并将其映射到适当的 Major.Minor 版本。</p>
<p>组版本格式定义为 YYYY-MM-DD，例如 2012-12-07 表示 2012 年 12 月 7 日。此日期版本格式仅适用于组版本，不应用作 Major.Minor 版本的替代。</p>
<p>组版本控制示例：</p>
<table>
<tbody>
<tr>
<td>Group</td>
<td>Major.Minor</td>
</tr>
<tr>
<td>2012-12-01</td>
<td>1.0</td>
</tr>
<tr>
<td></td>
<td>1.1</td>
</tr>
<tr>
<td></td>
<td>1.2</td>
</tr>
<tr>
<td>2013-03-21</td>
<td>1.0</td>
</tr>
<tr>
<td></td>
<td>2.0</td>
</tr>
<tr>
<td></td>
<td>3.0</td>
</tr>
<tr>
<td></td>
<td>3.1</td>
</tr>
<tr>
<td></td>
<td>3.2</td>
</tr>
<tr>
<td></td>
<td>3.3</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>Version Format</td>
<td>Example</td>
<td>Interpretation</td>
</tr>
<tr>
<td>{groupVersion}</td>
<td>2013-03-21, 2012-12-01</td>
<td>3.3, 1.2</td>
</tr>
<tr>
<td>{majorVersion}</td>
<td>3</td>
<td>3.0</td>
</tr>
<tr>
<td>{majorVersion}.{minorVersion}</td>
<td>1.2</td>
<td>1.2</td>
</tr>
</tbody>
</table>
<p>客户端可以指定组版本或 Major.Minor 版本：</p>
<p>例如：</p>
<p>GET http://api.contoso.com/acct1/c1/blob2?api-version=1.0</p>
<p>PUT http://api.contoso.com/acct1/c1/b2?api-version=2011-12-07</p>
<h3><span class="ez-toc-section" id="%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E6%9B%B4%E6%96%B0%E7%89%88%E6%9C%AC"></span>什么时候更新版本<span class="ez-toc-section-end"></span></h3>
<p>服务必须增加它们的版本号以响应任何中断的 API 更改。有关什么构成重大更改的详细讨论，请参阅以下部分。 如果需要，服务也可以为不间断的更改增加它们的版本号。</p>
<p>使用新的主要版本号来表示将来会弃用对现有客户端的支持。在引入新的主要版本时，服务必须为现有客户提供清晰的升级路径，并制定与其业务组政策一致的弃用计划。服务应该对所有其他更改使用新的次要版本号。</p>
<p>版本化服务的在线文档必须指出每个先前 API 版本的当前支持状态，并提供最新版本的路径。</p>
<h3><span class="ez-toc-section" id="%E9%87%8D%E5%A4%A7%E5%8F%98%E6%9B%B4%E7%9A%84%E5%AE%9A%E4%B9%89"></span>重大变更的定义<span class="ez-toc-section-end"></span></h3>
<p>对 API 合同的更改被视为重大更改。影响 API 向后兼容性的更改是重大更改。</p>
<p>团队可以根据其业务需求定义向后兼容性。例如，Azure 将在响应中添加新的 JSON 字段定义为不向后兼容。 Office 365 对向后兼容性有更宽松的定义，并允许将 JSON 字段添加到响应中。</p>
<p>重大更改的清晰示例：</p>
<ul>
<li>删除或重命名 API 或 API 参数</li>
<li>现有 API 的行为变化</li>
<li>错误代码和错误合约的变化</li>
<li>任何违反<a href="https://en.wikipedia.org/wiki/Principle_of_least_astonishment">最小惊讶原则</a>的事情</li>
</ul>
<p>服务必须明确定义他们对重大更改的定义，尤其是在向 JSON 响应添加新字段和添加具有默认字段的新 API 参数方面。与其他服务位于 DNS endpoint后面的服务必须在定义合同可扩展性方面保持一致。</p>
<p><a href="https://docs.oasis-open.org/odata/odata/v4.0/errata02/os/complete/part1-protocol/odata-v4.0-errata02-os-part1-protocol-complete.html#_Toc406398209">OData V4 规范的本节</a>中描述的适用更改应被视为所有服务必须考虑的重大更改的最低标准的一部分。</p>
<h2><span class="ez-toc-section" id="%E9%95%BF%E6%97%B6%E9%97%B4%E8%BF%90%E8%A1%8C%E7%9A%84%E6%93%8D%E4%BD%9C"></span>长时间运行的操作<span class="ez-toc-section-end"></span></h2>
<p>长时间运行的操作，有时也称为异步操作，对不同的人来说往往意味着不同的事情。本节针对不同类型的长时间运行操作提出了指导，并描述了这些类型操作的连线协议和最佳实践。</p>
<ul>
<li>一个或多个客户端必须能够同时监控和操作同一资源。</li>
<li>系统状态应该始终是可发现和可测试的。即使操作跟踪资源不再处于活动状态，客户端也应该能够确定系统状态。查询长时间运行的操作状态的行为本身应该利用网络的原则。即具有统一接口语义的明确定义的资源。客户端可以对某些资源发出 GET 请求以确定长时间运行的操作的状态</li>
<li>长期运行的操作应该适用于希望“即发即忘”的客户以及希望积极监控结果并根据结果采取行动的客户。</li>
<li>取消并不明确表示回滚。在每个 API 定义的情况下，它可能意味着回滚、补偿、完成或部分完成等。在取消操作之后，客户不应该负责将服务返回到允许继续服务的一致状态。</li>
</ul>
<h3><span class="ez-toc-section" id="%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E9%95%BF%E6%97%B6%E9%97%B4%E8%BF%90%E8%A1%8C%E6%93%8D%E4%BD%9C_(RELO)"></span>基于资源的长时间运行操作 (RELO)<span class="ez-toc-section-end"></span></h3>
<p>基于资源的建模是将操作的状态编码在资源中，并且使用的有线协议是标准同步协议。在这个模型中，状态转换被很好地定义，目标状态也被类似地定义。</p>
<p>这是长时间运行操作的首选模型，应尽可能使用。避免 LRO Wire Protocol 的复杂性和机制使我们的用户和工具链的事情变得更简单。</p>
<p>一个例子可能是机器重新启动，其中操作本身同步完成，但虚拟机资源上的 GET 操作将具有“状态：重新启动”、“状态：运行”，可以随时查询。</p>
<p>该模型可以集成推送通知。</p>
<p>虽然大多数操作可能是 POST 语义，但除了 POST 语义外，服务可以通过路由支持 PUT 语义以简化其 API。例如，想要创建名为“db1”的数据库的用户可以调用：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">PUT https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/databases/db1</span></div></div></div><div class="enlighter-raw">PUT https://api.contoso.com/v1.0/databases/db1</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">PUT https://api.contoso.com/v1.0/databases/db1</pre>
<p>在这种情况下，数据库段正在处理 PUT 操作。</p>
<p>服务也可以使用下面定义的混合。</p>
<h3><span class="ez-toc-section" id="%E9%80%90%E6%AD%A5%E9%95%BF%E8%BF%90%E8%A1%8C%E6%93%8D%E4%BD%9C"></span>逐步长运行操作<span class="ez-toc-section-end"></span></h3>
<p>逐步操作是一种需要很长且通常不可预测的时间才能完成的操作，并且不提供在资源中建模的状态转换。本节概述了服务应该用于公开此类长时间运行的操作的方法。</p>
<p>服务可以公开逐步操作。</p>
<p>逐步长时间运行的操作有时称为“异步”操作。这会导致混淆，因为它将平台元素（“Async / await”、“promises”、“futures”）与 API 操作元素混合在一起。本文档使用术语“逐步长时间运行操作”或通常只是“逐步操作”以避免混淆“异步”一词。</p>
<p>服务必须对逐步请求执行尽可能多的同步验证。服务必须以同步方式优先返回错误，目标是使用长时间运行的操作线协议处理“有效”操作。</p>
<p>对于定义为逐步长时间运行操作的 API，即使该操作可以立即完成，服务也必须经过逐步长时间运行操作流程。换句话说，API 必须采用并坚持 LRO 模式，而不是根据情况更改模式。</p>
<p><strong>PUT</strong></p>
<p>服务可以为实体创建启用 PUT 请求。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">PUT https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/databases/db1</span></div></div></div><div class="enlighter-raw">PUT https://api.contoso.com/v1.0/databases/db1</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">PUT https://api.contoso.com/v1.0/databases/db1</pre>
<p>在这种情况下，数据库段正在处理 PUT 操作。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">202</span><span class="enlighter-text"> Accepted</span></div></div><div class=""><div><span class="enlighter-text">Operation-Location: https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/operations/123</span></div></div></div><div class="enlighter-raw">HTTP/1.1 202 Accepted
Operation-Location: https://api.contoso.com/v1.0/operations/123</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">HTTP/1.1 202 Accepted
Operation-Location: https://api.contoso.com/v1.0/operations/123</pre>
<p>对于需要在此处返回 201 Created 的服务，请使用下面描述的混合流程。</p>
<p>202 Accepted 不应返回任何正文。 201 Created 案例应该返回目标资源的主体。</p>
<p><strong>POST</strong></p>
<p>服务可以为实体创建启用 POST 请求。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">POST https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/databases/</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"fileName"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"someFile.db"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"color"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"red"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">202</span><span class="enlighter-text"> Accepted</span></div></div><div class=""><div><span class="enlighter-text">Operation-Location: https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/operations/123</span></div></div></div><div class="enlighter-raw">POST https://api.contoso.com/v1.0/databases/

{
  "fileName": "someFile.db",
  "color": "red"
}
HTTP/1.1 202 Accepted
Operation-Location: https://api.contoso.com/v1.0/operations/123</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">POST https://api.contoso.com/v1.0/databases/

{
  "fileName": "someFile.db",
  "color": "red"
}
HTTP/1.1 202 Accepted
Operation-Location: https://api.contoso.com/v1.0/operations/123</pre>
<p><strong>POST，混合模型</strong></p>
<p>服务可以同步响应对创建资源的集合的 POST 请求，即使在生成响应时资源没有完全创建。 为了使用这种模式，响应必须包括不完整资源的表示和它不完整的指示。</p>
<p>例如：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">POST https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/databases/ HTTP/1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Host: api.</span><span class="enlighter-m3">contoso</span><span class="enlighter-text">.</span><span class="enlighter-m3">com</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"fileName"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"someFile.db"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"color"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"red"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">POST https://api.contoso.com/v1.0/databases/ HTTP/1.1
Host: api.contoso.com
Content-Type: application/json
Accept: application/json

{
  "fileName": "someFile.db",
  "color": "red"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">POST https://api.contoso.com/v1.0/databases/ HTTP/1.1
Host: api.contoso.com
Content-Type: application/json
Accept: application/json

{
  "fileName": "someFile.db",
  "color": "red"
}</pre>
<p>服务响应表示数据库已创建，但通过包含 Operation-Location 标头指示请求未完成。 在这种情况下，响应负载中的状态属性也指示操作尚未完全完成。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">201</span><span class="enlighter-text"> Created</span></div></div><div class=""><div><span class="enlighter-text">Location: https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/databases/db1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Operation-Location: https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/operations/123</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"databaseName"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"db1"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"color"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"red"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"Status"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Provisioning"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">[</span><span class="enlighter-text"> … other fields </span><span class="enlighter-k1">for</span><span class="enlighter-text"> </span><span class="enlighter-s0">"database"</span><span class="enlighter-text"> …</span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">HTTP/1.1 201 Created
Location: https://api.contoso.com/v1.0/databases/db1
Operation-Location: https://api.contoso.com/v1.0/operations/123

{
  "databaseName": "db1",
  "color": "red",
  "Status": "Provisioning",
  [ … other fields for "database" …]
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">HTTP/1.1 201 Created
Location: https://api.contoso.com/v1.0/databases/db1
Operation-Location: https://api.contoso.com/v1.0/operations/123

{
  "databaseName": "db1",
  "color": "red",
  "Status": "Provisioning",
  [ … other fields for "database" …]
}</pre>
<p><strong>Operations resource</strong></p>
<p>服务可以在租户级别提供“/operations”资源。</p>
<p>提供“/operations”资源的服务必须提供 GET 语义。 GET 必须枚举操作集，遵循标准的分页、排序和过滤语义。 此操作的默认排序顺序必须是：</p>
<table>
<tbody>
<tr>
<td>初级分类</td>
<td>二级分类</td>
</tr>
<tr>
<td>未启动操作</td>
<td>操作创建时间</td>
</tr>
<tr>
<td>运行操作</td>
<td>操作创建时间</td>
</tr>
<tr>
<td>已完成的操作</td>
<td>操作创建时间</td>
</tr>
</tbody>
</table>
<p>请注意，“完成的操作”是一个目标状态（见下文），实际上可能是几种不同状态中的任何一种，例如“成功”、“取消”、“失败”等。</p>
<p><strong>Operation resource</strong></p>
<p>操作是用户可寻址的资源，用于跟踪逐步长时间运行的操作。操作必须支持 GET 语义。针对操作的 GET 操作必须返回：</p>
<ul>
<li>操作资源、它的状态以及与特定 API 相关的任何扩展状态。</li>
<li>200 OK 作为响应代码。</li>
</ul>
<p>服务可以通过在操作上公开 DELETE 来支持操作取消。如果支持 DELETE 操作必须是幂等的。</p>
<p>注意：从 API 设计的角度来看，取消并不明确意味着回滚。在每个 API 定义的情况下，它可能意味着回滚、补偿、完成或部分完成等。在取消操作之后，客户不应该负责将服务返回到允许继续服务的一致状态。</p>
<p>不支持操作取消的服务必须在 DELETE 事件中返回 405 Method Not Allowed。</p>
<p>操作必须支持以下状态：</p>
<ul>
<li>未开始</li>
<li>跑步</li>
<li>成功。终端状态。</li>
<li>失败。终端状态。</li>
</ul>
<p>服务可以添加额外的状态，例如“取消”或“部分完成”。支持取消的服务必须充分描述它们的取消，以便可以准确地确定系统的状态，并且可以运行任何补偿操作。</p>
<p>支持附加状态的服务应考虑此规范名称列表，并尽可能避免创建新名称：取消、取消、中止、中止、墓碑、删除、已删除。</p>
<p>操作必须包含并在 GET 响应中提供以下信息：</p>
<ul>
<li>操作创建时的时间戳。</li>
<li>进入当前状态的时间戳。</li>
<li>运行状态（未启动/正在运行/已完成）。</li>
</ul>
<p>服务可以在操作中添加额外的、特定于 API 的字段。返回的操作状态 JSON 如下所示：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"createdDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2015-06-19T12-01-03.45Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"lastActionDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2015-06-19T12-01-03.45Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"status"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"notstarted | running | succeeded | failed"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "createdDateTime": "2015-06-19T12-01-03.45Z",
  "lastActionDateTime": "2015-06-19T12-01-03.45Z",
  "status": "notstarted | running | succeeded | failed"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "createdDateTime": "2015-06-19T12-01-03.45Z",
  "lastActionDateTime": "2015-06-19T12-01-03.45Z",
  "status": "notstarted | running | succeeded | failed"
}</pre>
<p><u>Percent complete</u></p>
<p>有时，服务不可能准确地知道操作何时完成。 这使得使用 Retry-After 标头有问题。 在这种情况下，服务可以在 operationStatus JSON 中包含一个完成百分比字段。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"createdDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2015-06-19T12-01-03.45Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"percentComplete"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"50"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"status"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"running"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "createdDateTime": "2015-06-19T12-01-03.45Z",
  "percentComplete": "50",
  "status": "running"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "createdDateTime": "2015-06-19T12-01-03.45Z",
  "percentComplete": "50",
  "status": "running"
}</pre>
<p>在此示例中，服务器已向客户端指示长时间运行的操作已完成 50%。</p>
<p><u>Target resource location</u></p>
<p>对于导致或操纵资源的操作，服务必须在操作完成后的状态中包含目标资源位置。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"createdDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2015-06-19T12-01-03.45Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"lastActionDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2015-06-19T12-06-03.0024Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"status"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"succeeded"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"resourceLocation"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://api.contoso.com/v1.0/databases/db1"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "createdDateTime": "2015-06-19T12-01-03.45Z",
  "lastActionDateTime": "2015-06-19T12-06-03.0024Z",
  "status": "succeeded",
  "resourceLocation": "https://api.contoso.com/v1.0/databases/db1"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "createdDateTime": "2015-06-19T12-01-03.45Z",
  "lastActionDateTime": "2015-06-19T12-06-03.0024Z",
  "status": "succeeded",
  "resourceLocation": "https://api.contoso.com/v1.0/databases/db1"
}</pre>
<p><strong>Operation tombstones</strong></p>
<p>服务可以选择支持逻辑删除操作。服务可以选择在服务定义的时间段后删除tombstones。</p>
<p><strong>The typical flow, polling</strong></p>
<ul>
<li>客户端通过使用 POST 调用操作来调用逐步操作</li>
<li>服务器必须通过响应 202 Accepted 状态码来表明请求已经开始。 响应应该包括包含 URL 的位置标头，客户端在等待 Retry-After 标头中指定的秒数后应轮询结果。</li>
<li>客户端轮询位置，直到收到带有终端操作状态的 200 响应。</li>
</ul>
<p><u>Example of the typical flow, polling</u></p>
<p>客户端调用重启动作：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">POST https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/databases HTTP/1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"fromFile"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"myFile.db"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"color"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"red"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">POST https://api.contoso.com/v1.0/databases HTTP/1.1
Accept: application/json

{
  "fromFile": "myFile.db",
  "color": "red"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">POST https://api.contoso.com/v1.0/databases HTTP/1.1
Accept: application/json

{
  "fromFile": "myFile.db",
  "color": "red"
}</pre>
<p>服务器响应表明请求已创建。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">202</span><span class="enlighter-text"> Accepted</span></div></div><div class=""><div><span class="enlighter-text">Operation-Location: https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/operations/123</span></div></div></div><div class="enlighter-raw">HTTP/1.1 202 Accepted
Operation-Location: https://api.contoso.com/v1.0/operations/123</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">HTTP/1.1 202 Accepted
Operation-Location: https://api.contoso.com/v1.0/operations/123</pre>
<p>客户端等待一段时间然后调用另一个请求来尝试获取操作状态。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/operations/123</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/operations/123
Accept: application/json</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/operations/123
Accept: application/json</pre>
<p>服务器响应结果仍未准备好并可选择提供等待 30 秒的建议。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">200</span><span class="enlighter-text"> OK</span></div></div><div class=""><div><span class="enlighter-text">Retry-After: </span><span class="enlighter-n1">30</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"createdDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2015-06-19T12-01-03.4Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"status"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"running"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">HTTP/1.1 200 OK
Retry-After: 30

{
  "createdDateTime": "2015-06-19T12-01-03.4Z",
  "status": "running"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">HTTP/1.1 200 OK
Retry-After: 30

{
  "createdDateTime": "2015-06-19T12-01-03.4Z",
  "status": "running"
}</pre>
<p>客户端等待建议的 30 秒，然后调用另一个请求以获取操作结果。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/operations/123</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/operations/123
Accept: application/json</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/operations/123
Accept: application/json</pre>
<p>服务器以包含资源位置的“status:succeeded”操作响应。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">200</span><span class="enlighter-text"> OK</span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"createdDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2015-06-19T12-01-03.45Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"lastActionDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2015-06-19T12-06-03.0024Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"status"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"succeeded"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"resourceLocation"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://api.contoso.com/v1.0/databases/db1"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">HTTP/1.1 200 OK
Content-Type: application/json

{
  "createdDateTime": "2015-06-19T12-01-03.45Z",
  "lastActionDateTime": "2015-06-19T12-06-03.0024Z",
  "status": "succeeded",
  "resourceLocation": "https://api.contoso.com/v1.0/databases/db1"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">HTTP/1.1 200 OK
Content-Type: application/json

{
  "createdDateTime": "2015-06-19T12-01-03.45Z",
  "lastActionDateTime": "2015-06-19T12-06-03.0024Z",
  "status": "succeeded",
  "resourceLocation": "https://api.contoso.com/v1.0/databases/db1"
}</pre>
<p><strong>The typical flow, push notifications</strong></p>
<ul>
<li>客户端通过使用 POST 调用操作来调用长时间运行的操作。 客户端已经在父资源上设置了推送通知。</li>
<li>服务通过响应 202 Accepted 状态代码来指示请求已启动。 客户忽略其他一切。</li>
<li>整体操作完成后，服务通过对父资源的订阅推送通知。</li>
<li>客户端通过资源URL获取操作结果</li>
</ul>
<p><u>Example of the typical flow, push notifications existing subscription</u></p>
<p>客户端调用备份操作。 客户端已经为 db1 设置了推送通知订阅。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">POST https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/databases/db1?backup HTTP/1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div></div><div class="enlighter-raw">POST https://api.contoso.com/v1.0/databases/db1?backup HTTP/1.1
Accept: application/json</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">POST https://api.contoso.com/v1.0/databases/db1?backup HTTP/1.1
Accept: application/json</pre>
<p>服务器响应表明请求已被接受。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">202</span><span class="enlighter-text"> Accepted</span></div></div><div class=""><div><span class="enlighter-text">Operation-Location: https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/operations/123</span></div></div></div><div class="enlighter-raw">HTTP/1.1 202 Accepted
Operation-Location: https://api.contoso.com/v1.0/operations/123</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">HTTP/1.1 202 Accepted
Operation-Location: https://api.contoso.com/v1.0/operations/123</pre>
<p>调用者忽略返回中的所有标头。</p>
<p>操作完成后，目标 URL 会收到推送通知。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">200</span><span class="enlighter-text"> OK</span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"subscriptionId"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"1234-5678-1111-2222"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"context"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"subscription context that was specified at setup"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"resourceUrl"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://api.contoso.com/v1.0/databases/db1"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"userId"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"contoso.com/user@contoso.com"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"tenantId"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"contoso.com"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">HTTP/1.1 200 OK
Content-Type: application/json

{
  "value": [
    {
      "subscriptionId": "1234-5678-1111-2222",
      "context": "subscription context that was specified at setup",
      "resourceUrl": "https://api.contoso.com/v1.0/databases/db1",
      "userId" : "contoso.com/user@contoso.com",
      "tenantId" : "contoso.com"
    }
  ]
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">HTTP/1.1 200 OK
Content-Type: application/json

{
  "value": [
    {
      "subscriptionId": "1234-5678-1111-2222",
      "context": "subscription context that was specified at setup",
      "resourceUrl": "https://api.contoso.com/v1.0/databases/db1",
      "userId" : "contoso.com/user@contoso.com",
      "tenantId" : "contoso.com"
    }
  ]
}</pre>
<p><strong>Retry-After</strong></p>
<p>在上面的示例中，Retry-After 标头指示客户端在尝试从位置标头标识的 URL 获取结果之前应等待的秒数。</p>
<p>HTTP 规范允许 Retry-After 标头交替指定 HTTP 日期，因此客户端也应准备好处理此问题</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">202</span><span class="enlighter-text"> Accepted</span></div></div><div class=""><div><span class="enlighter-text">Operation-Location: http:</span><span class="enlighter-c0">//api.contoso.com/v1.0/operations/123</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Retry-After: </span><span class="enlighter-n1">60</span></div></div></div><div class="enlighter-raw">HTTP/1.1 202 Accepted
Operation-Location: http://api.contoso.com/v1.0/operations/123
Retry-After: 60</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">HTTP/1.1 202 Accepted
Operation-Location: http://api.contoso.com/v1.0/operations/123
Retry-After: 60</pre>
<p>注意：HTTP 日期的使用与本文档中使用的 ISO 8601 日期格式的使用不一致，但由 [RFC 7231][rfc-7231-7-1-1-1] 中的 HTTP 标准明确定义。 服务应该比 HTTP 日期格式更喜欢整数秒数（十进制）格式。</p>
<h3><span class="ez-toc-section" id="%E6%93%8D%E4%BD%9C%E7%BB%93%E6%9E%9C%E4%BF%9D%E7%95%99%E6%94%BF%E7%AD%96"></span>操作结果保留政策<span class="ez-toc-section-end"></span></h3>
<p>在某些情况下，长时间运行的操作的结果不是可以寻址的资源。 例如，如果您调用返回布尔值（而不是资源）的长时间运行的 Action。 在这些情况下，Location 标头指向可以检索布尔结果的位置。</p>
<p>这就引出了一个问题：“操作结果应该保留多久？”</p>
<p>建议的最短保留时间为 24 小时。</p>
<p>操作应该在从系统中清除之前过渡到“tombstone”一段时间。</p>
<h2><span class="ez-toc-section" id="%E8%8A%82%E6%B5%81%E3%80%81%E9%85%8D%E9%A2%9D%E5%92%8C%E9%99%90%E5%88%B6"></span>节流、配额和限制<span class="ez-toc-section-end"></span></h2>
<h3><span class="ez-toc-section" id="%E5%8E%9F%E5%88%99"></span>原则<span class="ez-toc-section-end"></span></h3>
<p>服务应尽可能响应，以免阻塞调用者。根据经验，任何预计在第 99 个百分位数中花费超过 0.5 秒的 API 调用都应考虑对这些调用使用长时间运行的操作模式。显然，面对来自调用者的潜在无限负载，服务无法保证这些响应时间。因此，服务应设计和记录客户端的调用请求限制，并在超出这些限制时以适当的、可操作的错误和错误消息进行响应。当服务通常过载时，服务应该快速响应错误，而不是简单地缓慢响应。最后，许多服务都会有呼叫配额，可能是每小时或每天的操作次数，通常与服务计划或价格有关。当超过这些配额时，服务还必须立即提供可操作的错误。配额和限制应适用于客户单位：订阅、租户、应用程序、计划，或者没有任何其他标识的 IP 地址范围……适合服务目标，以便正确共享负载和一个单位不干扰他人。</p>
<h3><span class="ez-toc-section" id="%E8%BF%94%E5%9B%9E%E4%BB%A3%E7%A0%81%EF%BC%88429_%E4%B8%8E_503%EF%BC%89"></span>返回代码（429 与 503）<span class="ez-toc-section-end"></span></h3>
<p>HTTP 为这些场景指定了两个返回码：“429 Too Many Requests”和“503 Service Unavailable”。对于客户端调用过多的情况，服务应该使用 429，并且可以通过更改其调用模式来解决这种情况。如果一般负载或个别调用者无法控制的其他问题导致服务变慢，则服务应响应 503。在所有情况下，服务还应提供建议呼叫者在再次尝试之前应等待多长时间的信息。客户端应尊重这些标头，并实施其他瞬态故障处理技术。但是，可能有些客户端会在失败时立即重试，这可能会增加服务的负载。为了解决这个问题，服务应该设计为尽可能便宜地返回 429 或 503，或者通过放入特殊的快速路径代码，或者理想情况下通过依赖提供此功能的通用前门或负载平衡器。</p>
<h3><span class="ez-toc-section" id="RetryAfter_%E5%92%8C_RateLimit_%E6%A0%87%E5%A4%B4"></span>Retry-After 和 RateLimit 标头<span class="ez-toc-section-end"></span></h3>
<p>Retry-After 标头是响应受限制的客户端的标准方式。 在限制和配额（但不是整体系统负载）的情况下，使用描述超出限制的标头响应也是常见的，但可选的。 但是，Microsoft 和整个行业的服务为此使用了各种不同的标头。 我们建议使用三个标头来描述限制、低于限制的剩余调用次数以及限制重置的时间。 但是，其他标题可能适用于特定类型的限制。 在所有情况下，这些都必须记录在案。</p>
<h3><span class="ez-toc-section" id="%E6%9C%8D%E5%8A%A1%E6%8C%87%E5%8D%97-2"></span>服务指南<span class="ez-toc-section-end"></span></h3>
<p>服务应选择适合 SLA 或业务目标的时间窗口。 在 Quotas 的情况下，Retry-After 时间和时间窗口可能很长（小时、天、周、甚至几个月。服务使用 429 表示特定调用者拨打了太多电话，而 503 表示服务正在 减载，但这不是调用者的责任。</p>
<p><strong>响应能力</strong></p>
<ul>
<li>服务必须在所有情况下都快速响应，即使在负载下也是如此。</li>
<li>在第 99 个百分位数内响应时间超过 1s 的调用应该使用 Long-Running Operation 模式</li>
<li>在第 99 个百分位数内响应时间超过5 秒的呼叫应强烈考虑 LRO 模式</li>
<li>服务不应该引入阻塞调用者或不可操作的睡眠、暂停等（“tar-pitting”）。</li>
</ul>
<p><strong>速率限制和配额</strong></p>
<p>当请求者发起太多请求时</p>
<ul>
<li>服务必须返回 429 代码</li>
<li>服务必须返回描述细节的标准错误响应，以便程序员可以进行适当的更改</li>
<li>服务必须返回一个 Retry-After 标头，指示客户端在重试之前应该等待多长时间</li>
<li>服务可以返回 RateLimit 标头，记录已超出的限制或配额</li>
<li>服务可以返回 RateLimit-Limit：客户端在一个时间窗口内允许进行的调用次数</li>
<li>服务可以返回RateLimit-Remaining：时间窗口内剩余的调用次数</li>
<li>服务可以返回 RateLimit-Reset：窗口重置的时间，以 UTC 纪元秒为单位</li>
<li>服务可以返回其他服务特定的 RateLimit 标头以获取更详细的信息或特定的限制或配额</li>
</ul>
<p><strong>服务超载</strong></p>
<p>当服务普遍过载和减载时</p>
<ul>
<li>服务必须返回 503 代码</li>
<li>服务必须返回描述细节的标准错误响应（见10.2），以便程序员可以进行适当的更改</li>
<li>服务必须返回一个 Retry-After 标头，指示客户端在重试之前应该等待多长时间</li>
<li>在 503 的情况下，服务不应该返回 RateLimit 标头</li>
</ul>
<p><strong>响应示例</strong></p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">429</span><span class="enlighter-text"> Too Many Requests</span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text">Retry-After: </span><span class="enlighter-n1">5</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">RateLimit-Limit: </span><span class="enlighter-n1">1000</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">RateLimit-Remaining: </span><span class="enlighter-n1">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">RateLimit-Reset: </span><span class="enlighter-n1">1538152773</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"error"</span><span class="enlighter-text">: </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"requestLimitExceeded"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"message"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"The caller has made too many requests in the time period."</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"details"</span><span class="enlighter-text">: </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"RateLimit"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">       </span><span class="enlighter-s0">"limit"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"1000"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">       </span><span class="enlighter-s0">"remaining"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"0"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">       </span><span class="enlighter-s0">"reset"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"1538152773"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">HTTP/1.1 429 Too Many Requests
Content-Type: application/json
Retry-After: 5
RateLimit-Limit: 1000
RateLimit-Remaining: 0
RateLimit-Reset: 1538152773
{
  "error": {
    "code": "requestLimitExceeded",
    "message": "The caller has made too many requests in the time period.",
    "details": {
      "code": "RateLimit",
       "limit": "1000",
       "remaining": "0",
       "reset": "1538152773",
      }
    }
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">HTTP/1.1 429 Too Many Requests
Content-Type: application/json
Retry-After: 5
RateLimit-Limit: 1000
RateLimit-Remaining: 0
RateLimit-Reset: 1538152773
{
  "error": {
    "code": "requestLimitExceeded",
    "message": "The caller has made too many requests in the time period.",
    "details": {
      "code": "RateLimit",
       "limit": "1000",
       "remaining": "0",
       "reset": "1538152773",
      }
    }
}</pre>
<h3><span class="ez-toc-section" id="%E8%AF%B7%E6%B1%82%E6%8C%87%E5%8D%97"></span>请求指南<span class="ez-toc-section-end"></span></h3>
<p>调用者包括 API 的所有用户：工具、门户、其他服务，而不仅仅是用户客户端</p>
<ul>
<li>在重试请求之前，调用者必须等待带有 Retry-After 的响应中指示的最短时间。</li>
<li>调用者可以假设在收到带有 Retry-After 标头的响应后请求是可重试的，而不对请求进行任何更改。</li>
<li>客户端应该使用共享的 SDK 和常见的瞬时故障库来实现正确的行为</li>
</ul>
<p>请参阅：<a href="https://docs.microsoft.com/en-us/azure/architecture/best-practices/transient-faults">Transient fault handling</a></p>
<h3><span class="ez-toc-section" id="%E5%A4%84%E7%90%86%E5%BF%BD%E7%95%A5_RetryAfter_%E6%A0%87%E5%A4%B4%E7%9A%84%E8%B0%83%E7%94%A8%E8%80%85"></span>处理忽略 Retry-After 标头的调用者<span class="ez-toc-section-end"></span></h3>
<p>理想情况下，429 和 503 返回的成本非常低，甚至可以处理立即重试的客户端。 在这些情况下，如果可能，服务团队应努力联系或修复客户。 如果它是已知的合作伙伴，则应提交错误或事件。在极端情况下，可能需要使用 DoS 风格的保护措施，例如阻止请求者。</p>
<h2><span class="ez-toc-section" id="%E9%80%9A%E8%BF%87Webhook%E6%8E%A8%E9%80%81%E9%80%9A%E7%9F%A5"></span>通过Webhook推送通知<span class="ez-toc-section-end"></span></h2>
<h3><span class="ez-toc-section" id="%E8%8C%83%E5%9B%B4"></span>范围<span class="ez-toc-section-end"></span></h3>
<p>服务可以通过Web Hook实现推送通知。本节讨论以下关键场景：</p>
<p><em>通过 HTTP 回调（通常称为 Web Hook）将通知推送到可公开寻址的服务器。</em></p>
<p>之所以选择所提出的方法，是因为它简单、适用性广、服务订阅者进入门槛低。 它旨在作为最低要求集和附加功能的起点。</p>
<h3><span class="ez-toc-section" id="%E5%8E%9F%E5%88%99-2"></span>原则<span class="ez-toc-section-end"></span></h3>
<p>支持 web hook 的服务的核心原则是：</p>
<ul>
<li>服务必须至少实现一个 poke/pull 模型。 在 poke/pull 模型中，向客户端发送通知，然后客户端发送请求以获取当前状态或自上次通知以来的更改记录。 这种方法避免了消息排序、遗漏消息和变更集的复杂性。 服务可以添加更多数据以提供丰富的通知。</li>
<li>服务必须实现挑战/响应协议来配置回调 URL。</li>
<li>服务应该有一个推荐的老化期，服务可以根据场景灵活变化。</li>
<li>服务应该允许发出成功通知的订阅永远存在，并且应该容忍合理的中断期。</li>
<li>Firehose 订阅必须仅通过 HTTPS 交付。 服务应该要求其他订阅类型为 HTTPS。 有关更多详细信息，请参阅“安全”部分。</li>
</ul>
<h3><span class="ez-toc-section" id="%E8%AE%A2%E9%98%85%E7%B1%BB%E5%9E%8B"></span>订阅类型<span class="ez-toc-section-end"></span></h3>
<p>有两种订阅类型，服务可以实现，两者之一，或不实现。支持的订阅类型有：</p>
<ul>
<li>Firehose 订阅 – 为订阅应用程序手动创建订阅，通常在应用程序注册门户中。任何用户同意应用程序接收的活动通知都会发送到这个单一订阅。</li>
<li>按资源订阅——订阅应用程序使用代码在运行时以编程方式为某些特定于用户的实体创建订阅。</li>
</ul>
<p>支持两种订阅类型的服务应该为这两种类型提供差异化​​的开发者体验：</p>
<ul>
<li>Firehose – 除了直接验证和响应通知之外，服务不得要求开发人员创建代码。服务必须为订阅管理提供管理 UI。服务不应该假设最终用户知道订阅，只知道订阅应用程序的功能。</li>
<li>每用户 – 服务必须为开发人员提供 API 以创建和管理订阅作为其应用程序的一部分以及验证和响应通知。服务可能希望最终用户知道订阅，并且必须允许最终用户在响应用户操作时直接撤销订阅。</li>
</ul>
<h3><span class="ez-toc-section" id="%E8%B0%83%E7%94%A8%E5%BA%8F%E5%88%97"></span>调用序列<span class="ez-toc-section-end"></span></h3>
<p>Firehose 订阅的调用顺序必须遵循下图。它显示了应用程序和订阅的手动注册，然后是最终用户使用服务的 API 之一。在流程的这一部分，必须存储两件事：</p>
<ul>
<li>服务必须存储最终用户同意从这个特定应用程序接收通知的行为（通常是后台使用 OAUTH 范围。）</li>
<li>订阅应用程序必须存储最终用户的令牌，以便在收到更改通知后回调详细信息。</li>
</ul>
<p>序列的最后一部分是通知流本身。</p>
<p>非规范实施指南：服务中的一个资源发生变化，服务需要运行如下逻辑：</p>
<ol>
<li>确定有权访问资源的用户集，因此可以期望应用程序代表他们接收有关它的通知。</li>
<li>查看哪些用户已同意接收通知以及来自哪些应用程序。</li>
<li>查看哪些应用程序注册了 Firehose 订阅。</li>
<li>加入 1、2、3 以生成必须发送给应用程序的具体通知集。</li>
</ol>
<p>应该注意的是，用户同意的行为和设置 Firehose 订阅的行为可以按任一顺序到达。服务应该以任一顺序处理设置发送通知。</p>
<p><img loading="lazy" class="alignnone size-full wp-image-4007" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/seq.png" alt="" width="1200" height="1197" srcset="https://www.biaodianfu.com/wp-content/uploads/2021/11/seq.png 1200w, https://www.biaodianfu.com/wp-content/uploads/2021/11/seq-150x150.png 150w, https://www.biaodianfu.com/wp-content/uploads/2021/11/seq-768x766.png 768w" sizes="(max-width: 1200px) 100vw, 1200px"></p>
<p>对于每用户订阅，应用程序注册要么是手动的，要么是自动的。每个用户订阅的调用流程必须遵循下图。它显示最终用户使用服务的 API 之一，同样，必须存储相同的两件事：</p>
<ul>
<li>服务必须存储最终用户同意从这个特定应用程序接收通知的行为（通常是后台使用 OAUTH 范围）。</li>
<li>订阅应用程序必须存储最终用户的令牌，以便在收到更改通知后回调详细信息。</li>
</ul>
<p>在这种情况下，订阅是使用订阅应用程序中的最终用户令牌以编程方式设置的。应用程序必须将注册订阅的 ID 与用户令牌一起存储。</p>
<p>非规范实施指南：在序列的最后部分，当服务中的一项数据发生变化并且服务需要运行以下逻辑时：</p>
<ul>
<li>查找通过资源与更改的数据对应的订阅集。</li>
<li>对于在 app+user 令牌下创建的订阅，使用订阅创建者的订阅 ID 和用户 ID 向每个订阅发送通知。</li>
</ul>
<p>对于使用仅限应用程序令牌创建的订阅，检查更改数据的所有者或任何可以查看更改数据的用户是否已同意向应用程序发送通知，如果同意，则向应用程序发送一组每个用户 ID 的通知每个带有订阅 ID 的订阅。</p>
<h3><span class="ez-toc-section" id="%E9%AA%8C%E8%AF%81%E8%AE%A2%E9%98%85"></span>验证订阅<span class="ez-toc-section-end"></span></h3>
<p>当订阅以编程方式更改或通过管理 UI 门户响应更改时，需要保护订阅服务免受来自可能推送大量通知流量的服务的恶意或意外调用。</p>
<p>对于所有订阅，无论是 firehose 还是每个用户，在发送任何其他通知之前，服务必须通过门户 UI 或 API 请求发送验证请求作为创建或修改的一部分。</p>
<p>验证请求必须采用以下格式作为对订阅的 notificationUrl 的 HTTP/HTTPS POST。</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">POST https:</span><span class="enlighter-c0">//{notificationUrl}?validationToken={randomString}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">ClientState: </span><span class="enlighter-m0">clientOriginatedOpaqueToken</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k1">if</span><span class="enlighter-text"> provided by client on subscription-creation</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Content-Length: </span><span class="enlighter-n1">0</span></div></div></div><div class="enlighter-raw">POST https://{notificationUrl}?validationToken={randomString}
ClientState: clientOriginatedOpaqueToken (if provided by client on subscription-creation)
Content-Length: 0</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">POST https://{notificationUrl}?validationToken={randomString}
ClientState: clientOriginatedOpaqueToken (if provided by client on subscription-creation)
Content-Length: 0
</pre>
<p>对于要建立的订阅，应用程序必须以 200 OK 响应此请求，并使用validationToken 值作为唯一的实体主体。 请注意，如果notificationUrl 包含查询参数，则validationToken 参数必须附加一个&amp;。</p>
<p>如果任何质询请求在发送请求后 5 秒内未收到规定的响应，则服务必须返回错误，不得创建订阅，并且不得向 notificationUrl 发送进一步的请求或通知。</p>
<p>服务可以对 URL 所有权执行额外的验证。</p>
<h3><span class="ez-toc-section" id="%E6%8E%A5%E6%94%B6%E9%80%9A%E7%9F%A5"></span>接收通知<span class="ez-toc-section-end"></span></h3>
<p>服务应该发送通知以响应服务数据更改，这些更改不包括更改本身的详细信息，但包含足够的信息供订阅应用程序适当地响应以下过程：</p>
<ul>
<li>应用程序必须识别正确的缓存 OAuth 令牌以用于回调</li>
<li>应用程序可以查找任何先前的 delta 代币以获取相关的更改范围</li>
<li>应用程序必须确定要调用的 URL，以便为服务的新状态执行相关查询，这可以是增量查询。</li>
</ul>
<p>提供将被转发给最终用户的通知的服务可以选择向通知数据包添加更多详细信息，以减少其服务上的传入呼叫负载。此类服务必须明确通知不能保证交付，并且可能会丢失或出现故障。</p>
<p>通知可以汇总并分批发送。应用程序必须准备好在单个推送通知中接收多个事件。</p>
<p>服务必须将所有 Web Hook 数据通知作为 POST 请求发送。</p>
<p>服务必须允许 30 秒的通知超时。如果发生超时或应用程序以 5xx 响应响应，则服务应该使用指数退避重试通知。所有其他响应将被忽略。</p>
<p>该服务不得遵循 301/302 重定向请求。</p>
<p><strong>Notification payload</strong></p>
<p>通知有效payload的基本格式是一个事件列表，每个事件包含引用资源发生更改的订阅的 ID、更改类型、应该消耗的资源以识别更改的确切细节以及足够的身份信息来查看调用该资源所需的令牌。</p>
<p>对于 Firehose 订阅，一个具体的例子可能如下所示：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"subscriptionId"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"32b8cbd6174ab18b"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"resource"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://api.contoso.com/v1.0/users/user@contoso.com/files?$delta"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"userId"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;User GUID&gt;"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"tenantId"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;Tenant Id&gt;"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "value": [
    {
      "subscriptionId": "32b8cbd6174ab18b",
      "resource": "https://api.contoso.com/v1.0/users/user@contoso.com/files?$delta",
      "userId" : "&lt;User GUID&gt;",
      "tenantId" : "&lt;Tenant Id&gt;"
    }
  ]
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "value": [
    {
      "subscriptionId": "32b8cbd6174ab18b",
      "resource": "https://api.contoso.com/v1.0/users/user@contoso.com/files?$delta",
      "userId" : "&lt;User GUID&gt;",
      "tenantId" : "&lt;Tenant Id&gt;"
    }
  ]
}
</pre>
<p>对于每用户订阅，一个具体的例子可能如下所示：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"subscriptionId"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"32b8cbd6174ab183"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"clientState"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"clientOriginatedOpaqueToken"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"expirationDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2016-02-04T11:23Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"resource"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://api.contoso.com/v1.0/users/user@contoso.com/files/$delta"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"userId"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;User GUID&gt;"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"tenantId"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;Tenant Id&gt;"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"subscriptionId"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"97b391179fa22"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"clientState "</span><span class="enlighter-text">: </span><span class="enlighter-s0">"clientOriginatedOpaqueToken"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"expirationDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2016-02-04T11:23Z"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"resource"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://api.contoso.com/v1.0/users/user@contoso.com/files/$delta"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"userId"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;User GUID&gt;"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"tenantId"</span><span class="enlighter-text"> </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-s0">"&lt;Tenant Id&gt;"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "value": [
    {
      "subscriptionId": "32b8cbd6174ab183",
      "clientState": "clientOriginatedOpaqueToken",
      "expirationDateTime": "2016-02-04T11:23Z",
      "resource": "https://api.contoso.com/v1.0/users/user@contoso.com/files/$delta",
      "userId" : "&lt;User GUID&gt;",
      "tenantId" : "&lt;Tenant Id&gt;"
    },
    {
      "subscriptionId": "97b391179fa22",
      "clientState ": "clientOriginatedOpaqueToken",
      "expirationDateTime": "2016-02-04T11:23Z",
      "resource": "https://api.contoso.com/v1.0/users/user@contoso.com/files/$delta",
      "userId" : "&lt;User GUID&gt;",
      "tenantId" : "&lt;Tenant Id&gt;"
    }
  ]
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "value": [
    {
      "subscriptionId": "32b8cbd6174ab183",
      "clientState": "clientOriginatedOpaqueToken",
      "expirationDateTime": "2016-02-04T11:23Z",
      "resource": "https://api.contoso.com/v1.0/users/user@contoso.com/files/$delta",
      "userId" : "&lt;User GUID&gt;",
      "tenantId" : "&lt;Tenant Id&gt;"
    },
    {
      "subscriptionId": "97b391179fa22",
      "clientState ": "clientOriginatedOpaqueToken",
      "expirationDateTime": "2016-02-04T11:23Z",
      "resource": "https://api.contoso.com/v1.0/users/user@contoso.com/files/$delta",
      "userId" : "&lt;User GUID&gt;",
      "tenantId" : "&lt;Tenant Id&gt;"
    }
  ]
}
</pre>
<p>以下是 JSON 有效payload的详细说明。</p>
<p>通知项包含一个顶级对象，该对象包含一系列事件，每个事件都标识了发送此通知的订阅。</p>
<table>
<tbody>
<tr>
<td>Field</td>
<td>Description</td>
</tr>
<tr>
<td>value</td>
<td>自上次通知以来在订阅范围内引发的事件数组。</td>
</tr>
</tbody>
</table>
<p>events 数组的每一项都包含以下属性：</p>
<table>
<tbody>
<tr>
<td>Field</td>
<td>Description</td>
</tr>
<tr>
<td>subscriptionId</td>
<td>已发送此通知的订阅 ID。<p></p>
<p>服务必须提供 subscriptionId 字段。</p></td>
</tr>
<tr>
<td>clientState</td>
<td>如果在订阅创建时提供，服务必须提供 clientState 字段。</td>
</tr>
<tr>
<td>expirationDateTime</td>
<td>如果订阅有一个，服务必须提供 expireDateTime 字段。</td>
</tr>
<tr>
<td>resource</td>
<td>服务必须提供资源字段。 这个 URL 必须被订阅应用程序认为是不透明的。 在更丰富的通知的情况下，它可以被隐含地包含资源 URL 的消息内容包含以避免重复。<p></p>
<p>如果服务将这些数据作为更详细数据包的一部分提供，则不需要复制它。</p></td>
</tr>
<tr>
<td>userId</td>
<td>服务必须为用户范围的资源提供这个字段。 对于用户范围的资源，应使用用户的唯一标识符。<p></p>
<p>在一组特定用户之间共享资源的情况下，必须发送多个通知，传递每个用户的唯一标识符。</p>
<p>对于租户范围的资源，应使用订阅的用户 ID。</p></td>
</tr>
<tr>
<td>tenantId</td>
<td>希望支持跨租户请求的服务应该提供这个字段。 提供租户范围数据通知的服务必须发送此字段。</td>
</tr>
</tbody>
</table>
<h3><span class="ez-toc-section" id="%E4%BB%A5%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F%E7%AE%A1%E7%90%86%E8%AE%A2%E9%98%85"></span>以编程方式管理订阅<span class="ez-toc-section-end"></span></h3>
<p>对于每用户订阅，必须提供 API 来创建和管理订阅。 API 必须至少支持此处描述的操作。</p>
<p><strong>创建订阅</strong></p>
<p>客户端通过对订阅资源发出 POST 请求来创建订阅。订阅命名空间是客户端通过 POST 操作定义的。</p>
<p><a href="https://api.contoso.com/apiVersion/$subscriptions">https://api.contoso.com/apiVersion/$subscriptions</a></p>
<p>POST 请求包含要创建的单个订阅对象。 该订阅对象具有以下属性：</p>
<table>
<tbody>
<tr>
<td>Property Name</td>
<td>Required</td>
<td>Notes</td>
</tr>
<tr>
<td>resource</td>
<td>Yes</td>
<td>要观看的资源路径。</td>
</tr>
<tr>
<td>notificationUrl</td>
<td>Yes</td>
<td>The target web hook URL.</td>
</tr>
<tr>
<td>clientState</td>
<td>No</td>
<td>在所有通知中传递回客户端的不透明字符串。 调用者可以选择使用它来提供标记机制。</td>
</tr>
</tbody>
</table>
<p>如果订阅成功创建，服务必须响应状态代码 201 CREATED 和至少包含以下属性的主体：</p>
<table>
<tbody>
<tr>
<td>Property Name</td>
<td>Required</td>
<td>Notes</td>
</tr>
<tr>
<td>id</td>
<td>Yes</td>
<td>新订阅的唯一 ID，稍后可用于更新/删除订阅。</td>
</tr>
<tr>
<td>expirationDateTime</td>
<td>No</td>
<td>使用现有的 Microsoft REST API 指南定义的时间格式。</td>
</tr>
</tbody>
</table>
<p>订阅的创建应该是幂等的。 范围限定为身份验证令牌的属性组合提供了唯一性约束。</p>
<p>以下是使用用户 + 应用程序主体订阅来自文件的通知的示例请求：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">POST https:</span><span class="enlighter-c0">//api.contoso.com/files/v1.0/$subscriptions HTTP 1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Authorization: Bearer </span><span class="enlighter-g1">{</span><span class="enlighter-text">UserPrincipalBearerToken</span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"resource"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"http://api.service.com/v1.0/files/file1.txt"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"notificationUrl"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://contoso.com/myCallbacks"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"clientState"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"clientOriginatedOpaqueToken"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">POST https://api.contoso.com/files/v1.0/$subscriptions HTTP 1.1
Authorization: Bearer {UserPrincipalBearerToken}

{
  "resource": "http://api.service.com/v1.0/files/file1.txt",
  "notificationUrl": "https://contoso.com/myCallbacks",
  "clientState": "clientOriginatedOpaqueToken"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">POST https://api.contoso.com/files/v1.0/$subscriptions HTTP 1.1
Authorization: Bearer {UserPrincipalBearerToken}

{
  "resource": "http://api.service.com/v1.0/files/file1.txt",
  "notificationUrl": "https://contoso.com/myCallbacks",
  "clientState": "clientOriginatedOpaqueToken"
}
</pre>
<p>服务应该以最小的响应格式响应这样的消息：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"32b8cbd6174ab18b"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"expirationDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2016-02-04T11:23Z"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "id": "32b8cbd6174ab18b",
  "expirationDateTime": "2016-02-04T11:23Z"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "id": "32b8cbd6174ab18b",
  "expirationDateTime": "2016-02-04T11:23Z"
}
</pre>
<p>下面是一个使用 Application-Only 主体的示例，其中应用程序正在监视它授权的所有文件：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">POST https:</span><span class="enlighter-c0">//api.contoso.com/files/v1.0/$subscriptions HTTP 1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Authorization: Bearer </span><span class="enlighter-g1">{</span><span class="enlighter-text">ApplicationPrincipalBearerToken</span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"resource"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"All.Files"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"notificationUrl"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://contoso.com/myCallbacks"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"clientState"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"clientOriginatedOpaqueToken"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">POST https://api.contoso.com/files/v1.0/$subscriptions HTTP 1.1
Authorization: Bearer {ApplicationPrincipalBearerToken}

{
  "resource": "All.Files",
  "notificationUrl": "https://contoso.com/myCallbacks",
  "clientState": "clientOriginatedOpaqueToken"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">POST https://api.contoso.com/files/v1.0/$subscriptions HTTP 1.1
Authorization: Bearer {ApplicationPrincipalBearerToken}

{
  "resource": "All.Files",
  "notificationUrl": "https://contoso.com/myCallbacks",
  "clientState": "clientOriginatedOpaqueToken"
}
</pre>
<p>服务应该以最小的响应格式响应这样的消息：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"8cbd6174abb391179"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"expirationDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2016-02-04T11:23Z"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "id": "8cbd6174abb391179",
  "expirationDateTime": "2016-02-04T11:23Z"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "id": "8cbd6174abb391179",
  "expirationDateTime": "2016-02-04T11:23Z"
}
</pre>
<p><strong>更新订阅</strong></p>
<p>服务可以支持修改订阅。 要更新现有订阅的属性，客户端使用 PATCH 请求提供 ID 和需要更改的属性。 省略的属性将保留其值。 要删除属性，请为其分配 JSON null 值。</p>
<p>与创建一样，订阅是单独管理的。</p>
<p>以下请求更改现有订阅的通知 URL：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">PATCH https:</span><span class="enlighter-c0">//api.contoso.com/files/v1.0/$subscriptions/{id} HTTP 1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Authorization: Bearer </span><span class="enlighter-g1">{</span><span class="enlighter-text">UserPrincipalBearerToken</span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"notificationUrl"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://contoso.com/myNewCallback"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">PATCH https://api.contoso.com/files/v1.0/$subscriptions/{id} HTTP 1.1
Authorization: Bearer {UserPrincipalBearerToken}

{
  "notificationUrl": "https://contoso.com/myNewCallback"
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">PATCH https://api.contoso.com/files/v1.0/$subscriptions/{id} HTTP 1.1
Authorization: Bearer {UserPrincipalBearerToken}

{
  "notificationUrl": "https://contoso.com/myNewCallback"
}
</pre>
<p>如果 PATCH 请求包含新的 notificationUrl，则服务器必须如上所述对其进行验证。 如果新 URL 无法验证，则服务必须使 PATCH 请求失败并将订阅保留在其先前的状态。</p>
<p>服务必须返回一个空的 body 和 204 No Content 来指示一个成功的补丁。</p>
<p>如果补丁失败，服务必须返回错误正文和状态代码。</p>
<p>操作必须以原子方式成功或失败。</p>
<p><strong>删除订阅</strong></p>
<p>服务必须支持删除订阅。 可以通过对订阅资源发出 DELETE 请求来删除现有订阅：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">DELETE https:</span><span class="enlighter-c0">//api.contoso.com/files/v1.0/$subscriptions/{id} HTTP 1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Authorization: Bearer </span><span class="enlighter-g1">{</span><span class="enlighter-text">UserPrincipalBearerToken</span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">DELETE https://api.contoso.com/files/v1.0/$subscriptions/{id} HTTP 1.1
Authorization: Bearer {UserPrincipalBearerToken}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">DELETE https://api.contoso.com/files/v1.0/$subscriptions/{id} HTTP 1.1
Authorization: Bearer {UserPrincipalBearerToken}
</pre>
<p>与更新一样，服务必须返回 204 No Content 以表示成功删除，或返回错误正文和状态代码以指示失败。</p>
<p><strong>枚举订阅</strong></p>
<p>要获取活动订阅列表，客户端使用 User + Application 或 Application-Only 承载令牌针对订阅资源发出 GET 请求：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/files/v1.0/$subscriptions HTTP 1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Authorization: Bearer </span><span class="enlighter-g1">{</span><span class="enlighter-text">UserPrincipalBearerToken</span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/files/v1.0/$subscriptions HTTP 1.1
Authorization: Bearer {UserPrincipalBearerToken}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/files/v1.0/$subscriptions HTTP 1.1
Authorization: Bearer {UserPrincipalBearerToken}
</pre>
<p>服务必须使用用户 + 应用程序主体承载令牌返回如下格式：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"32b8cbd6174ab18b"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"resource"</span><span class="enlighter-text">: </span><span class="enlighter-s0">" http://api.contoso.com/v1.0/files/file1.txt"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"notificationUrl"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://contoso.com/myCallbacks"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"clientState"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"clientOriginatedOpaqueToken"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"expirationDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2016-02-04T11:23Z"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "value": [
    {
      "id": "32b8cbd6174ab18b",
      "resource": " http://api.contoso.com/v1.0/files/file1.txt",
      "notificationUrl": "https://contoso.com/myCallbacks",
      "clientState": "clientOriginatedOpaqueToken",
      "expirationDateTime": "2016-02-04T11:23Z"
    }
  ]
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "value": [
    {
      "id": "32b8cbd6174ab18b",
      "resource": " http://api.contoso.com/v1.0/files/file1.txt",
      "notificationUrl": "https://contoso.com/myCallbacks",
      "clientState": "clientOriginatedOpaqueToken",
      "expirationDateTime": "2016-02-04T11:23Z"
    }
  ]
}
</pre>
<p>一个可能使用 Application-Only 主体不记名令牌返回的示例：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"value"</span><span class="enlighter-text">: </span><span class="enlighter-g1">[</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"id"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"6174ab18bfa22"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"resource"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"All.Files "</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"notificationUrl"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"https://contoso.com/myCallbacks"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"clientState"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"clientOriginatedOpaqueToken"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-s0">"expirationDateTime"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"2016-02-04T11:23Z"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">{
  "value": [
    {
      "id": "6174ab18bfa22",
      "resource": "All.Files ",
      "notificationUrl": "https://contoso.com/myCallbacks",
      "clientState": "clientOriginatedOpaqueToken",
      "expirationDateTime": "2016-02-04T11:23Z"
    }
  ]
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">{
  "value": [
    {
      "id": "6174ab18bfa22",
      "resource": "All.Files ",
      "notificationUrl": "https://contoso.com/myCallbacks",
      "clientState": "clientOriginatedOpaqueToken",
      "expirationDateTime": "2016-02-04T11:23Z"
    }
  ]
}
</pre>
<h3><span class="ez-toc-section" id="%E5%AE%89%E5%85%A8"></span>安全<span class="ez-toc-section-end"></span></h3>
<p>所有服务 URL 都必须是 HTTPS（即所有入站调用都必须是 HTTPS）。处理 Web Hook 的服务必须接受 HTTPS。</p>
<p>我们建议允许客户端定义的 Web Hook 回调 URL 的服务不应通过 HTTP 传输数据。这是因为信息可能会通过客户端、网络、服务器日志和其他机制无意中暴露出来。</p>
<p>但是，在某些情况下，由于客户端端点或软件限制，无法遵循上述建议。因此，服务可能允许 HTTP 的 web 钩子 URL。</p>
<p>此外，允许客户端定义的 HTTP Web 钩子回调 URL 的服务应该符合工程领导指定的隐私政策。这通常包括建议客户端首选 SSL 连接并遵守特殊预防措施以确保正确处理日志和其他服务数据收集。</p>
<p>例如，服务可能不想要求开发人员生成证书以供使用。服务可能仅在测试帐户上启用此功能。</p>
<h2><span class="ez-toc-section" id="%E4%B8%8D%E6%94%AF%E6%8C%81%E7%9A%84%E8%AF%B7%E6%B1%82"></span>不支持的请求<span class="ez-toc-section-end"></span></h2>
<p>RESTful API 客户端可以请求当前不受支持的功能。 RESTful API 必须响应与本节一致的有效但不受支持的请求。</p>
<h3><span class="ez-toc-section" id="%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99"></span>基本原则<span class="ez-toc-section-end"></span></h3>
<p>RESTful API 通常会选择限制客户端可以执行的功能。例如，审计系统允许创建记录但不允许修改或删除记录。类似地，一些 API 将公开集合但需要或以其他方式限制过滤和排序标准，或者可能不支持客户端驱动的分页。</p>
<h3><span class="ez-toc-section" id="%E5%8A%9F%E8%83%BD%E5%85%81%E8%AE%B8%E5%88%97%E8%A1%A8"></span>功能允许列表<span class="ez-toc-section-end"></span></h3>
<p>如果服务不支持以下任何 API 功能，并且调用者请求该功能，则必须提供错误响应。特点是：</p>
<ul>
<li>集合中的关键寻址，例如：https://api.contoso.com/v1.0/people/user1@contoso.com</li>
<li>按属性值过滤集合，例如：https://api.contoso.com/v1.0/people?$filter=name eq ‘david’</li>
<li>按范围过滤集合，例如：http://api.contoso.com/v1.0/people?$filter=hireDate ge 2014-01-01 和hiringDate le 2014-12-31</li>
<li>通过 $top 和 $skip 进行客户端驱动的分页，例如：http://api.contoso.com/v1.0/people?$top=5&amp;$skip=2</li>
<li>按$orderBy 排序，例如：https://api.contoso.com/v1.0/people?$orderBy=name desc</li>
<li>提供$delta 令牌，例如：https://api.contoso.com/v1.0/people?$delta</li>
</ul>
<p><strong>错误响应</strong></p>
<p>如果调用者请求在功能允许列表中发现不受支持的功能，服务必须提供错误响应。错误响应必须是来自 4xx 系列的 HTTP 状态代码，指示无法满足请求。除非更具体的错误状态适用于给定的请求，否则服务应该返回“400 Bad Request”和符合 Microsoft REST API 指南中提供的错误响应指南的错误负载。服务应该在响应消息中包含足够的细节，以便开发人员准确确定不支持请求的哪一部分。</p>
<p>例子：</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">GET https:</span><span class="enlighter-c0">//api.contoso.com/v1.0/people?$orderBy=name HTTP/1.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Accept: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">HTTP/</span><span class="enlighter-m3">1</span><span class="enlighter-text">.</span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-n1">400</span><span class="enlighter-text"> Bad Request</span></div></div><div class=""><div><span class="enlighter-text">Content-Type: application/json</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-s0">"error"</span><span class="enlighter-text">: </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"code"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"ErrorUnsupportedOrderBy"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">    </span><span class="enlighter-s0">"message"</span><span class="enlighter-text">: </span><span class="enlighter-s0">"Ordering by name is not supported."</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">  </span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw">GET https://api.contoso.com/v1.0/people?$orderBy=name HTTP/1.1
Accept: application/json

HTTP/1.1 400 Bad Request
Content-Type: application/json

{
  "error": {
    "code": "ErrorUnsupportedOrderBy",
    "message": "Ordering by name is not supported."
  }
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">GET https://api.contoso.com/v1.0/people?$orderBy=name HTTP/1.1
Accept: application/json

HTTP/1.1 400 Bad Request
Content-Type: application/json

{
  "error": {
    "code": "ErrorUnsupportedOrderBy",
    "message": "Ordering by name is not supported."
  }
}
</pre>
<h2><span class="ez-toc-section" id="%E5%91%BD%E5%90%8D%E6%8C%87%E5%8D%97"></span>命名指南<span class="ez-toc-section-end"></span></h2>
<h3><span class="ez-toc-section" id="%E6%96%B9%E6%B3%95"></span>方法<span class="ez-toc-section-end"></span></h3>
<p>命名策略应该帮助开发人员发现功能，而不必经常参考文档。 通用模式和标准约定的使用极大地帮助开发人员正确猜测通用属性名称和含义。 服务应该使用详细的命名模式，并且不应该使用除首字母缩略词以外的缩写词，这些缩写词是由 API 表示的域中的主要表达模式（例如 Url）。</p>
<h3><span class="ez-toc-section" id="Casing"></span>Casing<span class="ez-toc-section-end"></span></h3>
<ul>
<li>首字母缩略词应该遵循大小写约定，就好像它们是常规单词一样（例如 Url）。</li>
<li>所有标识符，包括命名空间、entityType、entitySet、属性、动作、函数和枚举值，都应该使用小驼峰命名法。</li>
<li>HTTP 标头是例外，应该使用Capitalized-Hyphenated-Terms大写-连字符的标准 HTTP 约定。</li>
</ul>
<h3><span class="ez-toc-section" id="%E9%81%BF%E5%85%8D%E7%9A%84%E5%90%8D%E5%AD%97"></span>避免的名字<span class="ez-toc-section-end"></span></h3>
<p>某些名称在 API 域中如此重载，以至于它们失去了所有意义，或者与使用 REST API 时无法避免的域中的其他常见用法（例如 OAUTH）发生冲突。 服务不应使用以下名称：</p>
<ul>
<li>Context</li>
<li>Scope</li>
<li>Resource</li>
</ul>
<h3><span class="ez-toc-section" id="Forming_compound_names"></span>Forming compound names<span class="ez-toc-section-end"></span></h3>
<ul>
<li>服务应避免使用诸如“a”、“the”、“of”之类的冠词，除非需要传达含义。
<ul>
<li>例如，不应使用诸如 aUser、theAccount、countOfBooks 之类的名称，而应首选 user、account、bookCount。</li>
</ul>
</li>
<li>服务应该向属性名称添加类型，否则会导致数据表示方式的歧义或会导致服务不使用公共属性名称。</li>
<li>向属性名称添加类型时，服务必须在末尾添加类型，例如 创建日期时间。</li>
</ul>
<h3><span class="ez-toc-section" id="%E8%BA%AB%E4%BB%BD%E5%B1%9E%E6%80%A7"></span>身份属性<span class="ez-toc-section-end"></span></h3>
<ul>
<li>服务必须使用字符串类型作为身份属性。</li>
<li>对于OData 服务，服务必须使用OData @id 属性来表示资源的规范标识符。</li>
<li>服务可以使用简单的“id”属性来表示资源的本地或遗留主键值。</li>
<li>服务应该使用后缀为“Id”的关系名称来表示另一个资源的外键，例如 订阅 ID。
<ul>
<li>该属性的内容应该是引用资源的规范 ID。</li>
</ul>
</li>
</ul>
<h3><span class="ez-toc-section" id="%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%B1%9E%E6%80%A7"></span>日期和时间属性<span class="ez-toc-section-end"></span></h3>
<ul>
<li>对于需要日期和时间的属性，服务必须使用后缀“DateTime”。</li>
<li>对于只需要日期信息而不指定时间的属性，服务必须使用后缀“Date”，例如birthDate。</li>
<li>对于只需要时间信息而不指定日期的属性，服务必须使用后缀“Time”，例如appointmentStartTime。</li>
</ul>
<h3><span class="ez-toc-section" id="%E5%90%8D%E7%A7%B0%E5%B1%9E%E6%80%A7"></span>名称属性<span class="ez-toc-section-end"></span></h3>
<ul>
<li>对于通常向用户显示的资源的整体名称，服务必须使用属性名称“displayName”。</li>
<li>服务可以使用其他常见的命名属性，例如，givenName, surname, signInName.</li>
</ul>
<h3><span class="ez-toc-section" id="%E9%9B%86%E5%90%88%E5%92%8C%E8%AE%A1%E6%95%B0"></span>集合和计数<span class="ez-toc-section-end"></span></h3>
<ul>
<li>服务必须使用正确的英语将集合命名为复数名词或复数名词短语。</li>
<li>服务可以使用简单的英语来表示复数不常用的名词。
<ul>
<li>例如，可以使用schemas代替schemata。</li>
</ul>
</li>
<li>服务必须以名词或以“Count”为后缀的名词短语来命名资源计数。</li>
</ul>
<h3><span class="ez-toc-section" id="%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7%E5%90%8D%E7%A7%B0"></span>常用属性名称<span class="ez-toc-section-end"></span></h3>
<p>如果服务具有属性，其数据与下面的名称匹配，则服务必须使用此表中的名称。 该表将随着服务添加更常用的术语而增长。 添加此类条款的服务所有者应建议对本文档进行添加。</p>
<table>
<tbody>
<tr>
<td></td>
</tr>
<tr>
<td>attendees</td>
</tr>
<tr>
<td>body</td>
</tr>
<tr>
<td>createdDateTime</td>
</tr>
<tr>
<td>childCount</td>
</tr>
<tr>
<td>children</td>
</tr>
<tr>
<td>contentUrl</td>
</tr>
<tr>
<td>country</td>
</tr>
<tr>
<td>createdBy</td>
</tr>
<tr>
<td>displayName</td>
</tr>
<tr>
<td>errorUrl</td>
</tr>
<tr>
<td>eTag</td>
</tr>
<tr>
<td>event</td>
</tr>
<tr>
<td>expirationDateTime</td>
</tr>
<tr>
<td>givenName</td>
</tr>
<tr>
<td>jobTitle</td>
</tr>
<tr>
<td>kind</td>
</tr>
<tr>
<td>id</td>
</tr>
<tr>
<td>lastModifiedDateTime</td>
</tr>
<tr>
<td>location</td>
</tr>
<tr>
<td>memberOf</td>
</tr>
<tr>
<td>message</td>
</tr>
<tr>
<td>name</td>
</tr>
<tr>
<td>owner</td>
</tr>
<tr>
<td>people</td>
</tr>
<tr>
<td>person</td>
</tr>
<tr>
<td>postalCode</td>
</tr>
<tr>
<td>photo</td>
</tr>
<tr>
<td>preferredLanguage</td>
</tr>
<tr>
<td>properties</td>
</tr>
<tr>
<td>signInName</td>
</tr>
<tr>
<td>surname</td>
</tr>
<tr>
<td>tags</td>
</tr>
<tr>
<td>userPrincipalName</td>
</tr>
<tr>
<td>webUrl</td>
</tr>
</tbody>
</table>
<h2><span class="ez-toc-section" id="%E9%99%84%E5%BD%95"></span>附录<span class="ez-toc-section-end"></span></h2>
<h3><span class="ez-toc-section" id="%E6%97%B6%E5%BA%8F%E5%9B%BE%E6%B3%A8%E9%87%8A"></span>时序图注释<span class="ez-toc-section-end"></span></h3>
<p>本文档中的所有序列图均使用 <a href="https://www.websequencediagrams.com/">WebSequenceDiagrams.com</a>生成。 要生成它们，请将下面的文本粘贴到 Web 工具中。</p>
<p><strong>Push notifications, per user flow</strong></p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">=== Begin Text ===</span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server:</span></div></div><div class=""><div><span class="enlighter-text">     An App Developer like MovieMaker</span></div></div><div class=""><div><span class="enlighter-text">     Wants to integrate with primary service like Dropbox</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">end</span><span class="enlighter-text"> note</span></div></div><div class=""><div><span class="enlighter-text">note over DB Portal, DB App Registration, DB Notifications, DB Auth, DB Service: The primary service like Dropbox</span></div></div><div class=""><div><span class="enlighter-text">note over Client: The </span><span class="enlighter-k1">end</span><span class="enlighter-text"> users' browser or installed app</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Manual App Registration</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Developer </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> DB Portal </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Login into Portal, App Registration UX</span></div></div><div class=""><div><span class="enlighter-text">DB Portal -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB App Registration: App Name etc.</span></div></div><div class=""><div><span class="enlighter-text">note over DB App Registration: Confirm Portal Access Token</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">DB App Registration -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -DB Portal: App ID</span></div></div><div class=""><div><span class="enlighter-text">DB Portal </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> App Server: Developer copies App ID</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Manual Notification Registration</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Developer </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> DB Portal: webhook registration UX</span></div></div><div class=""><div><span class="enlighter-text">DB Portal -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB Notifications: Register: App Server webhook URL, Scope, App ID</span></div></div><div class=""><div><span class="enlighter-text">Note over DB Notifications </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Confirm Portal Access Token</span></div></div><div class=""><div><span class="enlighter-text">DB Notifications -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -DB Portal: notification ID</span></div></div><div class=""><div><span class="enlighter-text">DB Portal --</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Developer may copy notification ID</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Client Authorization</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Client -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Request access to DB protected information</span></div></div><div class=""><div><span class="enlighter-text">App Server -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Redirect to DB Authorization endpoint with authorization request</span></div></div><div class=""><div><span class="enlighter-text">Client -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB Auth </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Redirected authorization request</span></div></div><div class=""><div><span class="enlighter-text">Client </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> DB Auth </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Authorization UX</span></div></div><div class=""><div><span class="enlighter-text">DB Auth -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Redirect back to App Server with code</span></div></div><div class=""><div><span class="enlighter-text">Client -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Redirect request back to access server with access code</span></div></div><div class=""><div><span class="enlighter-text">App Server -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB Auth </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Request tokens with access code</span></div></div><div class=""><div><span class="enlighter-text">note right </span><span class="enlighter-k1">of</span><span class="enlighter-text"> DB Service: Cache that </span><span class="enlighter-k1">this</span><span class="enlighter-text"> User ID provided access to App ID</span></div></div><div class=""><div><span class="enlighter-text">DB Auth -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Response with access, refresh, and ID tokens</span></div></div><div class=""><div><span class="enlighter-text">note right </span><span class="enlighter-k1">of</span><span class="enlighter-text"> App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Cache tokens by user ID</span></div></div><div class=""><div><span class="enlighter-text">App Server -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-k1">Return</span><span class="enlighter-text"> information to client</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Notification Flow</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Client </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> DB Service: Changes to user data - typical via interacting with App Server via Client</span></div></div><div class=""><div><span class="enlighter-text">DB Service -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Notification with notification ID and user ID</span></div></div><div class=""><div><span class="enlighter-text">App Server -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB Service </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Request changed information with cached access tokens and </span><span class="enlighter-s0">"since"</span><span class="enlighter-text"> token</span></div></div><div class=""><div><span class="enlighter-text">note over DB Service: Confirm User Access Token</span></div></div><div class=""><div><span class="enlighter-text">DB Service -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Response with data and </span><span class="enlighter-k1">new</span><span class="enlighter-text"> </span><span class="enlighter-s0">"since"</span><span class="enlighter-text"> token</span></div></div><div class=""><div><span class="enlighter-text">note right </span><span class="enlighter-k1">of</span><span class="enlighter-text"> App Server: Update status and cache </span><span class="enlighter-k1">new</span><span class="enlighter-text"> </span><span class="enlighter-s0">"since"</span><span class="enlighter-text"> token</span></div></div><div class=""><div><span class="enlighter-text">=== </span><span class="enlighter-k1">End</span><span class="enlighter-text"> Text ===</span></div></div></div><div class="enlighter-raw">=== Begin Text ===
note over Developer, Automation, App Server:
     An App Developer like MovieMaker
     Wants to integrate with primary service like Dropbox
end note
note over DB Portal, DB App Registration, DB Notifications, DB Auth, DB Service: The primary service like Dropbox
note over Client: The end users' browser or installed app

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Manual App Registration


Developer &lt;--&gt; DB Portal : Login into Portal, App Registration UX
DB Portal -&gt; +DB App Registration: App Name etc.
note over DB App Registration: Confirm Portal Access Token

DB App Registration -&gt; -DB Portal: App ID
DB Portal &lt;--&gt; App Server: Developer copies App ID

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Manual Notification Registration

Developer &lt;--&gt; DB Portal: webhook registration UX
DB Portal -&gt; +DB Notifications: Register: App Server webhook URL, Scope, App ID
Note over DB Notifications : Confirm Portal Access Token
DB Notifications -&gt; -DB Portal: notification ID
DB Portal --&gt; App Server : Developer may copy notification ID


note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Client Authorization

Client -&gt; +App Server : Request access to DB protected information
App Server -&gt; -Client : Redirect to DB Authorization endpoint with authorization request
Client -&gt; +DB Auth : Redirected authorization request
Client &lt;--&gt; DB Auth : Authorization UX
DB Auth -&gt; -Client : Redirect back to App Server with code
Client -&gt; +App Server : Redirect request back to access server with access code
App Server -&gt; +DB Auth : Request tokens with access code
note right of DB Service: Cache that this User ID provided access to App ID
DB Auth -&gt; -App Server : Response with access, refresh, and ID tokens
note right of App Server : Cache tokens by user ID
App Server -&gt; -Client : Return information to client

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Notification Flow

Client &lt;--&gt; DB Service: Changes to user data - typical via interacting with App Server via Client
DB Service -&gt; App Server : Notification with notification ID and user ID
App Server -&gt; +DB Service : Request changed information with cached access tokens and "since" token
note over DB Service: Confirm User Access Token
DB Service -&gt; -App Server : Response with data and new "since" token
note right of App Server: Update status and cache new "since" token
=== End Text ===</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">=== Begin Text ===
note over Developer, Automation, App Server:
     An App Developer like MovieMaker
     Wants to integrate with primary service like Dropbox
end note
note over DB Portal, DB App Registration, DB Notifications, DB Auth, DB Service: The primary service like Dropbox
note over Client: The end users' browser or installed app

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Manual App Registration


Developer &lt;--&gt; DB Portal : Login into Portal, App Registration UX
DB Portal -&gt; +DB App Registration: App Name etc.
note over DB App Registration: Confirm Portal Access Token

DB App Registration -&gt; -DB Portal: App ID
DB Portal &lt;--&gt; App Server: Developer copies App ID

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Manual Notification Registration

Developer &lt;--&gt; DB Portal: webhook registration UX
DB Portal -&gt; +DB Notifications: Register: App Server webhook URL, Scope, App ID
Note over DB Notifications : Confirm Portal Access Token
DB Notifications -&gt; -DB Portal: notification ID
DB Portal --&gt; App Server : Developer may copy notification ID


note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Client Authorization

Client -&gt; +App Server : Request access to DB protected information
App Server -&gt; -Client : Redirect to DB Authorization endpoint with authorization request
Client -&gt; +DB Auth : Redirected authorization request
Client &lt;--&gt; DB Auth : Authorization UX
DB Auth -&gt; -Client : Redirect back to App Server with code
Client -&gt; +App Server : Redirect request back to access server with access code
App Server -&gt; +DB Auth : Request tokens with access code
note right of DB Service: Cache that this User ID provided access to App ID
DB Auth -&gt; -App Server : Response with access, refresh, and ID tokens
note right of App Server : Cache tokens by user ID
App Server -&gt; -Client : Return information to client

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Notification Flow

Client &lt;--&gt; DB Service: Changes to user data - typical via interacting with App Server via Client
DB Service -&gt; App Server : Notification with notification ID and user ID
App Server -&gt; +DB Service : Request changed information with cached access tokens and "since" token
note over DB Service: Confirm User Access Token
DB Service -&gt; -App Server : Response with data and new "since" token
note right of App Server: Update status and cache new "since" token
=== End Text ===
</pre>
<p><strong>Push notifications, firehose flow</strong></p>
<div class="enlighter-default enlighter-v-standard enlighter-t-beyond enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">=== Begin Text ===</span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server:</span></div></div><div class=""><div><span class="enlighter-text">     An App Developer like MovieMaker</span></div></div><div class=""><div><span class="enlighter-text">     Wants to integrate with primary service like Dropbox</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">end</span><span class="enlighter-text"> note</span></div></div><div class=""><div><span class="enlighter-text">note over DB Portal, DB App Registration, DB Notifications, DB Auth, DB Service: The primary service like Dropbox</span></div></div><div class=""><div><span class="enlighter-text">note over Client: The </span><span class="enlighter-k1">end</span><span class="enlighter-text"> users' browser or installed app</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> App Registration</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">alt Automated app registration</span></div></div><div class=""><div><span class="enlighter-text">   Developer </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> Automation: Configure</span></div></div><div class=""><div><span class="enlighter-text">   Automation -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB App Registration: App Name etc.</span></div></div><div class=""><div><span class="enlighter-text">   note over DB App Registration: Confirm App Access Token</span></div></div><div class=""><div><span class="enlighter-text">   DB App Registration -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -Automation: App ID, App Secret</span></div></div><div class=""><div><span class="enlighter-text">   Automation --</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Embed App ID, App Secret</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">else</span><span class="enlighter-text"> Manual app registration</span></div></div><div class=""><div><span class="enlighter-text">   Developer </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> DB Portal </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Login into Portal, App Registration UX</span></div></div><div class=""><div><span class="enlighter-text">   DB Portal -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB App Registration: App Name etc.</span></div></div><div class=""><div><span class="enlighter-text">   note over DB App Registration: Confirm Portal Access Token</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   DB App Registration -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -DB Portal: App ID</span></div></div><div class=""><div><span class="enlighter-text">   DB Portal </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> App Server: Developer copies App ID</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">end</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Client Authorization</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Client -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Request access to DB protected information</span></div></div><div class=""><div><span class="enlighter-text">App Server -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Redirect to DB Authorization endpoint with authorization request</span></div></div><div class=""><div><span class="enlighter-text">Client -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB Auth </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Redirected authorization request</span></div></div><div class=""><div><span class="enlighter-text">Client </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> DB Auth </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Authorization UX</span></div></div><div class=""><div><span class="enlighter-text">DB Auth -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Redirect back to App Server with code</span></div></div><div class=""><div><span class="enlighter-text">Client -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Redirect request back to access server with access code</span></div></div><div class=""><div><span class="enlighter-text">App Server -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB Auth </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Request tokens with access code</span></div></div><div class=""><div><span class="enlighter-text">note right </span><span class="enlighter-k1">of</span><span class="enlighter-text"> DB Service: Cache that </span><span class="enlighter-k1">this</span><span class="enlighter-text"> User ID provided access to App ID</span></div></div><div class=""><div><span class="enlighter-text">DB Auth -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Response with access, refresh, and ID tokens</span></div></div><div class=""><div><span class="enlighter-text">note right </span><span class="enlighter-k1">of</span><span class="enlighter-text"> App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Cache tokens by user ID</span></div></div><div class=""><div><span class="enlighter-text">App Server -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-k1">Return</span><span class="enlighter-text"> information to client</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Notification Registration</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">App Server-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">+DB Notifications: Register: App server webhook URL, Scope, App ID</span></div></div><div class=""><div><span class="enlighter-text">note over DB Notifications </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Confirm User Access Token</span></div></div><div class=""><div><span class="enlighter-text">DB Notifications -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -App Server: notification ID</span></div></div><div class=""><div><span class="enlighter-text">note right </span><span class="enlighter-k1">of</span><span class="enlighter-text"> App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Cache the Notification ID and User Access Token</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Notification Flow</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Client </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">--</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> DB Service: Changes to user data - typical via interacting with App Server via Client</span></div></div><div class=""><div><span class="enlighter-text">DB Service -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Notification with notification ID and user ID</span></div></div><div class=""><div><span class="enlighter-text">App Server -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> +DB Service </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Request changed information with cached access tokens and </span><span class="enlighter-s0">"since"</span><span class="enlighter-text"> token</span></div></div><div class=""><div><span class="enlighter-text">note over DB Service: Confirm User Access Token</span></div></div><div class=""><div><span class="enlighter-text">DB Service -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> -App Server </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Response with data and </span><span class="enlighter-k1">new</span><span class="enlighter-text"> </span><span class="enlighter-s0">"since"</span><span class="enlighter-text"> token</span></div></div><div class=""><div><span class="enlighter-text">note right </span><span class="enlighter-k1">of</span><span class="enlighter-text"> App Server: Update status and cache </span><span class="enlighter-k1">new</span><span class="enlighter-text"> </span><span class="enlighter-s0">"since"</span><span class="enlighter-text"> token</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">=== </span><span class="enlighter-k1">End</span><span class="enlighter-text"> Text ===</span></div></div></div><div class="enlighter-raw">=== Begin Text ===
note over Developer, Automation, App Server:
     An App Developer like MovieMaker
     Wants to integrate with primary service like Dropbox
end note
note over DB Portal, DB App Registration, DB Notifications, DB Auth, DB Service: The primary service like Dropbox
note over Client: The end users' browser or installed app

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : App Registration

alt Automated app registration
   Developer &lt;--&gt; Automation: Configure
   Automation -&gt; +DB App Registration: App Name etc.
   note over DB App Registration: Confirm App Access Token
   DB App Registration -&gt; -Automation: App ID, App Secret
   Automation --&gt; App Server : Embed App ID, App Secret
else Manual app registration
   Developer &lt;--&gt; DB Portal : Login into Portal, App Registration UX
   DB Portal -&gt; +DB App Registration: App Name etc.
   note over DB App Registration: Confirm Portal Access Token

   DB App Registration -&gt; -DB Portal: App ID
   DB Portal &lt;--&gt; App Server: Developer copies App ID
end

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Client Authorization

Client -&gt; +App Server : Request access to DB protected information
App Server -&gt; -Client : Redirect to DB Authorization endpoint with authorization request
Client -&gt; +DB Auth : Redirected authorization request
Client &lt;--&gt; DB Auth : Authorization UX
DB Auth -&gt; -Client : Redirect back to App Server with code
Client -&gt; +App Server : Redirect request back to access server with access code
App Server -&gt; +DB Auth : Request tokens with access code
note right of DB Service: Cache that this User ID provided access to App ID
DB Auth -&gt; -App Server : Response with access, refresh, and ID tokens
note right of App Server : Cache tokens by user ID
App Server -&gt; -Client : Return information to client

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Notification Registration

App Server-&gt;+DB Notifications: Register: App server webhook URL, Scope, App ID
note over DB Notifications : Confirm User Access Token
DB Notifications -&gt; -App Server: notification ID
note right of App Server : Cache the Notification ID and User Access Token

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Notification Flow


Client &lt;--&gt; DB Service: Changes to user data - typical via interacting with App Server via Client
DB Service -&gt; App Server : Notification with notification ID and user ID
App Server -&gt; +DB Service : Request changed information with cached access tokens and "since" token
note over DB Service: Confirm User Access Token
DB Service -&gt; -App Server : Response with data and new "since" token
note right of App Server: Update status and cache new "since" token


=== End Text ===</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="generic">=== Begin Text ===
note over Developer, Automation, App Server:
     An App Developer like MovieMaker
     Wants to integrate with primary service like Dropbox
end note
note over DB Portal, DB App Registration, DB Notifications, DB Auth, DB Service: The primary service like Dropbox
note over Client: The end users' browser or installed app

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : App Registration

alt Automated app registration
   Developer &lt;--&gt; Automation: Configure
   Automation -&gt; +DB App Registration: App Name etc.
   note over DB App Registration: Confirm App Access Token
   DB App Registration -&gt; -Automation: App ID, App Secret
   Automation --&gt; App Server : Embed App ID, App Secret
else Manual app registration
   Developer &lt;--&gt; DB Portal : Login into Portal, App Registration UX
   DB Portal -&gt; +DB App Registration: App Name etc.
   note over DB App Registration: Confirm Portal Access Token

   DB App Registration -&gt; -DB Portal: App ID
   DB Portal &lt;--&gt; App Server: Developer copies App ID
end

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Client Authorization

Client -&gt; +App Server : Request access to DB protected information
App Server -&gt; -Client : Redirect to DB Authorization endpoint with authorization request
Client -&gt; +DB Auth : Redirected authorization request
Client &lt;--&gt; DB Auth : Authorization UX
DB Auth -&gt; -Client : Redirect back to App Server with code
Client -&gt; +App Server : Redirect request back to access server with access code
App Server -&gt; +DB Auth : Request tokens with access code
note right of DB Service: Cache that this User ID provided access to App ID
DB Auth -&gt; -App Server : Response with access, refresh, and ID tokens
note right of App Server : Cache tokens by user ID
App Server -&gt; -Client : Return information to client

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Notification Registration

App Server-&gt;+DB Notifications: Register: App server webhook URL, Scope, App ID
note over DB Notifications : Confirm User Access Token
DB Notifications -&gt; -App Server: notification ID
note right of App Server : Cache the Notification ID and User Access Token

note over Developer, Automation, App Server, DB Portal, DB App Registration, DB Notifications, Client : Notification Flow


Client &lt;--&gt; DB Service: Changes to user data - typical via interacting with App Server via Client
DB Service -&gt; App Server : Notification with notification ID and user ID
App Server -&gt; +DB Service : Request changed information with cached access tokens and "since" token
note over DB Service: Confirm User Access Token
DB Service -&gt; -App Server : Response with data and new "since" token
note right of App Server: Update status and cache new "since" token


=== End Text ===
</pre>
<p>参考链接：</p>
<ul>
<li><a href="https://github.com/microsoft/api-guidelines/blob/vNext/Guidelines.md">Microsoft REST API Guidelines</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/architecture/best-practices/api-design">RESTful web API design</a></li>
</ul>
<div class="yarpp-related">
<h2>相关文章:</h2><ol>
<li><a href="https://www.biaodianfu.com/python-json-jsonp.html" rel="bookmark" title="Python JSON/JSONP数据解析">Python JSON/JSONP数据解析 </a></li>
<li><a href="https://www.biaodianfu.com/python-build-web-server.html" rel="bookmark" title="Python 从0到1搭建Web 服务器">Python 从0到1搭建Web 服务器 </a></li>
<li><a href="https://www.biaodianfu.com/pep-3333.html" rel="bookmark" title="PEP 3333：Python Web 服务器网关接口v1.0.1">PEP 3333：Python Web 服务器网关接口v1.0.1 </a></li>
<li><a href="https://www.biaodianfu.com/pep-333-python-web-server-gateway-interface.html" rel="bookmark" title="PEP 333：Python Web服务器Gateway接口 v1.0">PEP 333：Python Web服务器Gateway接口 v1.0 </a></li>
<li><a href="https://www.biaodianfu.com/django-tutorial.html" rel="bookmark" title="Django实战：投票系统搭建">Django实战：投票系统搭建 </a></li>
</ol>
</div>
<div class="clearfix"></div>
</article>
<!-- tags -->
<div class="after-post-tags"><div class="post-categories aretags"><a class="tag-link bg-light" href="https://www.biaodianfu.com/tag/api">API</a> <a class="tag-link bg-light" href="https://www.biaodianfu.com/tag/rest">REST</a> </div></div>
<!-- end tags -->
<!-- widget after article -->
<!-- end widget after article -->
</div>
<!-- end main column -->
<!-- share -->
<div class="col-md-2 mb-4 order-md-first">
<div class="sticky-top sticky-sidebar-offset">
<div class="share text-center">
<div class="sidebarapplause">
<div id="pt-claps-applause-4005" class="pt-claps-applause">
<a class="claps-button" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html" data-id="4005"></a>
<span id="claps-count-4005" class="claps-count">0</span><input type="hidden" id="_wpnonce" name="_wpnonce" value="a34647e6ad"><input type="hidden" name="_wp_http_referer" value="/microsoft-rest-api-guidelines.html"></div>                                <div class="wbp-cbm"><a class="wb-btn-dwqr wb-btn-donate j-dwqr-donate-btn"><svg class="wb-icon wbsico-donate"><use xlink:href="#wbsico-dwqr-donate"></use></svg><span>打赏</span></a></div>
<div class="wbp-cbm"><a class="wb-btn-dwqr wb-share-poster j-dwqr-poster-btn"><svg class="wb-icon wbsico-poster"><use xlink:href="#wbsico-dwqr-poster"></use></svg><span>微海报</span></a></div>
<div class="wbp-cbm" wb-share-url="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html"><a class="wb-btn-dwqr wb-btn-share j-dwqr-social-btn"><svg class="wb-icon wbsico-share"><use xlink:href="#wbsico-dwqr-share"></use></svg><span>分享</span></a></div>
</div>
<div class="sep"></div>
<div class="d-none d-md-block">
<p>评论</p>
<ul><li><a class="smoothscroll" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#comments">0<br><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></a></li></ul>
</div>
</div>
</div>
</div><!-- end share -->
</div><!-- end row -->
</div><!-- end container-fluid -->
</div><!-- end alignfullincol -->
</div><!-- end post id -->
<!-- related posts -->
<div class="row justify-content-center h-100 listrecent listrelated mb-4"><div class="col-sm-6 mb-4 mb-md-0 col-md-4"><div class="card border-0 cardwithshadow minh100 onhoverup"><img width="640" height="470" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/websocket-http.jpg" class="w-100 card-img-top wp-post-image" alt="" loading="lazy"><div class="card-body"><h5 class="h5"><a class="text-dark" href="https://www.biaodianfu.com/real-time-web-application.html">Web应用中的实时消息技术</a></h5><div class="metafooter small mt-auto"></div></div></div></div><div class="col-sm-6 mb-4 mb-md-0 col-md-4"><div class="card border-0 cardwithshadow minh100 onhoverup"><img width="640" height="294" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/im-layers.png" class="w-100 card-img-top wp-post-image" alt="" loading="lazy"><div class="card-body"><h5 class="h5"><a class="text-dark" href="https://www.biaodianfu.com/mafengwo.html">即时通讯协议之马蜂窝</a></h5><div class="metafooter small mt-auto"></div></div></div></div><div class="col-sm-6 mb-4 mb-md-0 col-md-4"><div class="card border-0 cardwithshadow minh100 onhoverup"><img width="750" height="420" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/whatsapp-arch.png" class="w-100 card-img-top wp-post-image" alt="" loading="lazy"><div class="card-body"><h5 class="h5"><a class="text-dark" href="https://www.biaodianfu.com/whatsapp.html">即时通讯协议之WhatsApp</a></h5><div class="metafooter small mt-auto"></div></div></div></div></div>
<div class="clearfix"></div>
<!-- end related posts -->
<!-- comments -->
<div class="row justify-content-center">
<div class="col-md-8">
<div id="comments" class="comments-area">
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html#respond" style="display:none;">取消回复</a></small></h3><form action="https://www.biaodianfu.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate=""><p class="comment-notes"><span id="email-notes">您的电子邮箱地址不会被公开。</span> 必填项已用<span class="required">*</span>标注</p><p class="comment-form-comment"><textarea required="" id="comment" name="comment" placeholder="Write a response..." cols="45" rows="8" aria-required="true"></textarea></p><div class="row"><p class="comment-form-author col-md-4"><input id="author" name="author" type="text" placeholder="Name" value="" size="30" aria-required="true"></p>
<p class="comment-form-email col-md-4"><input id="email" name="email" type="email" placeholder="E-mail address" value="" size="30" aria-required="true"></p>
<p class="comment-form-url col-md-4"><input id="url" name="url" type="url" placeholder="Website Link" value="" size="30"></p></div>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent">在此浏览器中保存我的显示名称、邮箱地址和网站地址，以便下次评论时使用。</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="发表评论"> <input type="hidden" name="comment_post_ID" value="4005" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="4cd55d60ff"></p><input type="hidden" id="ak_js" name="ak_js" value="205"><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
</div><!-- #comments -->
</div>
</div><!-- end comments -->
</div> <!-- / end container site-content -->
<a href="https://www.biaodianfu.com/microsoft-rest-api-guidelines.html" class="back-to-top" style="display: inline;"><i class="fa fa-angle-up"></i></a>
<div class="container text-center text-md-left">
<footer class="footer text-muted d-md-flex justify-content-between align-items-center pt-4 pb-4 border-top" itemscope="itemscope" itemtype="http://schema.org/WPFooter" role="contentinfo">
<div>© 标点符. All rights reserved.</div>
<div class="text-md-right"><a href="http://beian.miit.gov.cn/">苏ICP备08120382号</a></div>
</footer>
</div>
<script>var _hmt = _hmt || [];(function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?96fa7bd66c5549ed75c07b031964b927"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })();</script>
<script type="application/ld+json">
{
"@context": "http://schema.org",
"@type": "Article",
"mainEntityOfPage": { "@type": "WebPage", "@id": "https://www.biaodianfu.com/microsoft-rest-api-guidelines.html" },
"headline": "Microsoft REST API Guidelines中文翻译",
"description": "微软的REST API指南算是网上比较详细的关于Restfull API的指导方案，由于本身是英文，网上存在部分翻译，但是大部分只翻译了一小部分内容，没有全部翻译。所以抽时间做了简单的翻译和整理。翻译质量有限，望海涵。 介绍 开发者基本都通过 HTTP 接口访问微软云平台的资源。尽管每个服务通过特定语言的框架封装了它们的 API，但它们的所有…",
"datePublished": "2021-11-18",
"dateModified": "2021-11-18",
"image": {"@type": "ImageObject",  "url": "https://www.biaodianfu.com/wp-content/uploads/2021/11/microsoft-rest-api-guidelines.png",  "height": 150, "width": 150 },
"publisher": { "@type": "Organization", "name": "标点符", "logo": { "@type": "ImageObject", "url": "https://www.biaodianfu.com/biaodianfu_logo.png", "height": 86, "width": 200 } },
"author": { "@type": "Person", "name": "钱魏Way", }
}
</script>
<script type="text/javascript">/* <![CDATA[ */!function(e,n){var r={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":false,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"beyond","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""},"resources":["https:\/\/www.biaodianfu.com\/wp-content\/plugins\/enlighter\/cache\/enlighterjs.min.css?loOhcIQwJlVRpzc","https:\/\/www.biaodianfu.com\/wp-content\/plugins\/enlighter\/resources\/enlighterjs\/enlighterjs.min.js"]},o=document.getElementsByTagName("head")[0],t=n&&(n.error||n.log)||function(){};e.EnlighterJSINIT=function(){!function(e,n){var r=0,l=null;function c(o){l=o,++r==e.length&&(!0,n(l))}e.forEach(function(e){switch(e.match(/\.([a-z]+)(?:[#?].*)?$/)[1]){case"js":var n=document.createElement("script");n.onload=function(){c(null)},n.onerror=c,n.src=e,n.async=!0,o.appendChild(n);break;case"css":var r=document.createElement("link");r.onload=function(){c(null)},r.onerror=c,r.rel="stylesheet",r.type="text/css",r.href=e,r.media="all",o.appendChild(r);break;default:t("Error: invalid file extension",e)}})}(r.resources,function(e){e?t("Error: failed to dynamically load EnlighterJS resources!",e):"undefined"!=typeof EnlighterJS?EnlighterJS.init(r.selectors.block,r.selectors.inline,r.options):t("Error: EnlighterJS resources not loaded yet!")})},(document.querySelector(r.selectors.block)||document.querySelector(r.selectors.inline))&&e.EnlighterJSINIT()}(window,console); /* ]]> */</script><!-- <link rel='stylesheet' id='wbui-css-css'  href='https://www.biaodianfu.com/wp-content/plugins/donate-with-qrcode/assets/wbui/assets/wbui.css?ver=1.4.0' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='wbs-dwqr-css-css'  href='https://www.biaodianfu.com/wp-content/plugins/donate-with-qrcode/assets/wbp_donate.css?ver=1.4.0' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='paywall.min.css-css'  href='https://www.biaodianfu.com/wp-content/plugins/paywall/includes/paywall_php_sdk/paywall.css?ver=5.8.2' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='yarppRelatedCss-css'  href='https://www.biaodianfu.com/wp-content/plugins/yet-another-related-posts-plugin/style/related.css?ver=5.8.2' type='text/css' media='all' /> -->
<link rel="stylesheet" type="text/css" href="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/xg2(1).css" media="all">
<script type="text/javascript" id="wp-postviews-cache-js-extra">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"https:\/\/www.biaodianfu.com\/wp-admin\/admin-ajax.php","post_id":"4005"};
/* ]]> */
</script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/postviews-cache.js.下载" id="wp-postviews-cache-js"></script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/theme.min.js.下载" id="mundana-scripts-js"></script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/comment-reply.min.js.下载" id="comment-reply-js"></script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/js.cookie.js.下载" id="jquery-cookie-js"></script>
<script type="text/javascript" id="wp-claps-applause-js-extra">
/* <![CDATA[ */
var clapsapplause = {"ajax_url":"https:\/\/www.biaodianfu.com\/wp-admin\/admin-ajax.php","lovedText":"","loveText":""};
/* ]]> */
</script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/claps-applause.js.下载" id="wp-claps-applause-js"></script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/wbui.js.下载" id="wbui-js-js"></script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/qrious.min.js.下载" id="qrious-js-js"></script>
<script type="text/javascript" id="wbs-front-dwqr-js-before">
var dwqr_opt="1.4.0|https%3A%2F%2Fwww.biaodianfu.com%2Fwp-content%2Fplugins%2Fdonate-with-qrcode%2F|0|https%3A%2F%2Fwww.biaodianfu.com%2Fwp-admin%2Fadmin-ajax.php|4005";
var poster_theme=0, poster_ratio="3:2";var wb_dwqr_donate_html='<div class="tab-navs"><div class="tab-nav-item item-weixin current"><span>微信</span></div><div class="tab-nav-item item-alipay"><span>支付宝</span></div></div><div class="tab-conts"><div class="tab-cont current"><div class="pic"><img src="/img/alipay.jpg" alt="微信二维码图片"></div><p>用<span class="hl">微信</span>扫描二维码打赏</p></div><div class="tab-cont"><div class="pic"><img src="/img/wechat.jpg" alt="支付宝二维码图片"></div><p>用<span class="hl">支付宝</span>扫描二维码打赏</p></div></div>';var wb_dwqr_share_html='<div class="wb-share-list" data-cover="https://www.biaodianfu.com/wp-content/uploads/2021/11/microsoft-rest-api-guidelines.png"><a class="share-logo icon-weixin" data-cmd="weixin" title="分享到微信" rel="nofollow"><svg class="wb-icon wbsico-dwqr-weixin"><use xlink:href="#wbsico-dwqr-weixin"></use></svg></a><a class="share-logo icon-weibo" data-cmd="weibo" title="分享到微博" rel="nofollow"><svg class="wb-icon wbsico-dwqr-weibo"><use xlink:href="#wbsico-dwqr-weibo"></use></svg></a><a class="share-logo icon-qzone" data-cmd="qzone" title="分享到QQ空间" rel="nofollow"><svg class="wb-icon wbsico-dwqr-qzone"><use xlink:href="#wbsico-dwqr-qzone"></use></svg></a><a class="share-logo icon-qq" data-cmd="qq" title="分享到QQ" rel="nofollow"><svg class="wb-icon wbsico-dwqr-qq"><use xlink:href="#wbsico-dwqr-qq"></use></svg></a>';
</script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/wbp_front.js.下载" id="wbs-front-dwqr-js"></script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/jquery.smooth-scroll.min.js.下载" id="jquery-smooth-scroll-js"></script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/js.cookie.min.js.下载" id="js-cookie-js"></script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/jquery.sticky-kit.min.js.下载" id="jquery-sticky-kit-js"></script>
<script type="text/javascript" id="ez-toc-js-js-extra">
/* <![CDATA[ */
var ezTOC = {"smooth_scroll":"1","visibility_hide_by_default":"","width":"100%","scroll_offset":"30"};
/* ]]> */
</script>
<script type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/front.min.js.下载" id="ez-toc-js-js"></script>
<script defer="" type="text/javascript" src="Microsoft%20REST%20API%20Guidelines中文翻译%20–%20标点符_files/form.js.下载" id="akismet-form-js"></script>

</body></html>
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"4ISH":function(e,a,t){"use strict";t.d(a,"a",(function(){return c})),t.d(a,"b",(function(){return o}));var n=t("tJVT"),l=t("q1tI"),r=t("wnGr"),c=function(){var e=Object(l["useState"])(!1),a=Object(n["a"])(e,2),t=a[0],c=a[1],o=Object(r["l"])((function(e){var a;return null===e||void 0===e||null===(a=e.global)||void 0===a?void 0:a.sessionUser}));return Object(l["useEffect"])((function(){var e;c(!!o&&(null===(e=o.roles)||void 0===e?void 0:e.is_admin))}),[o]),t},o=function(){var e=Object(l["useState"])(!1),a=Object(n["a"])(e,2),t=a[0],c=a[1],o=Object(r["l"])((function(e){var a;return null===e||void 0===e||null===(a=e.global)||void 0===a?void 0:a.sessionUser}));return Object(l["useEffect"])((function(){var e;c(!!o&&(null===(e=o.roles)||void 0===e?void 0:e.is_editor))}),[]),t}},"95Qr":function(e,a,t){"use strict";var n=t("tJVT"),l=t("q1tI"),r=t.n(l),c=t("97+O"),o=t("QojX"),i=t("jDKy"),s=t("8+cs"),d=(t("JsPT"),function(e){var a=e.defaultValue,t=void 0===a?"":a,d=e.className,m=void 0===d?"":d,u=e.menukey,v=void 0===u?"":u,f=Object(l["useState"])(t),g=Object(n["a"])(f,2),b=g[0],p=g[1],h=Object(l["useState"])(0),E=Object(n["a"])(h,2),w=E[0],N=E[1],y=Object(l["useState"])("bing"),j=Object(n["a"])(y,2),O=j[0],k=j[1],x=function(){if(b.length>0){var e="";s["e"].forEach((function(a){a.site===O&&(e=(null===a||void 0===a?void 0:a.url)||"")})),"sf"===O?window.location.href="/search?q=".concat(b):window.open("".concat(e).concat(b))}},_=function(){b&&N((function(e){return e+1}));var e=localStorage.getItem("searchSite")||"bing";k(e);var a=document.querySelector("html");a instanceof HTMLElement&&a.style.setProperty("scroll-padding-top","0px")},S=function(){var e=document.querySelector("html");e instanceof HTMLElement&&e.style.setProperty("scroll-padding-top","60px")};return r.a.createElement(c["a"],{id:"header-tsearch-toogle",className:m},r.a.createElement(c["a"].Toggle,{as:"div",className:"position-relative"},r.a.createElement("div",{className:"icon-search",onClick:x},r.a.createElement("i",{className:"far fa-magnifying-glass text-secondary"})),r.a.createElement(o["a"],{action:"/search",autoComplete:"off"},r.a.createElement(i["a"],{type:"text",name:"q",placeholder:"\u641c\u7d22\u5173\u952e\u5b57","aria-label":"\u641c\u7d22",value:b,onClick:function(){N(0)},onChange:function(e){p(e.target.value),e.target.value.length<=0?N(0):N((function(e){return e+1}))},onFocus:_,onBlur:S,onKeyDown:function(e){13===e.keyCode&&b.length>0&&x()},className:"me-sm-2 w-100 input"}))),r.a.createElement(c["a"].Menu,{className:"w-100",key:v||w,show:w>0,renderOnMount:!0},s["e"].map((function(e){return r.a.createElement(c["a"].Item,{as:"a",key:e.site,href:"".concat(e.url).concat(b),target:"sf"===e.site?"_self":"_blank",active:O===e.site,onClick:function(){localStorage.setItem("searchSite",e.site),k(e.site)}},r.a.createElement("span",{className:"search-name"},e.site===O?"\u2713":""),e.name)}))))});a["a"]=r.a.memo(d)},JsPT:function(e,a,t){},UFbl:function(e,a,t){e.exports={"tip-circle":"tip-circle___3bQrI","medal-circle":"medal-circle___3y5mn","sf-header":"sf-header___2cUz5","sf-header-logo":"sf-header-logo___3_xEt","self-nav-toogle":"self-nav-toogle___jVdh3","bg-warning":"bg-warning___1d-yx",dropdown:"dropdown___3SZe6","hover-down":"hover-down___3UKu6","dropdown-menu":"dropdown-menu___3NwcA","sflex-center":"sflex-center___2eThn","dropdown-toggle":"dropdown-toggle___3yzC1","header-search":"header-search___28AtS","title-wrap":"title-wrap___w3dqY","review-dot":"review-dot___2nOVA","marketing-dot":"marketing-dot___2nxK4"}},XHHP:function(e,a,t){e.exports=t.p+"static/logo-b.d865fc97.svg"},Z6Z6:function(e,a,t){e.exports=t.p+"static/sf-icon-small.82a498f6.svg"},ruvs:function(e,a,t){"use strict";var n=t("9og8"),l=t("tJVT"),r=t("WmNS"),c=t.n(r),o=t("q1tI"),i=t.n(o),s=t("6ctO"),d=t("7vrA"),m=t("dDCJ"),u=t("AINe"),v=t("65eO"),f=t("97+O"),g=t("+YzT"),b=t("GWEY"),p=t("wnGr"),h=t("8+cs"),E=t("TSYQ"),w=t.n(E),N=t("oBTY"),y=t("6xyR"),j=t("sjrs"),O=t("RotF"),k=t.n(O),x=t("LvDl"),_=t("UFbl"),S=t.n(_),I=function(){return i.a.createElement("div",{className:S.a["sflex-center"]+" message-loading",style:{height:"100%"}},i.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")))},C=I,D=t("NAXS"),T=t("RT37"),U=function(e){var a,t,n,r,c,s,d,m=e.data,u=Object(o["useState"])(null===m||void 0===m?void 0:m.viewed),v=Object(l["a"])(u,2),f=v[0],g=v[1];return i.a.createElement(D["a"],{as:"li",action:!0,className:"d-flex align-items-center ".concat(f?"":"bg-warning"," py-2 border-0"),onClick:function(){window.open(null===m||void 0===m?void 0:m.url),m.viewed||g(1)},style:{cursor:"pointer"}},i.a.createElement(T["a"],{src:null===m||void 0===m||null===(a=m.target_user)||void 0===a?void 0:a.avatar_url,className:"me-2",headdress:null===m||void 0===m||null===(t=m.target_user)||void 0===t?void 0:t.headdress_worn,width:32,height:32}),i.a.createElement("div",{className:"media-body"},i.a.createElement("a",{href:"javascript:;"===(null===m||void 0===m||null===(n=m.target_user)||void 0===n?void 0:n.url)?"#!":null===m||void 0===m||null===(r=m.target_user)||void 0===r?void 0:r.url,target:"_blank",className:"d-inline-block"},null===m||void 0===m||null===(c=m.target_user)||void 0===c?void 0:c.name),i.a.createElement("div",{className:"text-truncate-1 text-secondary my-0",style:{maxWidth:"260px"},dangerouslySetInnerHTML:{__html:(null===m||void 0===m||null===(s=m.last_message)||void 0===s||null===(d=s.content)||void 0===d?void 0:d.content)||""}})))},A=i.a.memo(U),z=t("Dp36"),F=function(e){var a=e.visible,t=void 0!==a&&a,r=Object(o["useState"])([]),s=Object(l["a"])(r,2),d=s[0],m=s[1],u=Object(o["useState"])(!0),v=Object(l["a"])(u,2),f=v[0],g=v[1],b=Object(o["useState"])(!0),h=Object(l["a"])(b,2),E=h[0],w=h[1],O=Object(o["useState"])(1),_=Object(l["a"])(O,2),S=_[0],I=_[1],D=Object(x["debounce"])((function(){E&&U(S)}),400),T=Object(p["h"])();Object(o["useEffect"])((function(){t?(T({type:"global/saveNoticeNum",payload:{letterNum:0}}),U(1)):(m([]),I(1),g(!0),w(!0))}),[t]);var U=function(e){Object(z["ge"])(e,!1).then((function(e){var a;null!==e&&void 0!==e&&null!==(a=e.rows)&&void 0!==a&&a.length&&m([].concat(Object(N["a"])(d),Object(N["a"])(e.rows))),I((function(e){return e+1})),w(e.page<e.total_page),g(!1)}))["catch"]((function(){w(!1)}))},F=function(){var e=Object(n["a"])(c.a.mark((function e(){return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(z["he"])();case 2:d.map((function(e){e.viewed=1})),m(d);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){return d.map((function(e,a){return i.a.createElement(A,{data:e,key:"".concat(e.id).concat(a)})}))};return i.a.createElement(i.a.Fragment,null,i.a.createElement(y["a"],{className:"border-0 letterBox header-box",style:{minWidth:"22rem"}},i.a.createElement(y["a"].Body,{className:"letter p-0 font-size-14"},i.a.createElement(j["a"],{as:"ul",style:{height:"360px",overflowY:"auto"}},i.a.createElement(k.a,{className:"content-list-wrap",pageStart:0,initialLoad:!1,loadMore:D,hasMore:E,useWindow:!1},(null===d||void 0===d?void 0:d.length)>0&&M(),E&&!f?i.a.createElement("div",{className:"text-center py-3"},"\u52a0\u8f7d\u4e2d..."):""),f&&i.a.createElement(C,null))),i.a.createElement(y["a"].Footer,{className:"bg-transparent d-flex justify-content-between"},i.a.createElement("a",{href:"#!",className:"text-secondary font-size-14 all-view",onClick:function(e){e.preventDefault(),F()}},i.a.createElement("i",{className:"me-1 far fa-check-double"}),"\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb"),i.a.createElement("a",{href:"/user/messages",className:"text-secondary font-size-14"},"\u67e5\u770b\u5168\u90e8"))))},M=F,B=t("jrin"),L=t("k1fw"),q=t("pJDg"),H=t("cWnB"),R=function(e){var a,t,n,l,r,c=e.data,o=e.readAll,s=e.onReadOne;return i.a.createElement(D["a"],{as:"li",action:!0,className:"d-flex align-items-center ".concat(null!==c&&void 0!==c&&c.viewed||o?"":"bg-warning"," py-2 border-0"),onClick:function(){c.viewed||s(c.url)}},i.a.createElement("a",{href:(null===c||void 0===c||null===(a=c.trigger_user)||void 0===a?void 0:a[0].url)+"?"+(null===c||void 0===c?void 0:c.url.split("?")[1]),target:"_blank"},i.a.createElement(T["a"],{src:null===c||void 0===c||null===(t=c.trigger_user)||void 0===t?void 0:t[0].avatar_url,className:"me-2",width:32,height:32,headdress:null===c||void 0===c||null===(n=c.trigger_user)||void 0===n?void 0:n[0].headdress_worn})),i.a.createElement("div",{className:"media-body d-inline"},i.a.createElement("a",{href:(null===c||void 0===c||null===(l=c.trigger_user)||void 0===l?void 0:l[0].url)+"?"+(null===c||void 0===c?void 0:c.url.split("?")[1]),target:"_blank"},null===c||void 0===c||null===(r=c.trigger_user)||void 0===r?void 0:r[0].name)," ",i.a.createElement("span",{className:"text-muted"},"\u5173\u6ce8\u4e86\u4f60")))},W=i.a.memo(R),P=t("0lfv"),J=function(e){var a,t,n,l,r,c,o,s,d,m=e.data,u=e.readAll,f=e.onReadOne,g=function(e){return Number(e)?Number(e)>0?"bg-success":"bg-danger":"bg-warning text-body"};return i.a.createElement(D["a"],{as:"li",action:!0,className:"rankItemParent d-flex ".concat(null!==m&&void 0!==m&&m.viewed||u?"":"bg-warning"," py-2 border-0"),onClick:function(){m.viewed||f(m.url)}},i.a.createElement("div",{className:"text-end me-2",style:{width:"50px",flex:"none"}},((null===m||void 0===m||null===(a=m.voted)||void 0===a?void 0:a.rank)>0||(null===m||void 0===m||null===(t=m.voted)||void 0===t?void 0:t.rank)<0)&&"badge"!==(null===m||void 0===m||null===(n=m.voted)||void 0===n?void 0:n.type)&&i.a.createElement(v["a"],{pill:!0,className:"".concat(g(null===m||void 0===m||null===(l=m.voted)||void 0===l?void 0:l.rank))},"".concat((null===m||void 0===m||null===(r=m.voted)||void 0===r?void 0:r.rank)>0?"+":"").concat(Object(P["o"])(null===m||void 0===m||null===(c=m.voted)||void 0===c?void 0:c.rank))),"badge"===(null===m||void 0===m||null===(o=m.voted)||void 0===o?void 0:o.type)&&(null===m||void 0===m||null===(s=m.voted)||void 0===s?void 0:s.rank)>0&&i.a.createElement(v["a"],{bg:"warning",pill:!0,text:"dark"},"+",null===m||void 0===m||null===(d=m.voted)||void 0===d?void 0:d.rank)),i.a.createElement("div",null,i.a.createElement("span",{dangerouslySetInnerHTML:{__html:m.sentence},className:"rankItem"}),(null===m||void 0===m?void 0:m.excerpt)&&i.a.createElement("a",{href:null===m||void 0===m?void 0:m.url,target:"_blank"}," ",m.excerpt)))},Y=i.a.memo(J),V=function(e){var a=e.data,t=e.readAll,n=e.onReadOne;return i.a.createElement(D["a"],{as:"li",action:!0,className:"".concat(null!==a&&void 0!==a&&a.viewed||t?"":"bg-warning"," py-2 border-0"),onClick:function(){a.viewed||n(a.url)}},(null===a||void 0===a?void 0:a.sentence)&&i.a.createElement("span",{dangerouslySetInnerHTML:{__html:a.sentence}}),(null===a||void 0===a?void 0:a.excerpt)&&i.a.createElement("a",{href:null===a||void 0===a?void 0:a.url,target:"_blank"}," ",a.excerpt))},Q=i.a.memo(V),Z=[{name:"general",icon:"far fa-bullhorn"},{name:"ranked",icon:"far fa-trophy-star"},{name:"followed",icon:"far fa-user-plus"}],K=function(e){var a,t,n,r,c=e.visible,s=Object(o["useState"])("general"),d=Object(l["a"])(s,2),m=d[0],u=d[1],v=Object(o["useState"])(),f=Object(l["a"])(v,2),g=f[0],b=f[1],p=Object(o["useState"])(!0),h=Object(l["a"])(p,2),E=h[0],w=h[1],O=Object(o["useState"])(!1),_=Object(l["a"])(O,2),S=_[0],I=_[1],D=Object(o["useState"])(""),T=Object(l["a"])(D,2),U=T[0],A=T[1],F=Object(o["useState"])({followed:0,general:0,ranked:0}),M=Object(l["a"])(F,2),R=M[0],P=M[1],J=Object(o["useState"])(!1),V=Object(l["a"])(J,2),K=V[0],X=V[1];Object(o["useEffect"])((function(){c?(le(),ee("","")):(u("general"),I(!1),w(!0),A(""),b({}))}),[c]);var G=Object(x["debounce"])((function(){S&&ee(m,U)}),400),$=function(e){var a,t;u(e.name),A(null===g||void 0===g||null===(a=g[e.name])||void 0===a?void 0:a.offset),(null===g||void 0===g||null===(t=g[e.name])||void 0===t?void 0:t.data.length)>9?I(!0):I(!1),ne(e.name)},ee=function(e,a){Object(z["Dc"])(e,a).then((function(e){var t,n;if(e)if(a){var l={data:[].concat(Object(N["a"])((null===g||void 0===g?void 0:g[m].data)||{}),Object(N["a"])(e[m].data)),offset:null===e||void 0===e?void 0:e[m].offset,size:20};b(Object(L["a"])(Object(L["a"])({},g),{},Object(B["a"])({},m,l)))}else b(e);A(null===e||void 0===e||null===(t=e[m])||void 0===t?void 0:t.offset),I((null===e||void 0===e||null===(n=e[m].data)||void 0===n?void 0:n.length)>9),w(!1)}))["catch"]((function(){I(!1)}))},ae=function(e,a){var t,n;null===g||void 0===g||null===(t=g[e])||void 0===t||null===(n=t.data)||void 0===n||n.forEach((function(e){e.url===a&&(e.viewed=1)})),b(Object(L["a"])({},g))},te=function(e){var a,t,n,l,r,c;switch(e){case"general":return null===g||void 0===g||null===(a=g[m])||void 0===a||null===(t=a.data)||void 0===t?void 0:t.map((function(e,a){return i.a.createElement(Q,{data:e,key:"".concat(e.sentence).concat(a),readAll:K,onReadOne:function(e){return ae(m,e)}})}));case"ranked":return null===g||void 0===g||null===(n=g[m])||void 0===n||null===(l=n.data)||void 0===l?void 0:l.map((function(e,a){return i.a.createElement(Y,{data:e,key:"".concat(e.sentence).concat(a),readAll:K,onReadOne:function(e){return ae(m,e)}})}));case"followed":return null===g||void 0===g||null===(r=g[m])||void 0===r||null===(c=r.data)||void 0===c?void 0:c.map((function(e,a){var t;return i.a.createElement(W,{data:e,key:"".concat(null===e||void 0===e||null===(t=e.trigger_user)||void 0===t?void 0:t[0].id).concat(a),readAll:K,onReadOne:function(e){return ae(m,e)}})}));default:return null}},ne=function(e){"all"!==e&&R[e]<=0||Object(z["Ld"])(e).then((function(a){a&&("all"===e&&X(!0),P(Object(L["a"])(Object(L["a"])({},R),{},Object(B["a"])({},e,0))))}))},le=function(){Object(z["Vc"])().then((function(e){e.general>0?(u("general"),P(Object(L["a"])(Object(L["a"])({},e),{},{general:0}))):e.ranked>0?(u("ranked"),P(Object(L["a"])(Object(L["a"])({},e),{},{ranked:0}))):e.followed>0?(u("followed"),P(Object(L["a"])(Object(L["a"])({},e),{},{followed:0}))):P(Object(L["a"])(Object(L["a"])({},e),{},{general:0}))}))};Object(o["useEffect"])((function(){var e,a;if(null!==g&&void 0!==g&&null!==(e=g["ranked"])&&void 0!==e&&null!==(a=e.data)&&void 0!==a&&a.length){var t=document.querySelectorAll(".rankItem a");t.length>0&&t.forEach((function(e){e.addEventListener("click",(function(){return re(e)}))}))}}),[null===g||void 0===g||null===(a=g["ranked"])||void 0===a||null===(t=a.data)||void 0===t?void 0:t.length]);var re=function(e){for(var a=e,t=0;t<4;t++){var n,l=a.className||"";if(l.includes("rankItemParent")){a.classList.remove("bg-warning");break}a=null===(n=a)||void 0===n?void 0:n.parentNode}};return i.a.createElement(i.a.Fragment,null,i.a.createElement(y["a"],{className:"border-0 letterBox header-box",style:{minWidth:"22rem"}},i.a.createElement(y["a"].Header,{className:"bg-transparent text-center border-0"},i.a.createElement(q["a"],{className:"w-100 msg-btn-group"},Z.map((function(e){return i.a.createElement(H["a"],{variant:"outline-secondary",size:"sm",className:m===e.name?"active":"",key:e.name,onClick:function(){return $(e)}},i.a.createElement("i",{className:"fa-w-18 ".concat(e.icon)}),!K&&R[e.name]>0&&i.a.createElement("div",{className:"has-unread-dot"}))})))),i.a.createElement(y["a"].Body,{className:"letter p-0 font-size-14"},i.a.createElement(j["a"],{style:{height:"306px",overflowY:"auto"},as:"ul"},i.a.createElement(k.a,{className:"content-list-wrap",pageStart:0,initialLoad:!1,loadMore:G,hasMore:S,useWindow:!1},(null===g||void 0===g||null===(n=g[m])||void 0===n||null===(r=n.data)||void 0===r?void 0:r.length)>0&&te(m),S&&!E?i.a.createElement("div",{className:"text-center py-3"},"\u52a0\u8f7d\u4e2d..."):""),E&&i.a.createElement(C,null))),i.a.createElement(y["a"].Footer,{className:"bg-transparent d-flex justify-content-between"},i.a.createElement("a",{href:"###",className:"text-secondary font-size-14 all-view",onClick:function(e){e.preventDefault(),ne("all")}},i.a.createElement("i",{className:"me-1 far fa-check-double"}),"\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb"),i.a.createElement("a",{href:"/user/notifications",className:"text-secondary font-size-14"},"\u67e5\u770b\u5168\u90e8"))))},X=K,G=t("hS4W"),$=t.n(G),ee=t("tSvB"),ae=w()(S.a["medal-circle"],"me-1"),te=function(e){var a,t,n,r,c,s,d,m,u,v,f,g,b=Object(o["useState"])(!1),p=Object(l["a"])(b,2),h=p[0],E=p[1],w=function(){var e,a=document.getElementById("userDropDown");null===a||void 0===a||null===(e=a.classList)||void 0===e||e.remove("show")};return i.a.createElement(i.a.Fragment,null,i.a.createElement("h5",{className:"dropdown-header mw-316"},i.a.createElement("span",{className:"me-2",style:{color:"#BF7158"}},null===(a=e.sessionUser)||void 0===a||null===(t=a.user)||void 0===t?void 0:t.rank),i.a.createElement("span",{className:"d-inline-block me-1"},i.a.createElement("i",{className:"".concat(ae," fas fa-circle"),style:{color:"#FFDA23"}}),null===(n=e.userStat.summary_badges)||void 0===n?void 0:n.gold),i.a.createElement("span",{className:"d-inline-block me-1"},i.a.createElement("i",{className:"".concat(ae," fas fa-circle"),style:{color:"#C5C5C5"}}),null===(r=e.userStat.summary_badges)||void 0===r?void 0:r.silver),i.a.createElement("span",{className:"d-inline-block me-1"},i.a.createElement("i",{className:"".concat(ae," fas fa-circle"),style:{color:"#CD9A62"}}),null===(c=e.userStat.summary_badges)||void 0===c?void 0:c.bronze)),i.a.createElement("div",{className:"dropdown-divider"}),i.a.createElement("div",{className:"row no-gutters"},i.a.createElement("div",{className:"col-6"},i.a.createElement("a",{className:"dropdown-item",href:(null===(s=e.sessionUser)||void 0===s?void 0:s.user.url)+"/articles"},"\u6211\u7684\u6587\u7ae0"),i.a.createElement("a",{className:"dropdown-item",href:"/user/note"},"\u6211\u7684\u7b14\u8bb0"),i.a.createElement("a",{className:"dropdown-item",href:(null===(d=e.sessionUser)||void 0===d?void 0:d.user.url)+"/bookmarks"},"\u6211\u7684\u6536\u85cf"),i.a.createElement("a",{className:"dropdown-item d-flex justify-content-between align-items-center",href:"/user/invited"},"\u53d7\u9080\u56de\u7b54",e.userStat.invites>0&&i.a.createElement("span",{className:"badge rounded-pill bg-secondary"},e.userStat.invites<99?e.userStat.invites:"..."))),i.a.createElement("div",{className:"col-6"},i.a.createElement("a",{className:"dropdown-item",href:e.sessionUser.user.url},"\u6211\u7684\u4e3b\u9875"),i.a.createElement("a",{className:"dropdown-item",href:"/user/finance"},"\u6211\u7684\u8d44\u4ea7"),i.a.createElement("a",{className:"dropdown-item",href:"/user/settings"},"\u4e2a\u4eba\u8bbe\u7f6e"),i.a.createElement("a",{className:"dropdown-item",href:"###",onClick:function(a){a.preventDefault(),w(),e.logout()}},"\u9000\u51fa\u767b\u5f55"),((null===(m=e.sessionUser)||void 0===m||null===(u=m.roles)||void 0===u?void 0:u.is_admin)||(null===(v=e.sessionUser)||void 0===v||null===(f=v.roles)||void 0===f?void 0:f.is_editor))&&i.a.createElement(i.a.Fragment,null,i.a.createElement("a",{className:"dropdown-item",href:"###",onClick:function(e){e.preventDefault(),w(),$.a.set("sf_beta",1),window.location.reload()}},"\u5207\u6362Beta\u7248"),i.a.createElement("a",{className:"dropdown-item",href:"###",onClick:function(e){e.preventDefault(),w(),$.a.set("sf_beta",0),window.location.reload()}},"\u9000\u51faBeta\u7248")))),i.a.createElement("div",{className:"dropdown-divider"}),i.a.createElement("div",{className:"px-4 py-1 font-size-14"},i.a.createElement("a",{href:"/help/community/complain",className:"text-secondary",target:"_blank"},"\u7528\u6237\u7533\u8bc9"),i.a.createElement("span",{className:"split-dot"}),i.a.createElement("a",{href:"/0x",className:"text-secondary",target:"_blank"},"\u5efa\u8bae\u53cd\u9988"),i.a.createElement("span",{className:"split-dot"}),i.a.createElement("a",{href:"/user/invitation",className:"text-secondary",target:"_blank"},"\u9080\u8bf7\u6ce8\u518c"),(null===e||void 0===e||null===(g=e.sessionUser)||void 0===g?void 0:g.is_change)&&i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:"split-dot"}),i.a.createElement("a",{href:"#!",className:"text-secondary",onClick:function(a){a.stopPropagation(),e.outChange()}},"\u9000\u51fa\u5207\u6362"))),i.a.createElement(ee["b"],{isShow:h,setModalStatus:E}))},ne=te,le=i.a.forwardRef((function(e,a){var t,n,l,r=e.sessionUser,c=e.children,o=e.onClick;return i.a.createElement(i.a.Fragment,null,i.a.createElement("a",{className:"nav-link p-0",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",href:null===(t=r.user)||void 0===t?void 0:t.url,ref:a,onClick:function(e){e.preventDefault(),o(e)}},i.a.createElement(T["a"],{src:null===(n=r.user)||void 0===n?void 0:n.avatar_url,width:32,height:32,headdress:null===r||void 0===r||null===(l=r.user)||void 0===l?void 0:l.headdress_worn}),i.a.createElement("span",{className:"d-lg-none"},c)))}));le.displayName="Profile_Toggle";var re=Object(p["c"])((function(e){var a=e.global;return{sessionUser:a.sessionUser}}),null,null,{forwardRef:!0})(le),ce=t("95Qr"),oe=function(e){var a,t,n,r,c=e.data,s=Object(o["useState"])(null===c||void 0===c?void 0:c.viewed),d=Object(l["a"])(s,2),m=d[0],u=d[1];return i.a.createElement(D["a"],{as:"li",action:!0,className:"d-flex align-items-center ".concat(m?"":"bg-warning"," py-2 border-0"),onClick:function(){window.location.href="".concat(null===c||void 0===c?void 0:c.url,"#hat-warehouse"),c.viewed||u(1)},style:{cursor:"pointer"}},i.a.createElement(T["a"],{src:null===c||void 0===c?void 0:c.append_sentence,className:"me-2",width:20,height:20}),i.a.createElement("div",{className:"media-body"},i.a.createElement("a",{href:"javascript:;"===(null===c||void 0===c||null===(a=c.target_user)||void 0===a?void 0:a.url)?"#!":null===c||void 0===c||null===(t=c.target_user)||void 0===t?void 0:t.url,target:"_blank",className:"d-inline-block"},c.sentence," ",c.excerpt),i.a.createElement("div",{className:"text-truncate-1 text-secondary my-0",style:{maxWidth:"260px"},dangerouslySetInnerHTML:{__html:(null===c||void 0===c||null===(n=c.last_message)||void 0===n||null===(r=n.content)||void 0===r?void 0:r.content)||""}})))},ie=i.a.memo(oe),se=function(e){var a=e.visible,t=void 0!==a&&a,n=e.id,r=Object(o["useState"])([]),c=Object(l["a"])(r,2),s=c[0],d=c[1],m=Object(o["useState"])(!0),u=Object(l["a"])(m,2),v=u[0],f=u[1],g=Object(o["useState"])(!0),b=Object(l["a"])(g,2),h=b[0],E=b[1],w=Object(o["useState"])(0),O=Object(l["a"])(w,2),_=O[0],S=O[1],I=Object(x["debounce"])((function(){h&&T(_)}),400),D=Object(p["h"])();Object(o["useEffect"])((function(){t?(D({type:"global/saveNoticeNum",payload:{letterNum:0}}),T(0)):(d([]),S(0),f(!0),E(!0))}),[t]);var T=function(e){Object(z["Dc"])("marketing",e).then((function(a){var t,n=(null===a||void 0===a||null===(t=a.marketing)||void 0===t?void 0:t.data)||[];n.length>0&&d(e>0?[].concat(Object(N["a"])(s),Object(N["a"])(n)):n),S((function(e){return e+1})),E(a.page<a.total_page),f(!1)}))["catch"]((function(){E(!1)}))},U=function(){return s.map((function(e,a){return i.a.createElement(ie,{data:e,key:"".concat(e.url).concat(a)})}))};return i.a.createElement(i.a.Fragment,null,i.a.createElement(y["a"],{className:"border-0 letterBox header-box",style:{minWidth:"22rem"}},i.a.createElement(y["a"].Body,{className:"letter p-0 font-size-14"},i.a.createElement(j["a"],{as:"ul",style:{height:"360px",overflowY:"auto"}},i.a.createElement(k.a,{className:"content-list-wrap",pageStart:0,initialLoad:!1,loadMore:I,hasMore:h,useWindow:!1},(null===s||void 0===s?void 0:s.length)>0?U():v?null:i.a.createElement(j["a"].Item,{className:"border-0"},i.a.createElement("a",{href:"/bash/".concat(n),target:"_blank",className:"font-size-14"},"\u4f60\u8fd8\u672a\u83b7\u5f97\u5934\u9970\uff0c\u67e5\u770b\u6d3b\u52a8\u53c2\u4e0e\uff01")),h&&!v?i.a.createElement("div",{className:"text-center py-3"},"\u52a0\u8f7d\u4e2d..."):""),v&&i.a.createElement(C,null))),i.a.createElement(y["a"].Footer,{className:"bg-transparent"},i.a.createElement("a",{href:"/bash/".concat(n),target:"_blank",className:"font-size-14"},"\u67e5\u770b\u6d3b\u52a8"))))},de=se,me=t("4ISH"),ue=t("6Yt9"),ve=function(e){var a,r,E=e.sessionUser,N=e.menu,y=e.title,j=e.rightComponent,O=e.dispatch,k=e.letterNum,x=void 0===k?0:k,_=e.noticeNum,I=void 0===_?0:_,C=e.userStat,D=e.children,T=e.isBaiduOxApp,U=void 0!==T&&T,A=e.messageNotice,F=Object(p["i"])(),B=Object(p["j"])(),L=B.query,q=Object(o["useState"])((function(){return N||[{name:"\u95ee\u7b54",url:"/questions"},{name:"\u4e13\u680f",url:"/blogs"},{name:"\u6807\u7b7e",url:"/tags"},{name:"\u62db\u8058",url:"/jobs",icon:"fas fa-fire",className:"d-flex align-items-center"},{name:"\u6d3b\u52a8",url:"/events"}]})),H=Object(l["a"])(q,1),R=H[0],W=Object(o["useState"])(!1),J=Object(l["a"])(W,2),Y=J[0],V=J[1],Q=Object(o["useState"])(!1),Z=Object(l["a"])(Q,2),K=Z[0],G=Z[1],$=Object(o["useState"])(!1),ee=Object(l["a"])($,2),ae=ee[0],te=ee[1],le=Object(o["useState"])("/ask"),oe=Object(l["a"])(le,2),ie=oe[0],se=oe[1],ve=Object(o["useState"])("/write"),fe=Object(l["a"])(ve,2),ge=fe[0],be=fe[1],pe=Object(me["a"])(),he=Object(me["b"])(),Ee=Object(P["t"])(),we=Ee.defaultHeaderAnimate,Ne=function(){var e=Object(n["a"])(c.a.mark((function e(){var a;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(ue["a"])();case 2:a=h["g"].find((function(e){return window.location.pathname.includes(e.pathname)})),a?window.location.href=a.redirect:window.location.reload();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o["useEffect"])((function(){var e=h["n"].find((function(e){var a=new RegExp("/".concat(e,"$"));return a.test(F.location.pathname)}));e?(se("/site/".concat(e,"/ask")),be("/site/".concat(e,"/write"))):(se("/ask"),be("/write"))}),[F.location.pathname]);var ye=function(){localStorage.setItem("referer",decodeURI(window.location.href)),O({type:"global/saveShowLoginState",payload:{isShowLogin:!0}})},je=function(){var e=Object(n["a"])(c.a.mark((function e(){return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(z["F"])();case 2:window.location.reload();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i.a.createElement(s["a"],{id:"sf-header",expand:"lg",className:w()("bg-white shadow-sm sticky-top",we)},i.a.createElement(d["a"],{className:"position-relative"},!y&&i.a.createElement(s["a"].Toggle,{className:S.a["self-nav-toogle"],as:"div","aria-controls":"basic-navbar-nav"}),i.a.createElement("div",{className:"left-wrap d-flex justify-content-between align-items-center nav-grow"},i.a.createElement(s["a"].Brand,{className:"".concat(S.a["sf-header"]," me-3 me-md-0 me-lg-3"),href:"/"},i.a.createElement(m["a"],{placement:"bottom",overlay:i.a.createElement(u["a"],null,"\u77ed\u7f51\u5740 sf.gg")},i.a.createElement("img",{src:t("XHHP"),width:"139",height:"26",className:"d-none d-lg-block",alt:"segmentfault"})),i.a.createElement(m["a"],{placement:"bottom",overlay:i.a.createElement(u["a"],null,"\u77ed\u7f51\u5740 sf.gg")},i.a.createElement("img",{src:t("Z6Z6"),width:"30",height:"30",className:"d-block d-lg-none",alt:"segmentfault"}))),i.a.createElement("div",{className:"d-flex lg-none align-items-center"},i.a.createElement("a",{href:"/search","aria-label":"\u641c\u7d22",className:"d-inline-block text-center text-secondary position-relative",style:{fontSize:"20px",width:"44px"}},i.a.createElement("i",{className:"fa-fw far fa-magnifying-glass"})),E&&i.a.createElement(i.a.Fragment,null,i.a.createElement("a",{href:"/user/notifications","aria-label":"\u901a\u77e5",className:"d-inline-block text-center text-secondary position-relative",style:{fontSize:"20px",width:"44px"}},i.a.createElement("i",{className:"fa-fw far fa-bell"}),I>0&&i.a.createElement(v["a"],{bg:"danger",pill:!0,className:"has-unread-count has-unread-count2"},I>99?"...":I)),i.a.createElement("a",{href:"/user/messages","aria-label":"\u79c1\u4fe1",className:"d-inline-block text-center text-secondary position-relative",style:{fontSize:"20px",width:"44px"}},i.a.createElement("i",{className:"fa-fw far fa-envelope"}),x>0&&i.a.createElement(v["a"],{bg:"danger",pill:!0,className:"has-unread-count has-unread-count2"},x>99?"...":x)),i.a.createElement(f["a"],{className:"position-relative text-end",align:"end",style:{width:"44px"}},i.a.createElement(f["a"].Toggle,{as:re,id:"header-mine"}),i.a.createElement(f["a"].Menu,{align:"end",id:"userDropDown"},i.a.createElement(ne,{sessionUser:E,logout:Ne,outChange:je,userStat:C})))),!E&&!y&&i.a.createElement("a",{className:"btn btn-primary d-lg-none ms-2",href:"/user/login",onClick:function(){localStorage.setItem("referer",decodeURI(window.location.href))}},"\u6ce8\u518c\u767b\u5f55")),D),y?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"h5 mb-0 text-secondary position-absolute sflex-center w-100 ".concat(S.a["title-wrap"]," d-none d-md-flex")},y),j()):i.a.createElement(s["a"].Collapse,{id:"basic-navbar-nav",className:"justify-content-between"},i.a.createElement(g["a"],{className:"fw-bold"},R.map((function(e,a){if("\u8bfe\u7a0b"===e.name)return U?null:i.a.createElement("a",{key:e.url,href:e.url,target:"_blank",className:"nav-link lg-show"},e.name,e.icon&&i.a.createElement("i",{className:"ms-1 text-danger ".concat(e.icon),style:{width:"0.88rem",verticalAlign:"text-bottom"}}));if("\u4e13\u680f"===e.name)return i.a.createElement(g["a"].Link,{href:e.url,key:a,active:e.url===F.location.pathname||F.location.pathname.includes("/channel")||F.location.pathname.includes("/news")||F.location.pathname.includes("/blogs")},e.name,e.icon&&i.a.createElement("i",{className:"ms-1 text-danger ".concat(e.icon),style:{width:"0.88rem",verticalAlign:"text-bottom"}}));if("\u6d3b\u52a8"===e.name&&U)return null;var t=e.url===F.location.pathname;return F.location.pathname.indexOf(e.url)>-1&&(t=!0),"/"===F.location.pathname&&"/questions"===e.url&&(t=!0),i.a.createElement(g["a"].Link,{href:e.url,key:a,active:t,className:(null===e||void 0===e?void 0:e.className)||""},e.name,e.icon&&i.a.createElement("i",{className:"ms-1 text-danger ".concat(e.icon),style:{width:"0.88rem",verticalAlign:"text-bottom"}}))})),i.a.createElement(b["a"],{title:"\u53d1\u73b0",id:"basic-nav-dropdown",className:"lg-show  hover-down ".concat(U?"d-none":"")},i.a.createElement(b["a"].Item,{href:"/dianping"},"\u70b9\u8bc4"),i.a.createElement(b["a"].Item,{href:"https://ke.segmentfault.com",target:"_blank"},"\u8bfe\u7a0b"),i.a.createElement(b["a"].Item,{href:"/users"},"\u6392\u884c\u699c"),i.a.createElement(b["a"].Item,{href:"/notes"},"\u7b14\u8bb0"),i.a.createElement(b["a"].Divider,null),i.a.createElement(b["a"].Item,{href:"https://business.segmentfault.com/ads?utm_source=sf-header",target:"_blank"},"\u5e7f\u544a\u6295\u653e",i.a.createElement("i",{className:"ms-2 text-warning fas fa-square-up-right"})))),i.a.createElement("div",{className:"d-none d-xl-block px-3 ".concat(S.a["header-search"])},i.a.createElement(ce["a"],{defaultValue:L.q})),E?i.a.createElement("ul",{className:"navbar-nav navbar-user align-items-lg-center lg-show flex"},i.a.createElement(f["a"],{className:"position-relative"},i.a.createElement(f["a"].Toggle,{variant:"primary",className:"me-2",id:"header-write"},i.a.createElement("span",{className:"me-1"},"\u64b0\u5199")),i.a.createElement(f["a"].Menu,null,i.a.createElement(f["a"].Item,{href:ie},"\u63d0\u95ee\u9898"),i.a.createElement(f["a"].Item,{href:ge},"\u5199\u6587\u7ae0"),i.a.createElement(f["a"].Item,{href:"/record"},"\u8bb0\u7b14\u8bb0"),i.a.createElement(f["a"].Item,{href:"/jobs"},"\u53d1\u62db\u8058"),(pe||he)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(f["a"].Item,{href:"/video/add"},"\u53d1\u89c6\u9891"),i.a.createElement(f["a"].Item,{href:"/live/add"},"\u5f00\u76f4\u64ad")),i.a.createElement(f["a"].Divider,null),i.a.createElement(f["a"].Item,{href:"/user/draft",className:"d-inline-flex justify-content-between align-items-center"},i.a.createElement("span",null,"\u8349\u7a3f"),(null===C||void 0===C?void 0:C.drafts)>0&&i.a.createElement(v["a"],{bg:"secondary",className:"rounded-pill px-2"},null===C||void 0===C?void 0:C.drafts)))),i.a.createElement(g["a"].Item,{className:"d-none d-lg-block d-xl-none"},i.a.createElement("a",{href:"/search","aria-label":"\u641c\u7d22",className:"nav-link"},i.a.createElement("i",{className:"fa-fw far fa-magnifying-glass"}))),i.a.createElement(f["a"],{className:"nav-item position-relative d-none d-lg-block",show:K,onToggle:function(e){G(e)}},i.a.createElement(f["a"].Toggle,{as:"a",className:"dropdown-no-angle nav-link",style:{cursor:"pointer"},href:"/user/notifications",onClick:function(e){e.preventDefault(),G(!K)},id:"header-ntice"},i.a.createElement("i",{className:"me-1 fa-fw far fa-bell"}),i.a.createElement("span",{className:"d-lg-none"},"\u901a\u77e5"),I>0&&i.a.createElement(v["a"],{bg:"danger",pill:!0,className:"has-unread-count"},I>99?"...":I)),i.a.createElement(f["a"].Menu,{align:"end",className:"dropdown-menu-right p-0",show:K},i.a.createElement(X,{visible:K}))),i.a.createElement(g["a"].Item,{className:"d-lg-none"},i.a.createElement("a",{href:"/user/notifications",className:"nav-link","aria-label":"\u901a\u77e5"},i.a.createElement("i",{className:"me-1 fa-fw far fa-bell"}),i.a.createElement("span",{className:"d-lg-none"},"\u901a\u77e5"),I>0&&i.a.createElement(v["a"],{bg:"danger",pill:!0,className:"has-unread-count"},I>99?"...":I))),i.a.createElement(f["a"],{className:"nav-item position-relative d-none d-lg-block",id:"letter",show:Y,onToggle:function(e){V(e)}},i.a.createElement(f["a"].Toggle,{as:"a",className:"dropdown-no-angle nav-link",style:{cursor:"pointer"},href:"/user/messages",onClick:function(e){e.preventDefault(),V(!Y)},id:"header-letter"},i.a.createElement("i",{className:"me-1 fa-fw far fa-envelope"}),i.a.createElement("span",{className:"d-lg-none"},"\u79c1\u4fe1"),x>0&&i.a.createElement(v["a"],{bg:"danger",pill:!0,className:"has-unread-count"},x>99?"...":x)),i.a.createElement(f["a"].Menu,{align:"end",className:"dropdown-menu-right p-0",show:Y},i.a.createElement(M,{visible:Y}))),i.a.createElement(g["a"].Item,{className:"d-lg-none"},i.a.createElement("a",{href:"/user/messages",className:"nav-link","aria-label":"\u79c1\u4fe1"},i.a.createElement("i",{className:"me-1 fa-fw far fa-envelope"}),i.a.createElement("span",{className:"d-lg-none"},"\u79c1\u4fe1"),x>0&&i.a.createElement(v["a"],{bg:"danger",pill:!0,className:"has-unread-count"},x>99?"...":x))),(null===E||void 0===E||null===(a=E.user)||void 0===a?void 0:a.rank)>=500&&i.a.createElement(g["a"].Item,null,i.a.createElement("a",{href:"/review",className:"nav-link position-relative","aria-label":"\u4f17\u5ba1\u4e2d\u5fc3"},i.a.createElement("i",{className:"me-1 fa-fw far fa-list-check"}),i.a.createElement("span",{id:"reviewCount",className:"d-lg-none"},"\u4f17\u5ba1\u4e2d\u5fc3"),(null===C||void 0===C?void 0:C.notify_review)&&i.a.createElement("span",{className:S.a["review-dot"]}))),Boolean(C.marketing_activity_id)&&i.a.createElement(f["a"],{className:"nav-item position-relative d-none d-lg-block",id:"letter",show:ae,onToggle:function(e){te(e)}},i.a.createElement(f["a"].Toggle,{as:"a",className:"dropdown-no-angle nav-link",style:{cursor:"pointer"},href:"/bash/".concat(C.marketing_activity_id),onClick:function(e){e.preventDefault(),te(!ae)},id:"header-letter"},i.a.createElement("i",{className:"me-1 fa-fw far fa-hat-wizard"}),((null===A||void 0===A||null===(r=A.event)||void 0===r?void 0:r.marketing)||0)>0&&i.a.createElement("span",{className:S.a["marketing-dot"]})),i.a.createElement(f["a"].Menu,{align:"end",className:"dropdown-menu-right p-0",show:ae},i.a.createElement(de,{visible:ae,id:C.marketing_activity_id}))),i.a.createElement(f["a"],{className:"position-relative ms-2",align:"end"},i.a.createElement(f["a"].Toggle,{as:re,id:"header-mine"},"\u6211\u7684"),i.a.createElement(f["a"].Menu,{align:"end",id:"userDropDown"},i.a.createElement(ne,{sessionUser:E,logout:Ne,outChange:je,userStat:C})))):i.a.createElement(s["a"],{className:"p-0"},i.a.createElement(g["a"].Item,{className:"d-none d-lg-block d-xl-none me-2"},i.a.createElement("a",{href:"/search","aria-label":"\u641c\u7d22",className:"nav-link"},i.a.createElement("i",{className:"fa-fw far fa-magnifying-glass text-secondary font-size-20"}))),i.a.createElement(g["a"].Item,{className:"d-none d-lg-flex me-2 me-md-0"},i.a.createElement("a",{href:"/user/login",className:"btn btn-primary",onClick:function(e){e.preventDefault(),ye()}},"\u6ce8\u518c\u767b\u5f55"))))))};a["a"]=Object(p["c"])((function(e){var a=e.global;return{sessionUser:a.sessionUser,letterNum:a.letterNum,noticeNum:a.noticeNum,userStat:a.userStat,isBaiduOxApp:a.isBaiduOxApp,messageNotice:a.messageNotice}}))(ve)}}]);